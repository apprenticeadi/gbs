INFO 2022-02-11 19:23:55,808 NumExpr defaulting to 8 threads.
INFO 2022-02-11 19:24:00,012 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 4, hbar = 2
INFO 2022-02-11 19:24:00,012 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-11 19:24:00,012 U = [[-0.13252277-0.57009643j -0.13571095+0.25793092j  0.30126002+0.19381213j
  -0.3027649 -0.38562208j -0.17204262+0.10444724j  0.015129  -0.25548911j
   0.22427942-0.11904699j -0.14091893+0.11596203j]
 [-0.18271044-0.52799114j  0.19226089+0.13412899j  0.10065256-0.09632476j
   0.2426595 -0.02596524j  0.13433521-0.26429747j -0.13228447+0.3114533j
  -0.4670512 +0.3277569j  -0.07551721-0.14231829j]
 [-0.049418  +0.21086239j -0.05431499-0.07729923j  0.59527691+0.00436321j
   0.05802264-0.18298598j  0.1439471 -0.01734173j  0.32201253-0.29043414j
  -0.20299118+0.14511599j  0.43086465-0.30979269j]
 [ 0.08022196+0.2542921j  -0.07705456+0.24827947j -0.00694583+0.1986656j
  -0.27494667+0.08684278j -0.63539937-0.02709425j  0.04956372-0.01873611j
  -0.53570279+0.12486084j -0.16384185-0.04450101j]
 [ 0.20187234+0.00388832j -0.33488015+0.25695015j  0.03622267-0.10289161j
  -0.52033623+0.10386522j  0.31437186-0.11279895j  0.29160141+0.46996283j
   0.09782132+0.2092139j   0.10749107+0.07269307j]
 [ 0.02619407+0.13037064j  0.10803117-0.06358065j  0.47028386+0.05376598j
   0.11502406+0.11093214j  0.01781729+0.07114535j  0.19902141+0.35958376j
   0.10357309-0.32709223j -0.60404504-0.24522179j]
 [-0.27045347-0.02271345j -0.48231377-0.2369546j   0.05321088+0.31382608j
  -0.00304755+0.42473822j  0.26285039-0.12309225j -0.08133499-0.31502169j
  -0.06151303+0.23421893j -0.31909707+0.07261915j]
 [-0.09068981+0.2948374j   0.22139285+0.5019201j  -0.2600729 +0.23123014j
   0.02879117-0.30293289j  0.48444745+0.10119927j  0.09098091-0.20051037j
  -0.10724448+0.06271729j -0.28081807-0.04998946j]]
INFO 2022-02-11 19:24:00,012 
INFO 2022-02-11 19:24:00,012 Number of coherent states = 2
INFO 2022-02-11 19:24:00,032 mu = [-1.20705173  0.04297701 -0.46679843  0.01425331 -0.59853515  0.60401354
 -3.38745255  0.58816369 -1.40474478 -1.77237971  0.60103422  2.26157203
  1.17377312  0.30055498 -1.16850623  3.58540874]
INFO 2022-02-11 19:24:00,032 cov = [[ 6.87921848 -3.47734778  1.88652599 -0.36660254 -4.53593275 -2.45865583
  -1.16322647  4.60172758 -2.44268904 -0.55384894 -2.24306146 -1.56182215
  -3.53711564  1.85291399 -0.66037622  0.98889196]
 [-3.47734778  7.14091746  0.10638881  0.47781251  5.28691373  0.22546335
  -0.95540336 -1.71004231 -2.61832161  5.20665654  2.68801093 -0.81058557
  -0.57349123 -2.89064064  1.53841444  1.53023519]
 [ 1.88652599  0.10638881  5.30841226  0.53801242 -3.24801987 -2.12986556
   0.68798917  3.06134169 -2.883089    1.2265588   5.91428705 -0.4880717
   0.22849077 -2.77040628 -2.39975832 -0.67445513]
 [-0.36660254  0.47781251  0.53801242  1.63216102  0.22863279 -0.39427184
   2.93225076  0.84746265 -1.5979504   0.28181467 -1.47843933  1.51896168
   0.99849719 -3.09699258 -0.05301261  1.39272181]
 [-4.53593275  5.28691373 -3.24801987  0.22863279  6.98900454  1.74307181
  -1.46379648 -3.31833328 -0.17523085  3.47905567 -1.44361464  1.24793291
  -1.59697172 -0.70865615  2.62160292  0.39590435]
 [-2.45865583  0.22546335 -2.12986556 -0.39427184  1.74307181  7.0923641
  -3.42245766 -2.06285634  1.41607159 -3.63364025 -2.77368345 -3.46389891
  -0.308864   -4.9871649  -2.02206852 -3.46797025]
 [-1.16322647 -0.95540336  0.68798917  2.93225076 -1.46379648 -3.42245766
  10.4355436  -0.07298766 -0.55133805 -0.88086493 -1.71678742  4.09597451
   6.66510948 -2.45931873  0.64039795  4.24212146]
 [ 4.60172758 -1.71004231  3.06134169  0.84746265 -3.31833328 -2.06285634
  -0.07298766  4.90070553 -3.38348922  0.82276495 -0.78772464  0.4427503
  -2.94617165 -1.68971186 -1.25228624  0.68150097]
 [-2.44268904 -2.61832161 -2.883089   -1.5979504  -0.17523085  1.41607159
  -0.55133805 -3.38348922  6.70953409 -3.27821241  0.66874002  2.00843445
   2.86076591  4.6622193   0.08776769 -3.454921  ]
 [-0.55384894  5.20665654  1.2265588   0.28181467  3.47905567 -3.63364025
  -0.88086493  0.82276495 -3.27821241  7.67062275  2.38582828  2.16257252
  -3.89303992  1.01701791  2.23284563  2.30142827]
 [-2.24306146  2.68801093  5.91428705 -1.47843933 -1.44361464 -2.77368345
  -1.71678742 -0.78772464  0.66874002  2.38582828 15.80441393 -1.23942502
   3.46723669  1.61887492 -1.76267245 -3.38176495]
 [-1.56182215 -0.81058557 -0.4880717   1.51896168  1.24793291 -3.46389891
   4.09597451  0.4427503   2.00843445  2.16257252 -1.23942502 17.8035375
  -2.39023812  0.16869395 -1.93753715 -4.39518272]
 [-3.53711564 -0.57349123  0.22849077  0.99849719 -1.59697172 -0.308864
   6.66510948 -2.94617165  2.86076591 -3.89303992  3.46723669 -2.39023812
  10.82208132 -0.79732348  0.53370355  2.55583956]
 [ 1.85291399 -2.89064064 -2.77040628 -3.09699258 -0.70865615 -4.9871649
  -2.45931873 -1.68971186  4.6622193   1.01701791  1.61887492  0.16869395
  -0.79732348 14.47460386  4.37559194  1.49468533]
 [-0.66037622  1.53841444 -2.39975832 -0.05301261  2.62160292 -2.02206852
   0.64039795 -1.25228624  0.08776769  2.23284563 -1.76267245 -1.93753715
   0.53370355  4.37559194  4.47068436  4.28115316]
 [ 0.98889196  1.53023519 -0.67445513  1.39272181  0.39590435 -3.46797025
   4.24212146  0.68150097 -3.454921    2.30142827 -3.38176495 -4.39518272
   2.55583956  1.49468533  4.28115316  9.3241981 ]]
INFO 2022-02-11 19:24:00,042 A=[[ 6.99931479e-03+2.01517056e-01j -8.21413892e-03+1.30848925e-01j
   5.02324774e-02+2.11448680e-01j -9.79679473e-02+1.30337520e-01j
  -3.05106567e-01+1.53130653e-01j -2.93729117e-01-1.34842450e-01j
  -5.16022823e-02+4.99820252e-02j  3.32328854e-01+9.87747890e-02j
   1.22124533e-15+2.13374782e-17j  2.55506157e-16+2.51875419e-16j
  -9.43689571e-16-1.22124533e-15j  5.42595648e-16-9.95246473e-16j
   4.79950569e-16-3.10695829e-16j -1.68221539e-16-5.84948678e-17j
  -1.19327489e-17-2.83780232e-16j  1.60308977e-16+2.33977354e-16j]
 [-8.21413892e-03+1.30848925e-01j -2.18498240e-02-4.29538954e-01j
  -9.40246429e-02-1.61472163e-01j -6.94946985e-02+2.18112813e-02j
   3.78664087e-01-1.19851684e-01j -3.26508497e-02+2.69120190e-01j
  -1.31512145e-01-2.71232726e-02j -1.65469228e-01-9.70589486e-02j
   4.62812292e-16-2.44674104e-16j  8.88178420e-16-2.42953413e-17j
   3.88578059e-16-1.38777878e-17j -7.68418337e-16+1.01184755e-15j
  -1.31587047e-16+2.46433286e-16j -9.92709988e-16-3.59293740e-16j
  -2.40682571e-16-3.21264294e-16j -9.92196891e-17+1.85171420e-16j]
 [ 5.02324774e-02+2.11448680e-01j -9.40246429e-02-1.61472163e-01j
  -4.32949778e-01-4.87917084e-01j  7.33175514e-02+8.11166517e-02j
  -2.76997749e-01+5.01226682e-02j -1.54631869e-01+2.28688266e-01j
   1.01087389e-01+1.69803475e-01j  2.65771831e-01+6.03134820e-02j
  -4.82178200e-16+1.20243072e-15j -2.88402487e-16-3.25018069e-16j
   1.11022302e-15-9.43689571e-16j  7.22136759e-16-4.95550457e-16j
   7.43495848e-16-8.53379115e-16j -3.95988149e-16-1.10094766e-15j
  -6.25625749e-16+1.67857937e-16j  1.67857937e-16+6.25625749e-16j]
 [-9.79679473e-02+1.30337520e-01j -6.94946985e-02+2.18112813e-02j
   7.33175514e-02+8.11166517e-02j -6.67053424e-01-1.25311360e-01j
   1.08025857e-01-9.26630388e-02j -2.32217868e-02+2.70630341e-01j
   2.00873977e-01-1.66768214e-01j  2.16253981e-01-7.57114251e-02j
   4.67551111e-16+1.01896113e-15j -8.39339119e-16-8.34143875e-16j
   7.21644966e-16+5.66820896e-16j -3.77475828e-15+9.03237390e-19j
   1.31998046e-15-5.49709683e-16j -2.65003202e-16-1.48140888e-15j
   4.90944418e-17+4.14993173e-16j -2.90960372e-17+9.50106280e-16j]
 [-3.05106567e-01+1.53130653e-01j  3.78664087e-01-1.19851684e-01j
  -2.76997749e-01+5.01226682e-02j  1.08025857e-01-9.26630388e-02j
  -1.58110659e-01+1.31747035e-01j  1.04788815e-01+4.19717086e-02j
  -8.23949174e-02-3.83067781e-01j -2.42303870e-01+1.05196026e-01j
   4.46081470e-16+1.14462066e-16j -1.79841134e-17-4.10700806e-16j
   6.10622664e-16-8.32667268e-17j  1.31162021e-15+6.21818487e-16j
  -6.66133815e-16+2.00592901e-16j  4.91803908e-18+2.32020351e-16j
  -4.67071898e-16+2.68282359e-16j -6.75407212e-16+4.11560747e-16j]
 [-2.93729117e-01-1.34842450e-01j -3.26508497e-02+2.69120190e-01j
  -1.54631869e-01+2.28688266e-01j -2.32217868e-02+2.70630341e-01j
   1.04788815e-01+4.19717086e-02j -3.04510152e-01+4.11431324e-01j
  -3.21661900e-01+1.84852830e-01j -1.46745106e-01+2.12749330e-01j
   2.10505746e-16+5.15654606e-16j -8.80161634e-16+3.18870440e-16j
  -9.02056208e-16+7.07767178e-16j -3.34433745e-16+1.19919465e-15j
  -1.50316632e-16-2.10295606e-17j -2.22044605e-15-5.52299576e-17j
   6.89557150e-16+1.83387529e-16j  6.55232315e-16+2.54132421e-16j]
 [-5.16022823e-02+4.99820252e-02j -1.31512145e-01-2.71232726e-02j
   1.01087389e-01+1.69803475e-01j  2.00873977e-01-1.66768214e-01j
  -8.23949174e-02-3.83067781e-01j -3.21661900e-01+1.84852830e-01j
   2.46044595e-01-5.28315750e-02j -1.79604040e-01-1.23327771e-01j
   2.11847927e-16+5.64734256e-16j -3.21240330e-16+4.46178744e-16j
  -1.11022302e-15+1.24900090e-16j  3.44976504e-17-3.37691713e-16j
  -5.47315425e-16-2.32429466e-16j  6.10343996e-16-2.04994192e-16j
  -1.55431223e-15+9.66465560e-17j -6.80509561e-16-4.17752206e-16j]
 [ 3.32328854e-01+9.87747890e-02j -1.65469228e-01-9.70589486e-02j
   2.65771831e-01+6.03134820e-02j  2.16253981e-01-7.57114251e-02j
  -2.42303870e-01+1.05196026e-01j -1.46745106e-01+2.12749330e-01j
  -1.79604040e-01-1.23327771e-01j -1.82464731e-01-5.62224939e-02j
   9.31300660e-17-5.25674744e-16j  1.05061502e-17-2.37378906e-16j
  -1.59594560e-16+2.37097241e-31j  9.74310042e-17-7.93943605e-16j
  -1.04397772e-15-1.95389221e-16j  6.24466765e-16-1.66607481e-16j
  -4.94538279e-16+6.78910181e-16j -1.11022302e-15-1.16084385e-16j]
 [ 1.55431223e-15-1.10674858e-16j  3.41853557e-16-1.99414575e-16j
  -4.93456202e-16+1.23283508e-15j  3.07669301e-16+1.02094683e-15j
   5.21888575e-16+1.68410989e-16j  1.27029841e-16+2.84823519e-16j
  -4.10085137e-17+2.75731010e-16j  9.35348110e-17-4.52404733e-16j
   6.99931479e-03-2.01517056e-01j -8.21413892e-03-1.30848925e-01j
   5.02324774e-02-2.11448680e-01j -9.79679473e-02-1.30337520e-01j
  -3.05106567e-01-1.53130653e-01j -2.93729117e-01+1.34842450e-01j
  -5.16022823e-02-4.99820252e-02j  3.32328854e-01-9.87747890e-02j]
 [ 2.46333796e-16+2.62438762e-16j  2.22044605e-16-1.14676604e-17j
  -4.89425065e-16-4.56796727e-16j -8.12918154e-16-9.03612548e-16j
  -1.32437051e-16+3.36957413e-17j -9.11951162e-16+4.66336739e-16j
  -3.59396313e-16+3.41320586e-16j -9.05373900e-17-1.78088511e-16j
  -8.21413892e-03-1.30848925e-01j -2.18498240e-02+4.29538954e-01j
  -9.40246429e-02+1.61472163e-01j -6.94946985e-02-2.18112813e-02j
   3.78664087e-01+1.19851684e-01j -3.26508497e-02-2.69120190e-01j
  -1.31512145e-01+2.71232726e-02j -1.65469228e-01+9.70589486e-02j]
 [-1.19443063e-15-1.20030076e-15j  1.86141251e-16+1.86615384e-16j
   1.11022302e-15-1.11022302e-15j  4.81348228e-16+8.77562803e-16j
   5.90777067e-16+1.14797263e-16j -1.02529827e-15+5.91316056e-16j
  -9.05242679e-16-1.72621803e-17j -8.93523410e-17+1.00270236e-16j
   5.02324774e-02-2.11448680e-01j -9.40246429e-02+1.61472163e-01j
  -4.32949778e-01+4.87917084e-01j  7.33175514e-02-8.11166517e-02j
  -2.76997749e-01-5.01226682e-02j -1.54631869e-01-2.28688266e-01j
   1.01087389e-01-1.69803475e-01j  2.65771831e-01-6.03134820e-02j]
 [ 4.19068735e-16-1.21946711e-15j -9.19407411e-16+9.98298307e-16j
   7.66029591e-16-6.37057833e-16j -3.77475828e-15-1.04083409e-17j
   1.25689694e-15+5.82454125e-16j -4.16329778e-16+1.06638287e-15j
  -3.62225160e-16-5.11819314e-16j  1.28941858e-16-7.96463367e-16j
  -9.79679473e-02-1.30337520e-01j -6.94946985e-02-2.18112813e-02j
   7.33175514e-02-8.11166517e-02j -6.67053424e-01+1.25311360e-01j
   1.08025857e-01+9.26630388e-02j -2.32217868e-02-2.70630341e-01j
   2.00873977e-01+1.66768214e-01j  2.16253981e-01+7.57114251e-02j]
 [ 3.03022921e-16-1.66612753e-16j -6.86699457e-18+1.26123279e-16j
   5.32350751e-16-7.68414187e-16j  1.22139189e-15-5.41368880e-16j
  -1.11022302e-15-9.71445147e-17j -2.37165748e-17-1.87328838e-16j
  -3.28414157e-16-2.61075064e-17j -1.03690021e-15-3.01958996e-16j
  -3.05106567e-01-1.53130653e-01j  3.78664087e-01+1.19851684e-01j
  -2.76997749e-01-5.01226682e-02j  1.08025857e-01+9.26630388e-02j
  -1.58110659e-01-1.31747035e-01j  1.04788815e-01-4.19717086e-02j
  -8.23949174e-02+3.83067781e-01j -2.42303870e-01-1.05196026e-01j]
 [ 1.43331307e-16-2.24866701e-16j -8.71150124e-16-3.25274812e-16j
  -2.83924466e-16-9.75819672e-16j -2.10396012e-16-1.23850576e-15j
  -5.25424189e-17+1.87661293e-16j -2.22044605e-15+3.33066907e-16j
   4.91214464e-16-4.11861824e-16j  5.86321778e-16-3.45454336e-16j
  -2.93729117e-01+1.34842450e-01j -3.26508497e-02-2.69120190e-01j
  -1.54631869e-01-2.28688266e-01j -2.32217868e-02-2.70630341e-01j
   1.04788815e-01-4.19717086e-02j -3.04510152e-01-4.11431324e-01j
  -3.21661900e-01-1.84852830e-01j -1.46745106e-01-2.12749330e-01j]
 [-7.59967311e-17-2.38117030e-16j -1.78080727e-16-2.75337892e-16j
  -5.53334387e-16+8.15177458e-17j -2.31694932e-16+4.98867353e-16j
  -3.72307863e-16+1.04655256e-16j  4.65277969e-16+1.65482839e-16j
  -1.55431223e-15+8.32667268e-17j -3.50970205e-16+4.88365351e-16j
  -5.16022823e-02-4.99820252e-02j -1.31512145e-01+2.71232726e-02j
   1.01087389e-01-1.69803475e-01j  2.00873977e-01+1.66768214e-01j
  -8.23949174e-02+3.83067781e-01j -3.21661900e-01-1.84852830e-01j
   2.46044595e-01+5.28315750e-02j -1.79604040e-01+1.23327771e-01j]
 [ 1.83853707e-17+4.70848767e-16j -9.84968319e-17+2.01826595e-16j
   5.35496956e-17+5.25925119e-16j  2.84447672e-16+7.66142554e-16j
  -1.06130302e-15+5.64362389e-16j  6.63719266e-16+2.29124908e-16j
  -5.89267450e-16-7.70135672e-16j -1.11022302e-15+7.45931095e-17j
   3.32328854e-01-9.87747890e-02j -1.65469228e-01+9.70589486e-02j
   2.65771831e-01-6.03134820e-02j  2.16253981e-01+7.57114251e-02j
  -2.42303870e-01-1.05196026e-01j -1.46745106e-01-2.12749330e-01j
  -1.79604040e-01+1.23327771e-01j -1.82464731e-01+5.62224939e-02j]], gamma = [-0.60352587+0.70237239j  0.02148851+0.88618986j -0.23339921-0.30051711j
  0.00712665-1.13078601j -0.29926758-0.58688656j  0.30200677-0.15027749j
 -1.69372628+0.58425311j  0.29408185-1.79270437j -0.60352587-0.70237239j
  0.02148851-0.88618986j -0.23339921+0.30051711j  0.00712665+1.13078601j
 -0.29926758+0.58688656j  0.30200677+0.15027749j -1.69372628-0.58425311j
  0.29408185+1.79270437j]
INFO 2022-02-11 19:24:00,080 For k = 1, lhaf_k_approx=(0.012797818548946044-1.34332649170954e-16j), prob_k_approx = 3.998551547901831e-12, time = 0.03841996192932129
