INFO 2022-02-10 19:04:27,081 NumExpr defaulting to 8 threads.
INFO 2022-02-10 19:04:31,850 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 4, hbar = 2
INFO 2022-02-10 19:04:31,850 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-10 19:04:31,851 U = [[-0.1253989 +0.05390418j  0.06465328-0.09156628j  0.74111318-0.26121731j
  -0.19979139-0.09180166j  0.04699065+0.15280998j  0.00320299-0.47443755j
  -0.10263624+0.19819049j -0.0327327 +0.03784558j]
 [ 0.00526309-0.34122179j -0.03638636-0.30420136j  0.01246317+0.04206319j
  -0.09607315+0.2107268j  -0.36658383-0.1816135j  -0.17335297+0.13710158j
  -0.37068656+0.44824535j  0.21443403-0.36549617j]
 [ 0.33892146+0.03944737j  0.35652668+0.42541192j  0.15665287+0.06157647j
  -0.12498473+0.18409305j -0.3524741 +0.43140476j -0.21539839+0.13418558j
   0.20791305-0.02209188j  0.27607739-0.05441915j]
 [ 0.15126582-0.61343237j -0.1687223 +0.35895673j -0.18490944-0.10632139j
  -0.33499845-0.06210725j  0.06982723+0.21111229j  0.05073093-0.08764715j
  -0.22826143+0.06383445j -0.35811323+0.19442769j]
 [ 0.26703429-0.04316215j -0.17971201-0.43763301j -0.08265792+0.02499541j
   0.10835069+0.41355731j -0.19926192+0.2385401j   0.2624854 -0.20401427j
   0.06622088+0.00496428j  0.13175076+0.53281218j]
 [ 0.27597865-0.36546397j  0.13498   -0.18686691j  0.17641936+0.24716748j
   0.13122609-0.18473451j  0.03367451-0.32039094j -0.37537484-0.07984634j
   0.51436664+0.11393551j -0.20420175+0.15248482j]
 [ 0.01765956+0.16581575j  0.02702027-0.19766591j -0.05139456+0.06572302j
   0.02440365-0.5254917j   0.11187034+0.35713266j -0.21097898+0.37533183j
  -0.21098383+0.36217334j  0.09903993+0.37115489j]
 [-0.06329777-0.18599257j  0.33243608+0.02993087j -0.27126717-0.35573186j
   0.16259114-0.44174395j -0.31693014-0.07991912j  0.39638605-0.22601469j
   0.18153263+0.1461435j   0.24253566-0.01067877j]]
INFO 2022-02-10 19:04:31,854 
INFO 2022-02-10 19:04:31,854 Number of coherent states = 0
INFO 2022-02-10 19:04:31,869 mu = [ 0.  0.  0.  0.  0. -0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
INFO 2022-02-10 19:04:31,871 cov = [[ 8.39903508e+00 -8.56527294e-01 -1.63908319e+00  1.36002005e+00
   3.27072361e+00 -7.29269870e-01  4.52772565e-01  5.41167122e+00
   4.51585318e+00  6.63349603e-01 -1.24417447e+00 -6.74943221e-01
   2.09072176e+00 -4.91436399e+00 -1.96689240e+00  3.74942264e+00]
 [-8.56527294e-01  1.42547517e+01 -3.35510583e+00 -2.26956484e-01
  -6.14808388e-01  4.33302532e+00 -2.01890633e+00 -1.66631498e-02
   6.63349603e-01  4.70022063e+00  4.80891155e+00  1.23646556e+00
  -8.11037215e-01 -3.26666179e+00  4.23737820e+00 -1.06228177e+00]
 [-1.63908319e+00 -3.35510583e+00  9.52158761e+00  3.93986753e+00
  -1.41286934e+00 -6.03551814e+00  1.32762588e-01 -3.66150984e+00
  -1.24417447e+00  4.80891155e+00  1.08331867e+00  1.71472973e+00
   2.44644464e+00 -1.48948235e+00 -7.25322246e-01 -1.13885202e+00]
 [ 1.36002005e+00 -2.26956484e-01  3.93986753e+00  1.36566372e+01
   2.92277429e-01  2.62699246e+00 -2.04713137e-01  4.43690583e+00
  -6.74943221e-01  1.23646556e+00  1.71472973e+00  4.13800251e+00
   5.79269461e+00  2.53890035e+00 -1.12341434e+00 -2.96840503e+00]
 [ 3.27072361e+00 -6.14808388e-01 -1.41286934e+00  2.92277429e-01
   1.66038275e+01  1.08567321e+00  1.59149086e+00 -3.86716523e+00
   2.09072176e+00 -8.11037215e-01  2.44644464e+00  5.79269461e+00
  -1.75694009e+00  7.51814740e-01 -2.60675582e+00  2.40656810e+00]
 [-7.29269870e-01  4.33302532e+00 -6.03551814e+00  2.62699246e+00
   1.08567321e+00  9.10471055e+00  9.55399991e-01  2.54171081e+00
  -4.91436399e+00 -3.26666179e+00 -1.48948235e+00  2.53890035e+00
   7.51814740e-01  1.33072819e+00  1.25489981e+00  1.88638033e-01]
 [ 4.52772565e-01 -2.01890633e+00  1.32762588e-01 -2.04713137e-01
   1.59149086e+00  9.55399991e-01  1.96364316e+01  2.38342560e+00
  -1.96689240e+00  4.23737820e+00 -7.25322246e-01 -1.12341434e+00
  -2.60675582e+00  1.25489981e+00  2.15996576e+00 -2.63152948e-01]
 [ 5.41167122e+00 -1.66631498e-02 -3.66150984e+00  4.43690583e+00
  -3.86716523e+00  2.54171081e+00  2.38342560e+00  9.70623180e+00
   3.74942264e+00 -1.06228177e+00 -1.13885202e+00 -2.96840503e+00
   2.40656810e+00  1.88638033e-01 -2.63152948e-01 -1.34629255e-01]
 [ 4.51585318e+00  6.63349603e-01 -1.24417447e+00 -6.74943221e-01
   2.09072176e+00 -4.91436399e+00 -1.96689240e+00  3.74942264e+00
   1.38439654e+01  8.56527294e-01  1.63908319e+00 -1.36002005e+00
  -3.27072361e+00  7.29269870e-01 -4.52772565e-01 -5.41167122e+00]
 [ 6.63349603e-01  4.70022063e+00  4.80891155e+00  1.23646556e+00
  -8.11037215e-01 -3.26666179e+00  4.23737820e+00 -1.06228177e+00
   8.56527294e-01  7.98824876e+00  3.35510583e+00  2.26956484e-01
   6.14808388e-01 -4.33302532e+00  2.01890633e+00  1.66631498e-02]
 [-1.24417447e+00  4.80891155e+00  1.08331867e+00  1.71472973e+00
   2.44644464e+00 -1.48948235e+00 -7.25322246e-01 -1.13885202e+00
   1.63908319e+00  3.35510583e+00  1.27214129e+01 -3.93986753e+00
   1.41286934e+00  6.03551814e+00 -1.32762588e-01  3.66150984e+00]
 [-6.74943221e-01  1.23646556e+00  1.71472973e+00  4.13800251e+00
   5.79269461e+00  2.53890035e+00 -1.12341434e+00 -2.96840503e+00
  -1.36002005e+00  2.26956484e-01 -3.93986753e+00  8.58636333e+00
  -2.92277429e-01 -2.62699246e+00  2.04713137e-01 -4.43690583e+00]
 [ 2.09072176e+00 -8.11037215e-01  2.44644464e+00  5.79269461e+00
  -1.75694009e+00  7.51814740e-01 -2.60675582e+00  2.40656810e+00
  -3.27072361e+00  6.14808388e-01  1.41286934e+00 -2.92277429e-01
   5.63917298e+00 -1.08567321e+00 -1.59149086e+00  3.86716523e+00]
 [-4.91436399e+00 -3.26666179e+00 -1.48948235e+00  2.53890035e+00
   7.51814740e-01  1.33072819e+00  1.25489981e+00  1.88638033e-01
   7.29269870e-01 -4.33302532e+00  6.03551814e+00 -2.62699246e+00
  -1.08567321e+00  1.31382899e+01 -9.55399991e-01 -2.54171081e+00]
 [-1.96689240e+00  4.23737820e+00 -7.25322246e-01 -1.12341434e+00
  -2.60675582e+00  1.25489981e+00  2.15996576e+00 -2.63152948e-01
  -4.52772565e-01  2.01890633e+00 -1.32762588e-01  2.04713137e-01
  -1.59149086e+00 -9.55399991e-01  2.60656890e+00 -2.38342560e+00]
 [ 3.74942264e+00 -1.06228177e+00 -1.13885202e+00 -2.96840503e+00
   2.40656810e+00  1.88638033e-01 -2.63152948e-01 -1.34629255e-01
  -5.41167122e+00  1.66631498e-02  3.66150984e+00 -4.43690583e+00
   3.86716523e+00 -2.54171081e+00 -2.38342560e+00  1.25367687e+01]]
INFO 2022-02-10 19:04:31,879 A=[[-2.24598037e-01-3.72549032e-01j -7.06618221e-02-5.47250414e-02j
  -1.35221149e-01+1.02641954e-01j  1.12198988e-01+5.56814922e-02j
   2.69828284e-01-1.72480445e-01j -6.01633342e-02+4.05425393e-01j
   3.73528487e-02+1.62264766e-01j  4.46452264e-01-3.09320015e-01j
   0.00000000e+00+1.11022302e-16j  6.93889390e-17+1.11022302e-16j
  -4.99600361e-16-8.88178420e-16j  1.90512990e-30+6.66133815e-16j
  -4.99600361e-16+3.60822483e-16j -8.32667268e-16-1.24145444e-30j
  -1.66533454e-16-5.55111512e-17j  1.11022302e-16+4.44089210e-16j]
 [-7.06618221e-02-5.47250414e-02j  2.58487103e-01-3.87758985e-01j
  -2.76789651e-01-3.96725772e-01j -1.87234649e-02-1.02005984e-01j
  -5.07204864e-02+6.69089798e-02j  3.57466092e-01+2.69493192e-01j
  -1.66555813e-01-3.49575392e-01j -1.37467718e-03+8.76361628e-02j
  -6.93889390e-18-1.11022302e-16j -1.77635684e-15+1.32672499e-31j
   7.10583890e-31-2.77555756e-17j  1.05471187e-15+5.55111512e-17j
   9.71445147e-17-6.93889390e-16j  1.11022302e-15+2.35922393e-16j
  -2.22044605e-16-3.33066907e-16j  2.61943245e-16-1.05471187e-15j]
 [-1.35221149e-01+1.02641954e-01j -2.76789651e-01-3.96725772e-01j
  -1.31989655e-01-8.93716663e-02j  3.25031345e-01-1.41461840e-01j
  -1.16558950e-01-2.01826886e-01j -4.97918411e-01+1.22879373e-01j
   1.09526532e-02+5.98376630e-02j -3.02067381e-01+9.39530584e-02j
  -2.49800181e-16+5.41233725e-16j -2.22044605e-16+1.66533454e-16j
  -1.77635684e-15+9.36750677e-17j  8.88178420e-16-8.32667268e-16j
   1.22644950e-15+4.99600361e-16j -2.77555756e-16+2.22044605e-16j
   8.16209110e-31-3.33066907e-16j -9.99200722e-16+5.55111512e-16j]
 [ 1.12198988e-01+5.56814922e-02j -1.87234649e-02-1.02005984e-01j
   3.25031345e-01-1.41461840e-01j  2.09143824e-01-3.41377092e-01j
   2.41123148e-02-4.77885946e-01j  2.16721726e-01-2.09454301e-01j
  -1.68884324e-02+9.26794800e-02j  3.66036030e-01+2.44887594e-01j
  -2.22044605e-16-5.55111512e-16j  1.08246745e-15+5.55111512e-17j
   8.88178420e-16+9.15933995e-16j -8.88178420e-16-1.11022302e-16j
   5.55111512e-16-2.22044605e-16j  7.77156117e-16-3.05311332e-16j
   2.49800181e-16+1.66533454e-16j  1.52655666e-16+1.94289029e-16j]
 [ 2.69828284e-01-1.72480445e-01j -5.07204864e-02+6.69089798e-02j
  -1.16558950e-01-2.01826886e-01j  2.41123148e-02-4.77885946e-01j
   4.52281249e-01+1.44944112e-01j  8.95659112e-02-6.20232418e-02j
   1.31294875e-01+2.15052244e-01j -3.19033548e-01-1.98537149e-01j
  -3.33066907e-16-3.60822483e-16j -2.77555756e-17+7.49400542e-16j
   1.20823490e-15-6.10622664e-16j  5.55111512e-16+2.18487123e-30j
  -8.88178420e-16+1.11022302e-16j -2.98372438e-16-1.41553436e-15j
  -4.44089210e-16+3.33066907e-16j  3.33066907e-16-2.22044605e-16j]
 [-6.01633342e-02+4.05425393e-01j  3.57466092e-01+2.69493192e-01j
  -4.97918411e-01+1.22879373e-01j  2.16721726e-01-2.09454301e-01j
   8.95659112e-02-6.20232418e-02j -1.66381194e-01-1.09782466e-01j
   7.88186257e-02-1.03526773e-01j  2.09686157e-01-1.55622678e-02j
  -1.05471187e-15+2.22044605e-16j  1.33226763e-15-4.37150316e-16j
  -3.33066907e-16-2.22044605e-16j  7.77156117e-16+2.84494650e-16j
  -3.19189120e-16+1.41553436e-15j -8.88178420e-16+2.56341276e-31j
   8.60422844e-16-1.11022302e-16j -4.30445343e-31+1.70349707e-30j]
 [ 3.73528487e-02+1.62264766e-01j -1.66555813e-01-3.49575392e-01j
   1.09526532e-02+5.98376630e-02j -1.68884324e-02+9.26794800e-02j
   1.31294875e-01+2.15052244e-01j  7.88186257e-02-1.03526773e-01j
   7.02465138e-01-1.78192940e-01j  1.96627938e-01+2.17096021e-02j
  -3.88578059e-16+1.11022302e-16j -2.22044605e-16+5.55111512e-16j
   5.55111512e-17+3.33066907e-16j  2.49800181e-16-1.11022302e-16j
  -3.33066907e-16-1.11022302e-16j  8.32667268e-16+2.22044605e-16j
   8.88178420e-16+1.11022302e-16j  1.11022302e-16-5.82867088e-16j]
 [ 4.46452264e-01-3.09320015e-01j -1.37467718e-03+8.76361628e-02j
  -3.02067381e-01+9.39530584e-02j  3.66036030e-01+2.44887594e-01j
  -3.19033548e-01-1.98537149e-01j  2.09686157e-01-1.55622678e-02j
   1.96627938e-01+2.17096021e-02j -1.16756871e-01+1.11066496e-02j
   6.66133815e-16-4.44089210e-16j  3.72965547e-16+1.04083409e-15j
  -1.05471187e-15-6.66133815e-16j  9.71445147e-17-3.88578059e-16j
   2.22044605e-16+2.22044605e-16j -2.10118957e-31+2.22044605e-16j
   1.11022302e-16+6.93889390e-16j -8.88178420e-16-5.55111512e-17j]
 [-2.22044605e-16-1.83182445e-16j -8.81565516e-17-2.19818934e-16j
  -3.89262695e-16+2.79353228e-16j -7.32729779e-17-8.51798368e-16j
  -1.00750345e-16-1.92341567e-16j -1.28227711e-15+3.66364890e-16j
  -7.32729779e-17+1.28227711e-16j -3.66364890e-17-2.74773667e-16j
  -2.24598037e-01+3.72549032e-01j -7.06618221e-02+5.47250414e-02j
  -1.35221149e-01-1.02641954e-01j  1.12198988e-01-5.56814922e-02j
   2.69828284e-01+1.72480445e-01j -6.01633342e-02-4.05425393e-01j
   3.73528487e-02-1.62264766e-01j  4.46452264e-01+3.09320015e-01j]
 [ 4.65282691e-17+1.61841762e-16j -1.77635684e-15-3.66364890e-17j
  -2.93091912e-16+3.61785329e-16j  1.21358370e-15-4.57956112e-17j
   7.09831974e-17+5.49547334e-16j  1.39218658e-15-6.67471033e-16j
  -2.19818934e-16+3.48046645e-16j  7.32729779e-17+9.18202005e-16j
  -7.06618221e-02+5.47250414e-02j  2.58487103e-01+3.87758985e-01j
  -2.76789651e-01+3.96725772e-01j -1.87234649e-02+1.02005984e-01j
  -5.07204864e-02-6.69089798e-02j  3.57466092e-01-2.69493192e-01j
  -1.66555813e-01+3.49575392e-01j -1.37467718e-03-8.76361628e-02j]
 [-2.59477861e-16-3.86972915e-16j -1.77137568e-16-1.64864200e-16j
  -2.22044605e-15+9.84605641e-17j  4.76274357e-16+7.92264074e-16j
   1.09036488e-15-4.94592601e-16j -4.12160501e-16-6.04502068e-16j
  -9.15912224e-18+2.38137178e-16j -1.02582169e-15-8.06002757e-16j
  -1.35221149e-01-1.02641954e-01j -2.76789651e-01+3.96725772e-01j
  -1.31989655e-01+8.93716663e-02j  3.25031345e-01+1.41461840e-01j
  -1.16558950e-01+2.01826886e-01j -4.97918411e-01-1.22879373e-01j
   1.09526532e-02-5.98376630e-02j -3.02067381e-01-9.39530584e-02j]
 [-2.22841372e-16+8.16627195e-16j  1.26013492e-15+1.77137568e-16j
   4.64184603e-16-7.96843635e-16j  0.00000000e+00-6.41138557e-17j
   6.22820312e-16+1.09909467e-16j  7.14411535e-16-2.28978056e-17j
   3.11410156e-16-1.55705078e-16j  4.09870720e-16-7.69366268e-16j
   1.12198988e-01-5.56814922e-02j -1.87234649e-02+1.02005984e-01j
   3.25031345e-01+1.41461840e-01j  2.09143824e-01+3.41377092e-01j
   2.41123148e-02+4.77885946e-01j  2.16721726e-01+2.09454301e-01j
  -1.68884324e-02-9.26794800e-02j  3.66036030e-01-2.44887594e-01j]
 [ 1.19068589e-16+3.25148840e-16j  5.42679789e-17-4.68764164e-16j
   1.09635845e-15+3.93842256e-16j  5.89206262e-16-2.93091912e-16j
  -1.55431223e-15+5.49547334e-17j -5.30084200e-16+1.13573116e-15j
  -2.74773667e-16-3.29728401e-16j  5.49547334e-17+4.39637868e-16j
   2.69828284e-01+1.72480445e-01j -5.07204864e-02-6.69089798e-02j
  -1.16558950e-01+2.01826886e-01j  2.41123148e-02+4.77885946e-01j
   4.52281249e-01-1.44944112e-01j  8.95659112e-02+6.20232418e-02j
   1.31294875e-01-2.15052244e-01j -3.19033548e-01+1.98537149e-01j]
 [-1.09758345e-15-2.93091912e-16j  1.39841507e-15+4.91661969e-16j
  -3.23499910e-16+4.21319623e-16j  6.29048803e-16-4.35058306e-17j
  -5.49639141e-16-1.12959447e-15j -1.33226763e-15-1.83182445e-17j
   9.75446519e-16+1.64864200e-16j -3.11410156e-16-3.66364890e-16j
  -6.01633342e-02-4.05425393e-01j  3.57466092e-01-2.69493192e-01j
  -4.97918411e-01-1.22879373e-01j  2.16721726e-01+2.09454301e-01j
   8.95659112e-02+6.20232418e-02j -1.66381194e-01+1.09782466e-01j
   7.88186257e-02+1.03526773e-01j  2.09686157e-01+1.55622678e-02j]
 [-9.00800032e-17+4.89098565e-17j  7.93178549e-17-1.83182445e-16j
   6.09996104e-17-3.87705573e-16j  3.67120499e-16+1.98570058e-16j
  -4.15274746e-16+5.49547334e-16j  1.01515135e-15-7.93178549e-17j
   6.66133815e-16+7.32729779e-17j  5.49547334e-17+5.12910846e-16j
   3.73528487e-02-1.62264766e-01j -1.66555813e-01+3.49575392e-01j
   1.09526532e-02-5.98376630e-02j -1.68884324e-02-9.26794800e-02j
   1.31294875e-01-2.15052244e-01j  7.88186257e-02+1.03526773e-01j
   7.02465138e-01+1.78192940e-01j  1.96627938e-01-2.17096021e-02j]
 [-7.95014684e-17+5.08331284e-16j  1.10995656e-16-1.01208301e-15j
  -8.97593980e-16+6.47183434e-16j  2.10659812e-16+5.92412314e-16j
   1.40317465e-16-1.83182445e-16j -3.42001768e-16+3.20477472e-16j
   1.22733675e-17-6.91605536e-16j -8.88178420e-16+3.25148840e-16j
   4.46452264e-01+3.09320015e-01j -1.37467718e-03-8.76361628e-02j
  -3.02067381e-01-9.39530584e-02j  3.66036030e-01-2.44887594e-01j
  -3.19033548e-01+1.98537149e-01j  2.09686157e-01+1.55622678e-02j
   1.96627938e-01-2.17096021e-02j -1.16756871e-01-1.11066496e-02j]], gamma = [0.-0.j 0.-0.j 0.-0.j 0.-0.j 0.-0.j 0.-0.j 0.-0.j 0.-0.j 0.+0.j 0.+0.j
 0.+0.j 0.+0.j 0.+0.j 0.+0.j 0.+0.j 0.+0.j]
INFO 2022-02-10 19:04:32,128 lhaf_exact = (0.028340931703653816-4.489741911584133e-12j), prob_exact = (3.646583182894455e-08-5.776875677749792e-18j)
INFO 2022-02-10 19:04:38,282 lhaf_k for k=N is (0.028340925757220248-1.4717493848702659e-09j), prob_k = (3.646582417776185e-08-1.8936768201467776e-15j)
INFO 2022-02-10 19:04:38,282 For k = 0, lhaf_k_approx=0j, prob_k_approx
INFO 2022-02-10 19:04:38,361 For k = 1, lhaf_k_approx=0j, prob_k_approx
INFO 2022-02-10 19:04:42,316 For k = 2, lhaf_k_approx=0j, prob_k_approx
