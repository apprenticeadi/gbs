INFO 2022-02-11 19:22:37,833 NumExpr defaulting to 8 threads.
INFO 2022-02-11 19:22:41,939 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 4, hbar = 2
INFO 2022-02-11 19:22:41,939 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-11 19:22:41,939 U = [[-0.12095062-0.21188007j -0.09691354+0.21654344j -0.25800091+0.42678658j
  -0.42855193-0.19457815j -0.17574049-0.35312447j  0.12069931+0.28592279j
  -0.32873791+0.05192823j  0.21594962-0.06829821j]
 [-0.42272002+0.17947907j  0.41613174+0.34546097j -0.1062458 -0.45663305j
   0.12992367+0.08103638j -0.10693622-0.1458382j   0.07472857+0.09450527j
  -0.16354286-0.01323969j  0.25478927+0.33805074j]
 [-0.03830558+0.20946147j -0.27483744+0.06522645j -0.21718294+0.02108223j
   0.12767634-0.08543623j -0.05124413+0.0770623j   0.35078198-0.44655926j
  -0.52454869+0.05348462j -0.40906938+0.16515921j]
 [ 0.19844069-0.09634863j  0.06101918-0.35112977j  0.13674749-0.28735591j
   0.02082156-0.09063504j -0.18139266-0.57034913j  0.12915436+0.14098333j
   0.02996776+0.47357567j -0.28084793+0.12488041j]
 [ 0.03735544+0.09150388j -0.14530701+0.09638827j  0.01678714-0.0188087j
   0.04787446+0.25427876j -0.01989493-0.61441533j -0.06447107-0.55730043j
   0.12701123-0.23190535j  0.25049346-0.25872833j]
 [-0.49042383-0.14761553j  0.10453154-0.5287289j  -0.15831521+0.29976573j
   0.01871565+0.3174318j   0.07100686-0.0955374j  -0.31797372-0.08749822j
  -0.0866863 -0.06512086j -0.13326659+0.28058651j]
 [ 0.26004869+0.49124632j -0.0769308 +0.04478029j -0.19065781-0.1264238j
  -0.54314585+0.38118734j -0.0054932 -0.04283173j -0.17486501+0.20155717j
   0.04265258-0.15359094j -0.25297464+0.16736235j]
 [-0.05471025-0.22705482j -0.31601117-0.1254178j  -0.08681827-0.4551605j
  -0.1662221 +0.29458926j  0.08877675+0.20767968j -0.18666727-0.02434466j
  -0.36459004+0.34514761j  0.28107557-0.28850191j]]
INFO 2022-02-11 19:22:41,939 
INFO 2022-02-11 19:22:41,939 Number of coherent states = 2
INFO 2022-02-11 19:22:41,957 mu = [-0.98038873 -0.02964723 -1.40914357  1.16756943 -0.48578206 -1.73651533
  0.82403047 -1.66824639  0.02098518  2.36223018  1.23609564 -2.01365281
  0.84551468 -3.04354993  2.41211975 -1.58612682]
INFO 2022-02-11 19:22:41,959 cov = [[ 9.76595130e+00 -3.40838578e+00 -3.05115240e+00  3.30269115e+00
   1.37797991e-01  1.12708365e+00 -1.76960773e+00 -6.46286314e+00
  -8.42357798e-01  6.04020345e-01 -1.56646045e-02 -3.82842872e+00
   5.51380151e-01  3.99021794e+00  1.01822055e-01  2.91795250e+00]
 [-3.40838578e+00  8.49494239e+00 -3.65683055e-01  5.49001787e+00
  -4.29876063e-01 -1.76888157e-01  3.78534114e+00  1.96565711e+00
  -4.15034179e+00 -3.76595963e+00 -3.77921898e-01  2.44672192e+00
  -1.64117542e+00  1.31662087e-01  1.10203516e+00 -1.95862377e+00]
 [-3.05115240e+00 -3.65683055e-01  5.55292142e+00 -1.37742521e+00
   2.81387498e+00  1.11918037e+00 -2.30545690e+00 -7.89661440e-01
   3.83977464e-01  4.40298176e-01  6.01889207e+00  2.60711168e+00
  -1.61510019e+00 -2.33138713e+00 -1.86134735e+00 -2.79678888e+00]
 [ 3.30269115e+00  5.49001787e+00 -1.37742521e+00  1.51844433e+01
   2.44087113e+00 -1.41468640e+00  4.63512548e-02  2.46292107e+00
  -2.32002193e+00 -8.34333325e-01  3.71336237e+00 -1.32037927e+00
  -1.89482295e+00  2.12929089e+00 -1.48129117e+00  3.70429628e+00]
 [ 1.37797991e-01 -4.29876063e-01  2.81387498e+00  2.44087113e+00
   1.94411027e+01  2.67657906e+00  1.91309664e-01 -7.86181729e-01
   9.35417702e-01 -7.31797533e-01 -2.18884511e+00 -2.36816189e+00
   7.58805979e-01 -4.23839225e+00 -4.88669085e-01 -4.14912923e-01]
 [ 1.12708365e+00 -1.76888157e-01  1.11918037e+00 -1.41468640e+00
   2.67657906e+00  7.00558876e+00  2.58148445e+00 -3.54514297e+00
   2.82722770e+00 -2.00825780e+00  2.66611713e+00  6.69708571e-01
  -2.09032966e+00  1.15695582e+00  6.14113634e+00 -7.75049345e-01]
 [-1.76960773e+00  3.78534114e+00 -2.30545690e+00  4.63512548e-02
   1.91309664e-01  2.58148445e+00  6.00432206e+00  1.11037421e+00
   2.63799044e-01 -3.13121879e+00 -3.49246819e+00  5.07752792e-01
  -5.80499472e-01  1.31264897e+00  5.91119453e+00 -2.12391548e-01]
 [-6.46286314e+00  1.96565711e+00 -7.89661440e-01  2.46292107e+00
  -7.86181729e-01 -3.54514297e+00  1.11037421e+00  1.21709256e+01
   4.87049600e+00  1.33651487e+00 -1.27372677e+00  2.84403367e-01
   5.00239173e-01 -2.33208711e+00 -3.81816093e-01  4.28432120e+00]
 [-8.42357798e-01 -4.15034179e+00  3.83977464e-01 -2.32002193e+00
   9.35417702e-01  2.82722770e+00  2.63799044e-01  4.87049600e+00
   1.01327981e+01  2.44524976e+00  3.03066236e+00 -1.57119388e+00
  -3.61451809e-01 -4.38225647e-01  4.16609237e+00  5.28486242e+00]
 [ 6.04020345e-01 -3.76595963e+00  4.40298176e-01 -8.34333325e-01
  -7.31797533e-01 -2.00825780e+00 -3.13121879e+00  1.33651487e+00
   2.44524976e+00  3.55745107e+00  1.13590705e+00 -1.50038505e+00
   9.67051171e-01 -6.66471001e-01 -3.00997634e+00  1.93018339e+00]
 [-1.56646045e-02 -3.77921898e-01  6.01889207e+00  3.71336237e+00
  -2.18884511e+00  2.66611713e+00 -3.49246819e+00 -1.27372677e+00
   3.03066236e+00  1.13590705e+00  1.41570414e+01  2.74293738e+00
  -4.10858666e+00  4.06131485e-01 -6.29778711e-02  1.17439701e-01]
 [-3.82842872e+00  2.44672192e+00  2.60711168e+00 -1.32037927e+00
  -2.36816189e+00  6.69708571e-01  5.07752792e-01  2.84403367e-01
  -1.57119388e+00 -1.50038505e+00  2.74293738e+00  3.50232303e+00
  -1.54785644e+00 -7.90452379e-01  2.80464236e-01 -3.18711166e+00]
 [ 5.51380151e-01 -1.64117542e+00 -1.61510019e+00 -1.89482295e+00
   7.58805979e-01 -2.09032966e+00 -5.80499472e-01  5.00239173e-01
  -3.61451809e-01  9.67051171e-01 -4.10858666e+00 -1.54785644e+00
   1.98867132e+00 -6.93173439e-01 -1.61155978e+00  5.63312140e-01]
 [ 3.99021794e+00  1.31662087e-01 -2.33138713e+00  2.12929089e+00
  -4.23839225e+00  1.15695582e+00  1.31264897e+00 -2.33208711e+00
  -4.38225647e-01 -6.66471001e-01  4.06131485e-01 -7.90452379e-01
  -6.93173439e-01  4.04734474e+00  2.11019499e+00  1.64985339e+00]
 [ 1.01822055e-01  1.10203516e+00 -1.86134735e+00 -1.48129117e+00
  -4.88669085e-01  6.14113634e+00  5.91119453e+00 -3.81816093e-01
   4.16609237e+00 -3.00997634e+00 -6.29778711e-02  2.80464236e-01
  -1.61155978e+00  2.11019499e+00  9.82424056e+00  1.05709300e+00]
 [ 2.91795250e+00 -1.95862377e+00 -2.79678888e+00  3.70429628e+00
  -4.14912923e-01 -7.75049345e-01 -2.12391548e-01  4.28432120e+00
   5.28486242e+00  1.93018339e+00  1.17439701e-01 -3.18711166e+00
   5.63312140e-01  1.64985339e+00  1.05709300e+00  6.62793501e+00]]
INFO 2022-02-11 19:22:41,967 A=[[-1.51320721e-02+6.94928665e-02j -2.41456727e-01+1.46282283e-01j
  -2.50868896e-01-1.51925443e-02j  2.01042979e-01+2.53617561e-01j
   2.05935647e-02-6.13289536e-02j  6.45674739e-02-2.81212948e-01j
  -2.44841810e-01-1.50815119e-02j -4.84582161e-01-3.21265864e-01j
   2.66453526e-15+1.11022302e-16j -2.22044605e-16-8.88178420e-16j
  -7.77156117e-16-3.60822483e-16j  5.55111512e-16+1.11022302e-16j
  -5.68989300e-16-6.10622664e-16j -3.33066907e-16+5.55111512e-16j
   1.11022302e-15+5.13478149e-16j  8.32667268e-16-1.22124533e-15j]
 [-2.41456727e-01+1.46282283e-01j  2.03666676e-01+3.10684285e-01j
  -6.19391194e-02-2.57296031e-03j  2.88347266e-01-6.65094484e-02j
  -5.76218787e-02+9.78828076e-02j  2.01948123e-02+7.74077331e-02j
   2.80300183e-01+8.37018351e-02j  1.46325633e-03+2.56613819e-02j
  -1.66533454e-16+8.88178420e-16j  4.44089210e-16+2.77555756e-17j
   5.55111512e-17-3.33066907e-16j  7.77156117e-16+1.11022302e-16j
   1.94289029e-16+1.66533454e-16j -3.05311332e-16+4.44089210e-16j
  -2.22044605e-16+1.11022302e-15j -5.55111512e-16-2.75022796e-30j]
 [-2.50868896e-01-1.51925443e-02j -6.19391194e-02-2.57296031e-03j
  -3.54911515e-01-4.96546793e-01j -1.69960917e-01-2.60713357e-01j
   2.85544755e-01+1.56909014e-01j  2.94125674e-02-1.38072842e-02j
  -9.25000614e-02+2.20839642e-01j -3.74170327e-02+1.67904780e-01j
  -4.44089210e-16+6.10622664e-16j  8.32667268e-17+4.71844785e-16j
   1.77635684e-15+3.89808221e-31j -2.77555756e-16+1.11022302e-16j
  -5.55111512e-17+4.44089210e-16j -7.77156117e-16-2.22044605e-16j
  -7.77156117e-16-5.55111512e-16j -5.55111512e-16-4.44089210e-16j]
 [ 2.01042979e-01+2.53617561e-01j  2.88347266e-01-6.65094484e-02j
  -1.69960917e-01-2.60713357e-01j  4.81876008e-01+1.08928700e-01j
   1.64531102e-01+1.75843945e-01j -2.57490415e-02-1.15455984e-01j
  -9.65693095e-03+4.01575037e-02j  2.33058310e-01-1.64529949e-01j
   3.33066907e-16-1.00822433e-30j  5.55111512e-16-2.22044605e-16j
  -5.55111512e-16-2.22044605e-16j  0.00000000e+00-1.03229845e-31j
  -6.10622664e-16-2.22044605e-16j  2.22044605e-16+3.33066907e-16j
  -1.38777878e-16+9.43689571e-16j -4.44089210e-16+6.66133815e-16j]
 [ 2.05935647e-02-6.13289536e-02j -5.76218787e-02+9.78828076e-02j
   2.85544755e-01+1.56909014e-01j  1.64531102e-01+1.75843945e-01j
   7.19895684e-01-6.26000053e-02j  1.38998987e-01+2.61053573e-01j
   7.43665968e-02+4.41021547e-02j -5.56652989e-02-3.51962416e-03j
  -6.52256027e-16+5.27355937e-16j  1.66533454e-16-1.66533454e-16j
   1.11022302e-16-2.22044605e-16j -6.66133815e-16+2.22044605e-16j
   1.77635684e-15-5.55111512e-17j  3.33066907e-16-3.33066907e-16j
   2.22044605e-16+3.88578059e-16j  3.33066907e-16-1.38975105e-30j]
 [ 6.45674739e-02-2.81212948e-01j  2.01948123e-02+7.74077331e-02j
   2.94125674e-02-1.38072842e-02j -2.57490415e-02-1.15455984e-01j
   1.38998987e-01+2.61053573e-01j  1.22024665e-01-9.54465866e-02j
   1.94402280e-02-3.07461336e-01j -2.14288507e-01+1.28166332e-01j
  -2.22044605e-16-4.99600361e-16j -2.77555756e-16-4.44089210e-16j
  -8.32667268e-16+2.22044605e-16j  3.33066907e-16-3.33066907e-16j
   2.77555756e-16+4.44089210e-16j  8.88178420e-16+1.52655666e-16j
   6.66133815e-16+6.66133815e-16j  6.10622664e-16+6.10622664e-16j]
 [-2.44841810e-01-1.50815119e-02j  2.80300183e-01+8.37018351e-02j
  -9.25000614e-02+2.20839642e-01j -9.65693095e-03+4.01575037e-02j
   7.43665968e-02+4.41021547e-02j  1.94402280e-02-3.07461336e-01j
  -1.57567893e-01-4.87661957e-01j  2.19779752e-03+2.45104826e-02j
   1.11022302e-15-3.26128013e-16j -2.22044605e-16-8.88178420e-16j
  -5.55111512e-16+5.55111512e-16j  8.32667268e-17-8.88178420e-16j
  -5.55111512e-17-3.33066907e-16j  6.66133815e-16-4.44089210e-16j
   8.88178420e-16+8.32667268e-17j  1.11022302e-15+1.11022302e-16j]
 [-4.84582161e-01-3.21265864e-01j  1.46325633e-03+2.56613819e-02j
  -3.74170327e-02+1.67904780e-01j  2.33058310e-01-1.64529949e-01j
  -5.56652989e-02-3.51962416e-03j -2.14288507e-01+1.28166332e-01j
   2.19779752e-03+2.45104826e-02j  2.28642927e-01-3.53448098e-01j
   6.66133815e-16+1.11022302e-15j -4.44089210e-16+2.50987190e-30j
  -4.99600361e-16+4.44089210e-16j -5.55111512e-16-6.66133815e-16j
   3.33066907e-16+1.11022302e-16j  6.66133815e-16-7.77156117e-16j
   1.11022302e-15-5.55111512e-17j  1.77635684e-15+2.77555756e-16j]
 [ 2.22044605e-15+2.70504127e-17j -2.18001444e-16+9.32843390e-16j
  -4.97943079e-16+5.37843473e-16j  4.16446291e-16-3.72383232e-17j
  -5.53057804e-16+5.82746033e-16j -1.78705720e-16-2.55848984e-16j
   1.04388666e-15-4.75788979e-16j  7.08462444e-16+1.08547328e-15j
  -1.51320721e-02-6.94928665e-02j -2.41456727e-01-1.46282283e-01j
  -2.50868896e-01+1.51925443e-02j  2.01042979e-01-2.53617561e-01j
   2.05935647e-02+6.13289536e-02j  6.45674739e-02+2.81212948e-01j
  -2.44841810e-01+1.50815119e-02j -4.84582161e-01+3.21265864e-01j]
 [-1.65391836e-16-9.26777248e-16j  3.33066907e-16-5.27143681e-17j
   5.98833628e-17+2.90862048e-16j  8.29799728e-16-5.16532677e-17j
   1.48328555e-16-2.72275233e-16j -3.17343408e-16-3.85647887e-16j
  -1.74576115e-16-1.01274729e-15j -4.98859323e-16+3.72437678e-17j
  -2.41456727e-01-1.46282283e-01j  2.03666676e-01-3.10684285e-01j
  -6.19391194e-02+2.57296031e-03j  2.88347266e-01+6.65094484e-02j
  -5.76218787e-02-9.78828076e-02j  2.01948123e-02-7.74077331e-02j
   2.80300183e-01-8.37018351e-02j  1.46325633e-03-2.56613819e-02j]
 [-7.19998908e-16-4.42653763e-16j  2.93263932e-16-2.75371155e-16j
   1.88737914e-15-7.84647968e-17j -4.52485346e-16-3.29080252e-16j
   3.11229300e-16-2.86204617e-16j -7.17576356e-16+8.24745243e-17j
  -5.84691048e-16+2.45226276e-16j -3.68314914e-16+5.80249526e-16j
  -2.50868896e-01+1.51925443e-02j -6.19391194e-02+2.57296031e-03j
  -3.54911515e-01+4.96546793e-01j -1.69960917e-01+2.60713357e-01j
   2.85544755e-01-1.56909014e-01j  2.94125674e-02+1.38072842e-02j
  -9.25000614e-02-2.20839642e-01j -3.74170327e-02-1.67904780e-01j]
 [ 4.81307451e-16-3.12537306e-17j  6.62579088e-16+1.25014922e-17j
  -1.98461189e-16+1.87522383e-16j  2.22044605e-16-7.81343264e-19j
  -6.25074612e-16+8.75104456e-17j  2.75032829e-16-3.59613237e-16j
   1.25014922e-16-1.08762982e-15j -5.50065658e-16-4.00047751e-16j
   2.01042979e-01-2.53617561e-01j  2.88347266e-01+6.65094484e-02j
  -1.69960917e-01+2.60713357e-01j  4.81876008e-01-1.08928700e-01j
   1.64531102e-01-1.75843945e-01j -2.57490415e-02+1.15455984e-01j
  -9.65693095e-03-4.01575037e-02j  2.33058310e-01+1.64529949e-01j]
 [-4.78348681e-16-7.48082224e-16j  1.04352174e-16+2.64494671e-16j
   1.82213320e-16+3.05895760e-16j -5.75108479e-16-1.55985850e-16j
   1.11022302e-15+2.94019094e-17j  3.46369187e-16+6.15767444e-16j
   1.50915632e-16-3.11959293e-16j  3.18681925e-16+9.35157393e-17j
   2.05935647e-02+6.13289536e-02j -5.76218787e-02-9.78828076e-02j
   2.85544755e-01-1.56909014e-01j  1.64531102e-01-1.75843945e-01j
   7.19895684e-01+6.26000053e-02j  1.38998987e-01-2.61053573e-01j
   7.43665968e-02-4.41021547e-02j -5.56652989e-02+3.51962416e-03j]
 [-3.02330944e-16+3.05064647e-16j -2.79502340e-16+3.88735896e-16j
  -5.97288070e-16-1.62557951e-16j  1.84865179e-16+4.26033919e-16j
   2.61426661e-16-6.25681337e-16j  1.44328993e-15+8.71603696e-17j
   7.10731384e-16-4.44207115e-16j  6.91643545e-16-7.63173077e-16j
   6.45674739e-02+2.81212948e-01j  2.01948123e-02-7.74077331e-02j
   2.94125674e-02+1.38072842e-02j -2.57490415e-02+1.15455984e-01j
   1.38998987e-01-2.61053573e-01j  1.22024665e-01+9.54465866e-02j
   1.94402280e-02+3.07461336e-01j -2.14288507e-01-1.28166332e-01j]
 [ 9.86080305e-16+3.93423107e-16j -1.64221826e-16+1.02339774e-15j
  -5.09398242e-16-2.89117163e-16j  9.51791758e-17+1.06099643e-15j
   1.70048150e-16+1.51770368e-16j  7.62869388e-16+5.77851705e-16j
   1.11022302e-15+1.82629847e-16j  1.03007307e-15+8.39733481e-17j
  -2.44841810e-01+1.50815119e-02j  2.80300183e-01-8.37018351e-02j
  -9.25000614e-02-2.20839642e-01j -9.65693095e-03-4.01575037e-02j
   7.43665968e-02-4.41021547e-02j  1.94402280e-02+3.07461336e-01j
  -1.57567893e-01+4.87661957e-01j  2.19779752e-03-2.45104826e-02j]
 [ 9.03408679e-16-1.26136306e-15j -5.11363403e-16-1.70454468e-17j
  -5.28408850e-16-3.74999829e-16j -8.09658722e-16+2.72727148e-16j
   4.60227063e-16-7.67045105e-17j  5.45454297e-16+8.26704168e-16j
   9.71590466e-16+4.47442978e-17j  2.10942375e-15+1.45951638e-16j
  -4.84582161e-01+3.21265864e-01j  1.46325633e-03-2.56613819e-02j
  -3.74170327e-02-1.67904780e-01j  2.33058310e-01+1.64529949e-01j
  -5.56652989e-02+3.51962416e-03j -2.14288507e-01-1.28166332e-01j
   2.19779752e-03-2.45104826e-02j  2.28642927e-01+3.53448098e-01j]], gamma = [-0.49019437-0.01049259j -0.01482362-1.18111509j -0.70457178-0.61804782j
  0.58378471+1.00682641j -0.24289103-0.42275734j -0.86825767+1.52177496j
  0.41201524-1.20605988j -0.8341232 +0.79306341j -0.49019437+0.01049259j
 -0.01482362+1.18111509j -0.70457178+0.61804782j  0.58378471-1.00682641j
 -0.24289103+0.42275734j -0.86825767-1.52177496j  0.41201524+1.20605988j
 -0.8341232 -0.79306341j]
INFO 2022-02-11 19:22:42,008 For k = 1, lhaf_k_approx=(-2.9793875661027953-2.3314683517128287e-15j), prob_k_approx = -9.308801120032201e-10, time = 0.04078364372253418
