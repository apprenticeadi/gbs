INFO 2022-02-11 19:30:01,923 NumExpr defaulting to 8 threads.
INFO 2022-02-11 19:30:06,056 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 4, hbar = 2
INFO 2022-02-11 19:30:06,056 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-11 19:30:06,064 U = [[ 0.07710871+0.21162963j  0.27311514+0.06344089j  0.0801365 -0.09423754j
  -0.23360802+0.34126126j  0.07158522+0.09883681j -0.32271203-0.39770831j
   0.25101402+0.03198496j  0.32266628-0.48883871j]
 [ 0.32788034-0.30682031j  0.23932279-0.15088125j  0.37687963+0.28972029j
  -0.32862099-0.03917891j -0.2744999 +0.10868782j -0.16949767+0.21727285j
   0.3700108 -0.05702261j  0.01491367+0.28165619j]
 [-0.12704007+0.12526426j  0.05834088+0.03415773j  0.36085529+0.47316356j
   0.24651493+0.24854646j -0.19325134-0.37671468j  0.39266907-0.16065757j
   0.04122026-0.29235736j -0.07614709-0.18634334j]
 [-0.09706315-0.26259648j -0.45025059+0.1955157j   0.3779968 +0.11114862j
  -0.25434377-0.24168248j  0.05687579-0.17080884j -0.20788559+0.14577352j
  -0.17395895+0.20681379j -0.05173179-0.47931867j]
 [-0.13446759-0.27447351j  0.37285055-0.10290388j  0.12081865-0.12422378j
   0.39784465+0.09445783j -0.07175215-0.33983902j -0.08259578+0.16232056j
  -0.08634183+0.54244939j  0.32212762+0.02152336j]
 [ 0.17590852+0.02865416j -0.47492932-0.35465557j  0.12562331-0.0285822j
  -0.00704497+0.3860293j   0.14686335-0.05721707j  0.10183017-0.27666554j
   0.22071533+0.45456591j -0.21016518+0.19989904j]
 [-0.13139794-0.1365314j   0.28652845-0.06748636j  0.23589884-0.09749739j
   0.01135504-0.38053888j  0.67130109-0.16424714j  0.06457616-0.25113089j
   0.25583464-0.09826983j -0.20447936+0.07462442j]
 [ 0.4683263 +0.50694829j -0.07080523+0.05664734j  0.2821849 -0.24078259j
   0.05025394-0.10029979j  0.20208134-0.1494401j   0.21071003+0.43077042j
   0.05713519-0.01339182j  0.26034667-0.03010458j]]
INFO 2022-02-11 19:30:06,068 
INFO 2022-02-11 19:30:06,068 Number of coherent states = 2
INFO 2022-02-11 19:30:06,088 mu = [ 1.57600731  2.55241409 -0.3091464  -2.46291183  1.07272332 -1.3455936
  0.69808729  1.78884482  1.23781733 -2.05965701  0.71739896 -0.30186352
 -1.69819826 -1.46700634 -0.91807992  2.53618034]
INFO 2022-02-11 19:30:06,088 cov = [[11.98198094 -5.65240526  3.32587361  1.45392183 -1.02384957  3.32100881
  -1.66474714 -3.93963023  2.24975603  2.13544215  1.95884976  0.39745183
   0.18104939 -1.63835763 -2.90833944  4.36376723]
 [-5.65240526  5.344418    0.27934943 -2.12297684 -1.32881105 -1.32560985
  -1.23586395  0.05809317 -0.88964181 -0.85297977 -2.98136671 -1.81095134
  -2.07393775 -0.15495822 -1.88768683 -4.52180893]
 [ 3.32587361  0.27934943 12.78628418  1.3418494  -2.1248185  -0.53711239
  -0.51097235 -3.14938784  2.81254174 -2.59532295 -5.4023796  -4.09810314
  -3.54766547  0.84317163  4.12885791  0.53451652]
 [ 1.45392183 -2.12297684  1.3418494   9.07177631  3.15697817 -2.73958522
   0.27585541  2.029479    2.06255112 -4.58473182 -2.6344347  -1.15824355
   5.61016062 -3.08034971 -1.57655442  2.22044203]
 [-1.02384957 -1.32881105 -2.1248185   3.15697817 10.48755187  5.71573371
  -1.1784916   2.72770633 -0.71906675 -4.09060502 -2.88017507  4.89689739
   0.14077335 -1.58268219  2.45743808  0.69520791]
 [ 3.32100881 -1.32560985 -0.53711239 -2.73958522  5.71573371 10.96105781
  -2.23716791 -3.31871925 -3.69807962 -2.04095096  0.232973    2.91060095
  -4.34942303 -0.34185699 -0.26349364 -0.40908941]
 [-1.66474714 -1.23586395 -0.51097235  0.27585541 -1.1784916  -2.23716791
   5.91265256 -0.65566414 -3.29962101 -3.06179649  4.53533837 -2.52569822
   2.18651299  2.0324315   4.30202466  2.64301766]
 [-3.93963023  0.05809317 -3.14938784  2.029479    2.72770633 -3.31871925
  -0.65566414  6.64450895  3.55286501  1.8098821  -1.84087598  3.477793
   2.19743912  0.07152143  2.82079111  0.46565061]
 [ 2.24975603 -0.88964181  2.81254174  2.06255112 -0.71906675 -3.69807962
  -3.29962101  3.55286501  7.64259801  5.32566706 -4.03062366  2.06075236
   0.48037632 -0.63715331  0.95729786  1.35554859]
 [ 2.13544215 -0.85297977 -2.59532295 -4.58473182 -4.09060502 -2.04095096
  -3.06179649  1.8098821   5.32566706 11.19643758  1.16355182  3.91468577
  -1.60404889  1.55365271 -0.33424431  0.49817177]
 [ 1.95884976 -2.98136671 -5.4023796  -2.6344347  -2.88017507  0.232973
   4.53533837 -1.84087598 -4.03062366  1.16355182  8.71985645 -0.5290386
   2.10582013  1.7229496   0.22754122  3.11273991]
 [ 0.39745183 -1.81095134 -4.09810314 -1.15824355  4.89689739  2.91060095
  -2.52569822  3.477793    2.06075236  3.91468577 -0.5290386   6.70702384
  -1.07462369  0.31249488  1.61884252  0.7159683 ]
 [ 0.18104939 -2.07393775 -3.54766547  5.61016062  0.14077335 -4.34942303
   2.18651299  2.19743912  0.48037632 -1.60404889  2.10582013 -1.07462369
   6.83591406 -2.23189256 -2.24095432  2.01619196]
 [-1.63835763 -0.15495822  0.84317163 -3.08034971 -1.58268219 -0.34185699
   2.0324315   0.07152143 -0.63715331  1.55365271  1.7229496   0.31249488
  -2.23189256  3.52678234  5.05443809  1.08296182]
 [-2.90833944 -1.88768683  4.12885791 -1.57655442  2.45743808 -0.26349364
   4.30202466  2.82079111  0.95729786 -0.33424431  0.22754122  1.61884252
  -2.24095432  5.05443809 13.8493819   3.79053786]
 [ 4.36376723 -4.52180893  0.53451652  2.22044203  0.69520791 -0.40908941
   2.64301766  0.46565061  1.35554859  0.49817177  3.11273991  0.7159683
   2.01619196  1.08296182  3.79053786  5.7897781 ]]
INFO 2022-02-11 19:30:06,096 A=[[ 1.78995291e-01-1.85600461e-01j -4.52834719e-01-5.13880423e-02j
   3.03448299e-01-1.96815221e-01j -2.50311642e-02-1.01472710e-01j
  -6.20478432e-02+2.21926886e-02j  1.63270307e-01+2.20122805e-01j
  -1.08156785e-01+2.56072282e-01j -2.18420935e-01-3.26553318e-01j
   0.00000000e+00-1.05232812e-30j  9.43689571e-16+4.44089210e-16j
   4.44089210e-16-2.10942375e-15j -4.44089210e-16+5.55111512e-16j
   2.49800181e-16+1.66533454e-16j -1.75952960e-30-3.33066907e-16j
  -8.60422844e-16-4.44089210e-16j  3.33879215e-30-5.82867088e-16j]
 [-4.52834719e-01-5.13880423e-02j -2.41390070e-01+7.03691583e-02j
  -3.64724817e-02+2.30032980e-01j -2.49047663e-01+2.63815660e-01j
   1.13532911e-02+2.54281345e-01j -1.18766757e-01+9.05791006e-02j
  -3.71909259e-02+2.04161334e-01j -1.81528104e-02+1.11864323e-01j
   8.88178420e-16-5.55111512e-16j -1.77635684e-15-2.22044605e-16j
   8.88178420e-16-9.43689571e-16j -4.99600361e-16-3.17701404e-30j
  -2.50987190e-30+5.55111512e-16j  5.48172618e-16+5.55111512e-16j
   1.11022302e-15-9.43689571e-16j -5.27355937e-16+8.88178420e-16j]
 [ 3.03448299e-01-1.96815221e-01j -3.64724817e-02+2.30032980e-01j
   1.67736157e-01+4.45685723e-01j  7.71722958e-02+2.77710585e-01j
  -1.74509696e-01+2.65142120e-01j -9.32253408e-02-4.43899111e-02j
  -3.04629603e-02-3.57389601e-01j -2.58306629e-01+5.38860470e-02j
   1.11022302e-16+2.22044605e-15j  6.66133815e-16+1.11022302e-15j
  -8.88178420e-16+1.11022302e-16j  5.55111512e-17+3.88578059e-16j
  -8.99794470e-31-6.66133815e-16j -1.66533454e-16+3.60822483e-16j
   3.05311332e-16-1.44328993e-15j -6.66133815e-16-6.66133815e-16j]
 [-2.50311642e-02-1.01472710e-01j -2.49047663e-01+2.63815660e-01j
   7.71722958e-02+2.77710585e-01j  9.75437205e-02+9.55528220e-02j
   1.74549428e-01-4.33405841e-01j -1.25895311e-01+7.00196979e-03j
  -5.53969013e-02+1.69213899e-01j  5.41810283e-02-2.35046608e-01j
  -3.33066907e-16-7.21644966e-16j -6.66133815e-16+1.11022302e-16j
  -3.60822483e-16-3.33066907e-16j -8.88178420e-16-1.11022302e-16j
   1.11022302e-16+5.55111512e-17j  6.66133815e-16-8.88178420e-16j
  -2.22044605e-16-6.66133815e-16j -2.22044605e-16-2.22044605e-16j]
 [-6.20478432e-02+2.21926886e-02j  1.13532911e-02+2.54281345e-01j
  -1.74509696e-01+2.65142120e-01j  1.74549428e-01-4.33405841e-01j
   1.50626480e-01-1.16135250e-02j  3.27831791e-01+2.44693524e-01j
   4.38255455e-02-1.91558428e-01j  2.93492700e-02-1.19318854e-01j
   1.94289029e-16-2.22044605e-16j -1.11022302e-16-3.33066907e-16j
  -1.11022302e-16+5.55111512e-16j  4.44089210e-16-5.55111512e-17j
   4.44089210e-16+1.83348531e-31j  1.11022302e-15+2.22044605e-16j
   2.22044605e-16-8.32667268e-16j -1.11022302e-15+3.33066907e-16j]
 [ 1.63270307e-01+2.20122805e-01j -1.18766757e-01+9.05791006e-02j
  -9.32253408e-02-4.43899111e-02j -1.25895311e-01+7.00196979e-03j
   3.27831791e-01+2.44693524e-01j  3.06656574e-01+2.82025309e-02j
  -3.00771598e-01-7.29669523e-02j -1.81565029e-01+1.39243483e-02j
  -4.44089210e-16+6.66133815e-16j  7.07767178e-16-4.99600361e-16j
  -1.11022302e-16-4.44089210e-16j  4.44089210e-16+6.66133815e-16j
   1.33226763e-15-3.33066907e-16j  8.88178420e-16+2.22044605e-16j
  -1.24954335e-30-8.88178420e-16j  4.44089210e-16+6.93889390e-17j]
 [-1.08156785e-01+2.56072282e-01j -3.71909259e-02+2.04161334e-01j
  -3.04629603e-02-3.57389601e-01j -5.53969013e-02+1.69213899e-01j
   4.38255455e-02-1.91558428e-01j -3.00771598e-01-7.29669523e-02j
  -3.27382304e-01-3.54908598e-01j -1.83401473e-01-2.25376754e-01j
  -1.02695630e-15+3.33066907e-16j  1.55431223e-15+6.10622664e-16j
   3.60822483e-16+1.55431223e-15j -3.88578059e-16+7.21644966e-16j
   2.22044605e-16+8.60422844e-16j -1.43289188e-31+9.99200722e-16j
   0.00000000e+00+1.11022302e-16j  5.55111512e-16-3.33066907e-16j]
 [-2.18420935e-01-3.26553318e-01j -1.81528104e-02+1.11864323e-01j
  -2.58306629e-01+5.38860470e-02j  5.41810283e-02-2.35046608e-01j
   2.93492700e-02-1.19318854e-01j -1.81565029e-01+1.39243483e-02j
  -1.83401473e-01-2.25376754e-01j  3.52568095e-02-3.84152624e-02j
   2.60385728e-30+7.21644966e-16j -3.05311332e-16-8.88178420e-16j
  -6.66133815e-16+4.44089210e-16j  1.11022302e-16+2.77555756e-16j
  -1.11022302e-15-2.22044605e-16j  2.22044605e-16-2.63677968e-16j
   6.66133815e-16+3.33066907e-16j -8.88178420e-16-5.55111512e-17j]
 [-8.88178420e-16+1.05355558e-16j  6.62296226e-16-6.36625829e-16j
   3.71987887e-16+2.45197711e-15j -6.15737881e-16-5.65688369e-16j
   2.77040188e-16-8.75241150e-18j -1.20144342e-16+3.96851161e-16j
  -1.04794382e-15+3.61210939e-16j  2.67268952e-16+5.37136061e-16j
   1.78995291e-01+1.85600461e-01j -4.52834719e-01+5.13880423e-02j
   3.03448299e-01+1.96815221e-01j -2.50311642e-02+1.01472710e-01j
  -6.20478432e-02-2.21926886e-02j  1.63270307e-01-2.20122805e-01j
  -1.08156785e-01-2.56072282e-01j -2.18420935e-01+3.26553318e-01j]
 [ 6.22832674e-16+4.75874470e-16j -1.33226763e-15-2.11524487e-17j
   7.72318968e-16+1.20444982e-15j -3.33485384e-16-1.14554111e-17j
   8.55901785e-18-3.90643278e-16j  4.93339530e-16-7.59644515e-16j
   1.37531574e-15+3.68095284e-16j -1.25702411e-16-8.47510272e-16j
  -4.52834719e-01+5.13880423e-02j -2.41390070e-01-7.03691583e-02j
  -3.64724817e-02-2.30032980e-01j -2.49047663e-01-2.63815660e-01j
   1.13532911e-02-2.54281345e-01j -1.18766757e-01-9.05791006e-02j
  -3.71909259e-02-2.04161334e-01j -1.81528104e-02-1.11864323e-01j]
 [ 3.66089776e-16-2.44397765e-15j  7.11588719e-16-1.23467461e-15j
  -1.11022302e-15+2.28797751e-17j  2.85859060e-17-4.47845861e-16j
  -3.38921373e-16+5.65975416e-16j -2.10385171e-16-2.65678654e-16j
   3.66941494e-16+1.53060870e-15j -8.83677645e-16+3.87387962e-16j
   3.03448299e-01+1.96815221e-01j -3.64724817e-02-2.30032980e-01j
   1.67736157e-01-4.45685723e-01j  7.71722958e-02-2.77710585e-01j
  -1.74509696e-01-2.65142120e-01j -9.32253408e-02+4.43899111e-02j
  -3.04629603e-02+3.57389601e-01j -2.58306629e-01-5.38860470e-02j]
 [-4.00814091e-16+4.90651732e-16j -3.90448209e-16-1.03658817e-16j
   4.31911736e-17+4.94107026e-16j -8.88178420e-16-8.63823472e-17j
   1.65854107e-16-1.10569404e-16j  6.08131724e-16+3.38618801e-16j
  -5.56302316e-16+6.77237602e-16j  8.29270533e-17+1.72764694e-16j
  -2.50311642e-02+1.01472710e-01j -2.49047663e-01-2.63815660e-01j
   7.71722958e-02-2.77710585e-01j  9.75437205e-02-9.55528220e-02j
   1.74549428e-01+4.33405841e-01j -1.25895311e-01-7.00196979e-03j
  -5.53969013e-02-1.69213899e-01j  5.41810283e-02+2.35046608e-01j]
 [ 2.42470623e-16+3.99578220e-17j  9.98036609e-17+3.16545165e-16j
   2.18204323e-16-6.04175774e-16j  1.51437233e-16-9.00772317e-17j
   7.77156117e-16+1.57619886e-16j  1.29170124e-15-2.92460658e-16j
   1.16860640e-16+9.66020833e-16j -1.06624241e-15-2.54605228e-16j
  -6.20478432e-02-2.21926886e-02j  1.13532911e-02-2.54281345e-01j
  -1.74509696e-01-2.65142120e-01j  1.74549428e-01+4.33405841e-01j
   1.50626480e-01+1.16135250e-02j  3.27831791e-01-2.44693524e-01j
   4.38255455e-02+1.91558428e-01j  2.93492700e-02+1.19318854e-01j]
 [-6.39373271e-17-4.97072279e-16j  5.84554709e-16+8.50723021e-16j
  -2.78650469e-16+2.25899352e-16j  5.35424424e-16-8.60548112e-16j
   1.15483459e-15+2.12957845e-16j  4.44089210e-16-6.22828780e-17j
  -1.72545061e-16+6.90180244e-16j  3.15995391e-16-3.44770183e-16j
   1.63270307e-01-2.20122805e-01j -1.18766757e-01-9.05791006e-02j
  -9.32253408e-02+4.43899111e-02j -1.25895311e-01-7.00196979e-03j
   3.27831791e-01-2.44693524e-01j  3.06656574e-01-2.82025309e-02j
  -3.00771598e-01+7.29669523e-02j -1.81565029e-01-1.39243483e-02j]
 [-7.19205689e-16-7.60571374e-16j  1.29272847e-15-2.55381417e-16j
   1.06445452e-16-1.70456652e-15j -3.87019986e-16-7.86553053e-16j
   2.83539790e-16-8.73983409e-16j  9.27160185e-17-8.42088150e-16j
   4.44089210e-16+1.41442262e-16j  6.07436923e-16+3.81298720e-16j
  -1.08156785e-01-2.56072282e-01j -3.71909259e-02-2.04161334e-01j
  -3.04629603e-02+3.57389601e-01j -5.53969013e-02-1.69213899e-01j
   4.38255455e-02+1.91558428e-01j -3.00771598e-01+7.29669523e-02j
  -3.27382304e-01+3.54908598e-01j -1.83401473e-01+2.25376754e-01j]
 [ 2.21332465e-16-6.75854492e-16j -1.10666233e-16+5.05902777e-16j
  -6.51152208e-16-5.21712239e-16j  4.68635779e-33-3.16189236e-16j
  -1.01180555e-15+7.90473090e-17j  2.52951389e-16+3.79427083e-16j
   6.63997395e-16-1.35368517e-16j -2.22044605e-16-1.25487603e-16j
  -2.18420935e-01+3.26553318e-01j -1.81528104e-02-1.11864323e-01j
  -2.58306629e-01-5.38860470e-02j  5.41810283e-02+2.35046608e-01j
   2.93492700e-02+1.19318854e-01j -1.81565029e-01-1.39243483e-02j
  -1.83401473e-01+2.25376754e-01j  3.52568095e-02+3.84152624e-02j]], gamma = [ 0.78800365-0.61890867j  1.27620705+1.0298285j  -0.1545732 -0.35869948j
 -1.23145591+0.15093176j  0.53636166+0.84909913j -0.6727968 +0.73350317j
  0.34904365+0.45903996j  0.89442241-1.26809017j  0.78800365+0.61890867j
  1.27620705-1.0298285j  -0.1545732 +0.35869948j -1.23145591-0.15093176j
  0.53636166-0.84909913j -0.6727968 -0.73350317j  0.34904365-0.45903996j
  0.89442241+1.26809017j]
INFO 2022-02-11 19:30:06,137 For k = 1, lhaf_k_approx=(-0.14610283837538182+5.811323644522304e-15j), prob_k_approx = -4.564838361353711e-11, time = 0.04046344757080078
