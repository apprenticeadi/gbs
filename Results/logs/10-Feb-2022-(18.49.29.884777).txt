INFO 2022-02-10 18:49:30,974 NumExpr defaulting to 8 threads.
INFO 2022-02-10 18:49:38,439 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 4, hbar = 2
INFO 2022-02-10 18:49:38,439 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-10 18:49:38,444 U = [[-0.17535063-0.01659848j -0.32662102-0.02169373j  0.46005807+0.3005809j
  -0.22999637-0.058117j    0.05738979-0.39745429j  0.09050403-0.26500815j
  -0.18214269-0.19255888j  0.28166014+0.33804645j]
 [ 0.09353889-0.0066859j   0.29264709-0.44766704j -0.21025638-0.32940129j
  -0.16160233-0.28532335j -0.30118943-0.22448302j -0.28747858-0.28257442j
  -0.16823451-0.16001914j -0.10973586+0.27453438j]
 [-0.13673741+0.07969533j  0.01715113+0.47330936j  0.02561967+0.115324j
   0.12270076-0.47351359j  0.08706528+0.17752728j -0.42665313+0.21973331j
  -0.3807719 -0.05481507j -0.1673241 +0.22805225j]
 [ 0.22256949+0.26240843j  0.18941271+0.09416585j  0.07990327+0.32183182j
   0.01221943+0.2304194j  -0.32055325+0.39388102j  0.2237311 -0.38339251j
  -0.19916521+0.21110814j -0.20021806+0.3072374j ]
 [-0.07868755+0.4526294j   0.15519891-0.15588856j  0.22980114+0.11852037j
   0.14704729+0.0187735j  -0.28003797+0.15005047j -0.11361579+0.33321952j
   0.40392066-0.46513072j  0.17555336+0.12852347j]
 [-0.30507139-0.42644645j  0.16682245-0.09835372j  0.03353943+0.03130378j
   0.43789785-0.27020098j -0.37783709+0.09534489j  0.34372022+0.08221743j
  -0.12952768+0.13155243j  0.32984453+0.03268173j]
 [-0.06251755-0.41730849j  0.08863075+0.40389395j -0.10354941-0.20709947j
  -0.43364911+0.05501395j -0.06876279+0.32897514j  0.11430963-0.1106744j
   0.25318745-0.38392489j  0.0947727 +0.21798196j]
 [-0.07967284+0.38255167j -0.24353049+0.14681871j -0.40197691-0.37041858j
   0.25663847+0.00255174j  0.17814796-0.05619855j  0.22733577-0.07669595j
   0.08131122+0.10915634j  0.26992852+0.46683147j]]
INFO 2022-02-10 18:49:38,444 
INFO 2022-02-10 18:49:38,446 Number of coherent states = 1
INFO 2022-02-10 18:49:38,464 mu = [-0.78907783  0.42092499 -0.61531835  1.00156271 -0.35409396 -1.37282128
 -0.28132899 -0.3585278  -0.07469316 -0.03008655  0.35862899  1.18083794
  2.03683229 -1.91900902 -1.87788821  1.72148249]
INFO 2022-02-10 18:49:38,464 cov = [[10.5696265   4.74746536  0.2602829   1.94268723  0.51515453 -0.97715992
  -0.60355558  1.4423207  -5.36610366 -2.90023902 -2.12928685 -1.32485782
  -4.06764501 -3.84433951  0.67862777  4.05332105]
 [ 4.74746536 13.82228622 -3.23224012 -3.15913191  0.15090525  1.17390791
  -1.10136383  4.43308365 -2.84507725 -2.87986989 -1.43113676  2.88167626
   2.44575993  2.43442314 -1.96057135 -2.73700471]
 [ 0.2602829  -3.23224012 13.27980108  0.36202648  1.94231633  2.67096788
   5.42762962  2.23738137 -2.45811941 -1.29873945  3.15918471 -1.17193671
   0.53294826  0.82660223 -5.61171181  3.15642017]
 [ 1.94268723 -3.15913191  0.36202648 13.59671642 -2.10900975 -0.56160983
   3.02761837  1.60618918 -2.18152477  3.4086718  -2.25734208  5.96421085
  -4.20211361  1.74038938  2.43562768  0.32410669]
 [ 0.51515453  0.15090525  1.94231633 -2.10900975  9.22110163 -0.19055535
   2.76179377 -1.85573817 -5.70074794  3.29216741 -0.59297435 -1.74482042
   5.30316188 -3.08525775  2.540453   -2.08764392]
 [-0.97715992  1.17390791  2.67096788 -0.56160983 -0.19055535  2.91911592
  -1.63254198 -0.32691394 -2.43312035  1.58565433  2.49915888  1.43956497
   0.38925707  3.27204913 -3.10410683 -0.0823008 ]
 [-0.60355558 -1.10136383  5.42762962  3.02761837  2.76179377 -1.63254198
  11.83283932  3.97288814  2.13890945 -2.75920949 -4.35575429  0.8875441
   3.77799394 -1.0666793   1.73751697 -1.38543694]
 [ 1.4423207   4.43308365  2.23738137  1.60618918 -1.85573817 -0.32691394
   3.97288814  9.00017487  2.66863659 -2.02342331  2.22606056  2.47090029
  -1.96699121 -3.13255197 -2.54261488 -4.9010888 ]
 [-5.36610366 -2.84507725 -2.45811941 -2.18152477 -5.70074794 -2.43312035
   2.13890945  2.66863659 11.04536824 -4.41768408 -0.71887127 -1.06447944
  -0.6423808  -0.24901578  0.24142493 -1.59659073]
 [-2.90023902 -2.87986989 -1.29873945  3.4086718   3.29216741  1.58565433
  -2.75920949 -2.02342331 -4.41768408  8.24269278  3.50193964  2.77320992
   0.0593503  -0.65396928  1.16326165 -4.23044695]
 [-2.12928685 -1.43113676  3.15918471 -2.25734208 -0.59297435  2.49915888
  -4.35575429  2.22606056 -0.71887127  3.50193964  8.45614331 -0.16929592
  -2.89033614 -2.82742363 -4.92744431 -3.07507398]
 [-1.32485782  2.88167626 -1.17193671  5.96421085 -1.74482042  1.43956497
   0.8875441   2.47090029 -1.06447944  2.77320992 -0.16929592  6.24960666
   0.05919698  4.20135657 -0.52923197 -3.27931443]
 [-4.06764501  2.44575993  0.53294826 -4.20211361  5.30316188  0.38925707
   3.77799394 -1.96699121 -0.6423808   0.0593503  -2.89033614  0.05919698
   8.74930788  3.61196414  0.96224501 -1.77632962]
 [-3.84433951  2.43442314  0.82660223  1.74038938 -3.08525775  3.27204913
  -1.0666793  -3.13255197 -0.24901578 -0.65396928 -2.82742363  4.20135657
   3.61196414 13.75857501 -2.35597775  3.13728804]
 [ 0.67862777 -1.96057135 -5.61171181  2.43562768  2.540453   -3.10410683
   1.73751697 -2.54261488  0.24142493  1.16326165 -4.92744431 -0.52923197
   0.96224501 -2.35597775  6.80579731 -0.84208327]
 [ 4.05332105 -2.73700471  3.15642017  0.32410669 -2.08764392 -0.0823008
  -1.38543694 -4.9010888  -1.59659073 -4.23044695 -3.07507398 -3.27931443
  -1.77632962  3.13728804 -0.84208327 10.15185023]]
INFO 2022-02-10 18:49:38,474 A=[[-1.96238803e-02+4.42693029e-01j  3.78053428e-01+2.36988663e-01j
   4.03891492e-02+1.89226010e-01j  1.24042677e-01+1.44634844e-01j
   4.77471973e-02+4.02936631e-01j -3.00352319e-02+2.58939064e-01j
  -3.48546173e-02-1.16220648e-01j  1.25352117e-01-2.77274162e-01j
  -1.77635684e-15+1.11022302e-16j -7.77156117e-16-6.66133815e-16j
   7.35522754e-16+2.77555756e-16j  2.77555756e-16+5.55111512e-16j
   9.71445147e-17+5.55111512e-16j  5.55111512e-16-6.66133815e-16j
   8.32667268e-17+9.43689571e-16j  1.33226763e-15-1.11022302e-16j]
 [ 3.78053428e-01+2.36988663e-01j  2.30152759e-01+2.37583619e-01j
  -2.77778312e-01+1.12604717e-01j -2.44703284e-01-2.59470690e-01j
   3.77655161e-03-2.36683877e-01j  7.53981418e-02-1.65824254e-01j
  -9.34135804e-02+1.94686332e-01j  3.57362143e-01+1.96362988e-01j
  -1.05471187e-15+6.10622664e-16j  0.00000000e+00-2.22044605e-16j
  -1.94480406e-30+5.55111512e-17j -2.77555756e-16-1.38777878e-16j
   1.52655666e-16+6.66133815e-16j  3.88578059e-16-3.85185989e-32j
   1.33226763e-15+6.10622664e-16j  9.43689571e-16-6.66133815e-16j]
 [ 4.03891492e-02+1.89226010e-01j -2.77778312e-01+1.12604717e-01j
   1.98971153e-01-2.60626544e-01j  2.19165282e-02+1.41454388e-01j
   1.99342176e-01+2.47601759e-03j  2.26803259e-01-1.37184385e-01j
   4.27136646e-01+4.11148204e-01j  2.19133574e-01-2.22022053e-01j
   7.35522754e-16-3.05311332e-16j  1.11022302e-16-1.38777878e-16j
  -8.88178420e-16+6.84860688e-31j -9.02056208e-17+1.66533454e-16j
   5.55111512e-16+1.11022302e-16j -6.66133815e-16-9.99200722e-16j
   1.55431223e-15+8.32667268e-16j  4.99600361e-16-3.33066907e-16j]
 [ 1.24042677e-01+1.44634844e-01j -2.44703284e-01-2.59470690e-01j
   2.19165282e-02+1.41454388e-01j  3.03061074e-01-4.92035699e-01j
  -8.94364014e-02+2.45305198e-01j -1.96467694e-01-1.31169999e-01j
   1.46716589e-01-1.37077578e-01j  2.01522234e-01-1.15291297e-01j
   4.44089210e-16-4.44089210e-16j -3.33066907e-16+2.77555756e-17j
  -2.01227923e-16-1.11022302e-16j  2.66453526e-15+1.11022302e-16j
  -6.66133815e-16+2.22044605e-16j  8.88178420e-16+8.88178420e-16j
   5.45423360e-31-4.44089210e-16j  1.11022302e-16+8.88178420e-16j]
 [ 4.77471973e-02+4.02936631e-01j  3.77655161e-03-2.36683877e-01j
   1.99342176e-01+2.47601759e-03j -8.94364014e-02+2.45305198e-01j
   1.94610299e-02-4.37500456e-01j -1.56850201e-01+1.11207385e-01j
   7.42296220e-02-2.60629741e-01j -3.27552504e-03+1.67249724e-01j
   2.77555756e-17-3.88578059e-16j  4.16333634e-17-2.22044605e-16j
   2.77555756e-16+2.35040490e-30j -7.77156117e-16-3.33066907e-16j
   1.77635684e-15-3.84415617e-31j -4.44089210e-16-3.33066907e-16j
   7.77156117e-16-4.99600361e-16j  2.22044605e-16-9.43689571e-16j]
 [-3.00352319e-02+2.58939064e-01j  7.53981418e-02-1.65824254e-01j
   2.26803259e-01-1.37184385e-01j -1.96467694e-01-1.31169999e-01j
  -1.56850201e-01+1.11207385e-01j -4.47117059e-01-2.69937637e-01j
   2.98410161e-02+1.72040839e-01j -1.42894935e-01+1.32609525e-01j
   6.66133815e-16+7.77156117e-16j  4.44089210e-16-1.11022302e-16j
  -4.44089210e-16+1.05471187e-15j  8.88178420e-16-1.22124533e-15j
  -4.44089210e-16+5.55111512e-16j -8.88178420e-16-5.55111512e-17j
   6.66133815e-16+8.88178420e-16j -7.77156117e-16-7.77156117e-16j]
 [-3.48546173e-02-1.16220648e-01j -9.34135804e-02+1.94686332e-01j
   4.27136646e-01+4.11148204e-01j  1.46716589e-01-1.37077578e-01j
   7.42296220e-02-2.60629741e-01j  2.98410161e-02+1.72040839e-01j
   2.07360554e-01-1.43341743e-01j  1.98612850e-01+1.62028286e-01j
   1.11022302e-16-1.16573418e-15j  1.55431223e-15-6.38378239e-16j
   1.33226763e-15-8.88178420e-16j  1.11022302e-16+5.55111512e-16j
   4.44089210e-16+5.55111512e-16j  5.55111512e-16-1.11022302e-15j
   1.77635684e-15-1.11022302e-16j  7.77156117e-16+1.66533454e-16j]
 [ 1.25352117e-01-2.77274162e-01j  3.57362143e-01+1.96362988e-01j
   2.19133574e-01-2.22022053e-01j  2.01522234e-01-1.15291297e-01j
  -3.27552504e-03+1.67249724e-01j -1.42894935e-01+1.32609525e-01j
   1.98612850e-01+1.62028286e-01j -4.75054791e-02+4.04330215e-01j
   7.77156117e-16+1.11022302e-16j  1.05471187e-15+9.99200722e-16j
   6.10622664e-16+1.11022302e-16j  1.66533454e-16-7.77156117e-16j
  -2.98133955e-31+9.99200722e-16j -5.55111512e-16+6.66133815e-16j
   7.77156117e-16-2.22044605e-16j  0.00000000e+00-5.55111512e-17j]
 [-1.55431223e-15+2.99600599e-17j -8.55645291e-16+4.22827464e-16j
   7.25503192e-16-2.35474464e-16j  9.69428267e-17-2.74158386e-16j
   1.46964994e-16-4.00942850e-16j  4.46556028e-16+7.09924556e-16j
   9.12030196e-17-9.99094172e-16j  1.12713862e-15+1.24951747e-16j
  -1.96238803e-02-4.42693029e-01j  3.78053428e-01-2.36988663e-01j
   4.03891492e-02-1.89226010e-01j  1.24042677e-01-1.44634844e-01j
   4.77471973e-02-4.02936631e-01j -3.00352319e-02-2.58939064e-01j
  -3.48546173e-02+1.16220648e-01j  1.25352117e-01+2.77274162e-01j]
 [-1.03500930e-15-7.59068811e-16j -4.44089210e-16+3.93181829e-17j
   3.69147707e-17-1.45351910e-16j -4.60587236e-16+1.69137387e-16j
  -1.13714381e-16-6.29107432e-16j  3.52580537e-16-1.77216912e-16j
   1.28315459e-15-5.70585670e-16j  1.09628448e-15+7.54674625e-16j
   3.78053428e-01-2.36988663e-01j  2.30152759e-01-2.37583619e-01j
  -2.77778312e-01-1.12604717e-01j -2.44703284e-01+2.59470690e-01j
   3.77655161e-03+2.36683877e-01j  7.53981418e-02+1.65824254e-01j
  -9.34135804e-02-1.94686332e-01j  3.57362143e-01-1.96362988e-01j]
 [ 6.19130163e-16+9.64391648e-17j  1.20648747e-16-4.73924174e-17j
  -2.22044605e-16+1.05414831e-17j -3.21807085e-16-5.05529675e-16j
   5.05326132e-16-9.64954711e-17j -3.88473614e-16+1.19156093e-15j
   1.57710068e-15-1.31498066e-15j  1.03534428e-15+1.80812852e-16j
   4.03891492e-02-1.89226010e-01j -2.77778312e-01-1.12604717e-01j
   1.98971153e-01+2.60626544e-01j  2.19165282e-02-1.41454388e-01j
   1.99342176e-01-2.47601759e-03j  2.26803259e-01+1.37184385e-01j
   4.27136646e-01-4.11148204e-01j  2.19133574e-01+2.22022053e-01j]
 [ 2.03285312e-16+5.30587449e-16j -2.69768558e-16-2.14152766e-16j
  -4.23191435e-16+2.60818891e-16j  2.55351296e-15-1.22658394e-16j
  -8.59168110e-16-4.09127672e-17j  8.59168110e-16-1.04327556e-15j
   7.92684864e-17+6.85288850e-16j  1.63651069e-16-5.42094165e-16j
   1.24042677e-01-1.44634844e-01j -2.44703284e-01+2.59470690e-01j
   2.19165282e-02-1.41454388e-01j  3.03061074e-01+4.92035699e-01j
  -8.94364014e-02-2.45305198e-01j -1.96467694e-01+1.31169999e-01j
   1.46716589e-01+1.37077578e-01j  2.01522234e-01+1.15291297e-01j]
 [ 3.29035663e-16+3.93282446e-16j  6.09490179e-18+5.29934427e-16j
   3.41287373e-16+1.98050982e-16j -5.16005102e-16+1.41485582e-16j
   1.88737914e-15+3.52914937e-17j -6.01418534e-16+3.70103713e-16j
   6.96910821e-16+3.93111918e-16j  3.59634527e-17+1.01714300e-15j
   4.77471973e-02-4.02936631e-01j  3.77655161e-03+2.36683877e-01j
   1.99342176e-01-2.47601759e-03j -8.94364014e-02-2.45305198e-01j
   1.94610299e-02+4.37500456e-01j -1.56850201e-01-1.11207385e-01j
   7.42296220e-02+2.60629741e-01j -3.27552504e-03-1.67249724e-01j]
 [ 4.44347547e-16-6.67348938e-16j  5.76581071e-16-1.11020566e-16j
  -6.85914982e-16-1.18867369e-15j  6.12610147e-16+9.84909349e-16j
  -6.26036156e-16-5.25292635e-16j -4.44089210e-16-6.58683641e-17j
   5.57002510e-16-1.16970527e-15j -2.20260670e-16+8.98688841e-16j
  -3.00352319e-02-2.58939064e-01j  7.53981418e-02+1.65824254e-01j
   2.26803259e-01+1.37184385e-01j -1.96467694e-01+1.31169999e-01j
  -1.56850201e-01-1.11207385e-01j -4.47117059e-01+2.69937637e-01j
   2.98410161e-02-1.72040839e-01j -1.42894935e-01-1.32609525e-01j]
 [ 9.73009595e-17+9.71647462e-16j  9.86708609e-16+7.00847637e-16j
   1.56019684e-15+1.26926881e-15j  5.06917575e-17-6.49877005e-16j
   7.08833915e-16-6.66024040e-16j  3.75135991e-16+1.09002953e-15j
   6.66133815e-16-1.37372505e-16j  7.73624952e-16-3.31553551e-16j
  -3.48546173e-02+1.16220648e-01j -9.34135804e-02-1.94686332e-01j
   4.27136646e-01-4.11148204e-01j  1.46716589e-01+1.37077578e-01j
   7.42296220e-02+2.60629741e-01j  2.98410161e-02-1.72040839e-01j
   2.07360554e-01+1.43341743e-01j  1.98612850e-01-1.62028286e-01j]
 [ 1.16904799e-15-2.35433275e-16j  1.26951305e-15-5.23636077e-16j
   8.11838879e-16-3.24735552e-17j -8.11838879e-18+8.11838879e-16j
  -6.49471103e-17-1.12033765e-15j -5.19576883e-16-8.93022767e-16j
   5.68287215e-16+3.49090718e-16j  5.55111512e-16+3.24735552e-17j
   1.25352117e-01+2.77274162e-01j  3.57362143e-01-1.96362988e-01j
   2.19133574e-01+2.22022053e-01j  2.01522234e-01+1.15291297e-01j
  -3.27552504e-03-1.67249724e-01j -1.42894935e-01-1.32609525e-01j
   1.98612850e-01-1.62028286e-01j -4.75054791e-02-4.04330215e-01j]], gamma = [-0.39453892+0.03734658j  0.21046249+0.01504327j -0.30765917-0.17931449j
  0.50078136-0.59041897j -0.17704698-1.01841615j -0.68641064+0.95950451j
 -0.1406645 +0.93894411j -0.1792639 -0.86074125j -0.39453892-0.03734658j
  0.21046249-0.01504327j -0.30765917+0.17931449j  0.50078136+0.59041897j
 -0.17704698+1.01841615j -0.68641064-0.95950451j -0.1406645 -0.93894411j
 -0.1792639 +0.86074125j]
INFO 2022-02-10 18:49:38,707 lhaf_exact = (2.9495056146211027-3.723243935382925e-12j)
INFO 2022-02-10 18:49:44,674 lhaf_k for k=N is (2.9495056166342692+7.3685108537099324e-09j)
