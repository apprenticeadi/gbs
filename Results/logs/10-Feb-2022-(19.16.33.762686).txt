INFO 2022-02-10 19:16:34,185 NumExpr defaulting to 8 threads.
INFO 2022-02-10 19:16:38,528 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 7, hbar = 2
INFO 2022-02-10 19:16:38,528 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-10 19:16:38,530 U = [[-0.15710061+0.18197451j -0.01489501+0.0743048j   0.42344288-0.24127005j
   0.37139826+0.03363159j  0.15109331+0.14803529j -0.025575  +0.67832475j
  -0.08031358+0.20982038j  0.04836045+0.0392807j ]
 [-0.10145805+0.32117441j  0.15410418-0.53976003j -0.22692638+0.12524584j
  -0.08610373-0.45282251j  0.01041913-0.04603433j -0.21980624+0.27454748j
  -0.1576539 -0.24046783j -0.2570417 +0.13096302j]
 [-0.48257037-0.36967531j -0.3800396 -0.04259836j -0.1371734 +0.29077163j
   0.1188436 -0.14955606j  0.13794649-0.1344607j   0.10436434+0.135217j
   0.45890509+0.10582136j -0.11259368+0.20883472j]
 [ 0.24244863+0.0123452j   0.08485851+0.26624825j -0.01912726+0.49502779j
  -0.00606009+0.01237128j  0.55203704-0.10713763j  0.08866049+0.20923395j
  -0.04157461-0.18277036j -0.18147176-0.42595852j]
 [-0.15845022-0.00125899j  0.10872216+0.17514357j  0.09706731+0.22615882j
   0.04805424-0.49256289j  0.23320194+0.25545645j  0.02285757-0.34311601j
  -0.39248373+0.44340842j  0.11779813+0.15644732j]
 [-0.13807411+0.30855648j -0.02537384+0.43605714j -0.33960724-0.09300509j
  -0.2008607 +0.19862635j -0.09747981+0.00438748j -0.05714097+0.06568458j
  -0.05715317+0.31355882j -0.59596478+0.13152016j]
 [ 0.475316  +0.05925639j -0.31234526+0.27406378j  0.06101795+0.03625093j
   0.30394716-0.43705811j -0.28972808-0.23775546j -0.36725034-0.00364209j
   0.16473306+0.05719155j -0.06051908-0.00503699j]
 [-0.0345617 -0.1740099j  -0.00585389+0.22100658j -0.3116721 -0.24451998j
  -0.02856893+0.05333747j  0.32473931-0.47392828j -0.24562125+0.11691358j
  -0.32897627-0.13800994j  0.33648287+0.33838175j]]
INFO 2022-02-10 19:16:38,530 
INFO 2022-02-10 19:16:38,530 Number of coherent states = 1
INFO 2022-02-10 19:16:38,540 mu = [-0.70695274 -0.45656123 -2.17156666  1.09101885 -0.71302601 -0.62133349
  2.138922   -0.15552767  0.81888531  1.44528486 -1.66353888  0.05555342
 -0.00566544  1.38850416  0.26665377 -0.78304456]
INFO 2022-02-10 19:16:38,540 cov = [[ 1.32251707e+01  1.14662217e+00  5.37016632e-01 -6.60008827e-01
  -3.38496051e+00  4.01052424e+00 -7.02239916e-01  1.54099824e+00
   2.23108407e+00  2.79234699e+00 -4.11254703e+00 -3.07287154e+00
   9.45333261e-01  3.16554336e-01  6.27805064e+00  2.25948354e+00]
 [ 1.14662217e+00  1.48750343e+01  3.75141428e+00 -8.34260561e-01
  -7.66246134e-01 -8.25032422e+00  1.08096242e+00 -9.94848832e-01
   2.14469412e+00  2.86194024e+00 -5.10445783e-01  1.26014328e+00
  -7.72277369e-01  3.09095854e-01  1.98466695e+00 -3.68011501e-01]
 [ 5.37016632e-01  3.75141428e+00  4.82637181e+00  1.32717448e+00
   2.97140052e+00 -1.86753658e-01  1.99099861e+00  1.12084586e+00
  -1.15926078e+00  3.38624662e+00  4.62085402e-01  2.57888406e+00
   5.82477964e-01  4.07909670e+00  5.90572704e-01  2.89300668e+00]
 [-6.60008827e-01 -8.34260561e-01  1.32717448e+00  1.30872858e+01
  -2.12681705e+00 -6.38452304e-01  2.36835779e+00 -2.34090061e+00
  -4.00524210e+00 -3.41499481e-01  4.27261274e+00 -1.27057583e+00
  -1.74734522e+00 -1.81955404e+00  2.20846931e+00  7.17273035e+00]
 [-3.38496051e+00 -7.66246134e-01  2.97140052e+00 -2.12681705e+00
   1.62077403e+01  2.14048081e+00  5.16854837e+00 -4.69769600e+00
   1.53302178e+00  2.60477852e-01 -5.90959898e-01 -1.71392685e+00
   1.91725317e+00  2.30551517e+00  1.65409336e+00 -3.40644889e-01]
 [ 4.01052424e+00 -8.25032422e+00 -1.86753658e-01 -6.38452304e-01
   2.14048081e+00  8.08931147e+00  9.58597185e-01  2.97797893e+00
  -1.56088190e-01  5.73071293e-01  3.16544594e-02 -2.70688192e-01
   1.31229889e+00  2.65521816e+00  1.25226800e+00  1.20386317e+00]
 [-7.02239916e-01  1.08096242e+00  1.99099861e+00  2.36835779e+00
   5.16854837e+00  9.58597185e-01  7.51439696e+00  2.87760451e+00
   4.33867780e+00 -1.22731779e+00  3.56866642e+00  2.38050969e+00
   1.47614175e+00 -1.88223117e+00  3.01910763e+00  2.07711933e+00]
 [ 1.54099824e+00 -9.94848832e-01  1.12084586e+00 -2.34090061e+00
  -4.69769600e+00  2.97797893e+00  2.87760451e+00  1.07817041e+01
   2.94018299e+00  2.14076805e-01  4.33421549e+00  6.32734637e+00
   2.16612435e-01  1.90610298e+00  4.44284716e-01 -1.10841086e+00]
 [ 2.23108407e+00  2.14469412e+00 -1.15926078e+00 -4.00524210e+00
   1.53302178e+00 -1.56088190e-01  4.33867780e+00  2.94018299e+00
   7.84787897e+00 -2.65239127e+00 -7.09904297e-01  1.38556484e+00
   2.88569680e+00 -5.58625846e+00  1.99555063e+00 -1.00990890e+00]
 [ 2.79234699e+00  2.86194024e+00  3.38624662e+00 -3.41499481e-01
   2.60477852e-01  5.73071293e-01 -1.22731779e+00  2.14076805e-01
  -2.65239127e+00  5.07146382e+00 -2.33906821e+00  1.25194253e+00
   4.49003975e-01  5.96065511e+00 -4.90008562e-01  2.05519674e+00]
 [-4.11254703e+00 -5.10445783e-01  4.62085402e-01  4.27261274e+00
  -5.90959898e-01  3.16544594e-02  3.56866642e+00  4.33421549e+00
  -7.09904297e-01 -2.33906821e+00  9.93615185e+00  1.13361008e+00
  -4.52867026e+00  1.14698521e+00  3.09564319e+00 -2.76064265e+00]
 [-3.07287154e+00  1.26014328e+00  2.57888406e+00 -1.27057583e+00
  -1.71392685e+00 -2.70688192e-01  2.38050969e+00  6.32734637e+00
   1.38556484e+00  1.25194253e+00  1.13361008e+00  7.96271892e+00
   2.90478760e+00  1.23899504e+00 -4.71596380e+00  2.55401135e+00]
 [ 9.45333261e-01 -7.72277369e-01  5.82477964e-01 -1.74734522e+00
   1.91725317e+00  1.31229889e+00  1.47614175e+00  2.16612435e-01
   2.88569680e+00  4.49003975e-01 -4.52867026e+00  2.90478760e+00
   5.52699778e+00 -2.57549084e+00 -3.64245832e+00  4.58240430e+00]
 [ 3.16554336e-01  3.09095854e-01  4.07909670e+00 -1.81955404e+00
   2.30551517e+00  2.65521816e+00 -1.88223117e+00  1.90610298e+00
  -5.58625846e+00  5.96065511e+00  1.14698521e+00  1.23899504e+00
  -2.57549084e+00  1.18404898e+01 -1.94588798e-04 -1.98769526e+00]
 [ 6.27805064e+00  1.98466695e+00  5.90572704e-01  2.20846931e+00
   1.65409336e+00  1.25226800e+00  3.01910763e+00  4.44284716e-01
   1.99555063e+00 -4.90008562e-01  3.09564319e+00 -4.71596380e+00
  -3.64245832e+00 -1.94588798e-04  1.00841179e+01 -2.33632833e+00]
 [ 2.25948354e+00 -3.68011501e-01  2.89300668e+00  7.17273035e+00
  -3.40644889e-01  1.20386317e+00  2.07711933e+00 -1.10841086e+00
  -1.00990890e+00  2.05519674e+00 -2.76064265e+00  2.55401135e+00
   4.58240430e+00 -1.98769526e+00 -2.33632833e+00  1.08241691e+01]]
INFO 2022-02-10 19:16:38,550 A=[[ 2.21808012e-01-1.84060060e-01j  1.56705579e-01-2.03648105e-01j
   5.14342657e-02+2.17456903e-01j -8.43779080e-02+2.91965247e-01j
  -2.58658466e-01-1.02229716e-01j  3.95857877e-01-6.61907116e-03j
  -1.11281215e-01-4.37929638e-01j  1.05222419e-01-2.14481146e-01j
   2.66453526e-15-2.22044605e-16j  1.11022302e-16+1.47141048e-31j
   2.22044605e-16-6.66133815e-16j  4.99600361e-16-2.80415400e-31j
   1.11022302e-15+5.55111512e-17j  5.55111512e-17+7.21644966e-16j
   3.33066907e-16+4.44089210e-16j -1.66533454e-16+6.66133815e-16j]
 [ 1.56705579e-01-2.03648105e-01j  4.04387668e-01-2.36104458e-01j
   2.51226431e-01-1.18623965e-01j -8.60538320e-02-3.78931558e-02j
  -5.01278755e-02+2.11112283e-02j -5.86188964e-01-3.63885299e-02j
   6.48010126e-02-3.12399102e-02j -1.25811389e-01+6.34965530e-03j
   2.77555756e-16+5.55111512e-17j  2.66453526e-15+4.33719423e-31j
  -5.55111512e-16-1.11022302e-16j -2.77555756e-16+5.55111512e-16j
  -6.93889390e-17+2.77555756e-16j -1.11022302e-15-1.94289029e-16j
  -1.11022302e-16+2.22044605e-16j  1.16573418e-15+1.11022302e-16j]
 [ 5.14342657e-02+2.17456903e-01j  2.51226431e-01-1.18623965e-01j
  -2.10773417e-01-3.81211395e-02j  7.98434183e-03-2.82617525e-01j
   3.09370566e-01+3.49871462e-04j -5.50154204e-02-1.69564455e-01j
  -4.55655057e-02-1.71564536e-01j  1.60107595e-01-2.98115828e-01j
   4.09394740e-16+6.66133815e-16j -4.44089210e-16+4.44089210e-16j
   2.66453526e-15-6.30164278e-31j  8.88178420e-16+4.46815747e-31j
  -1.33226763e-15+1.83186799e-15j  2.49800181e-16+4.44089210e-16j
   6.66133815e-16-1.11022302e-16j -1.11022302e-16-2.22044605e-16j]
 [-8.43779080e-02+2.91965247e-01j -8.60538320e-02-3.78931558e-02j
   7.98434183e-03-2.82617525e-01j  2.11383358e-01+1.04820014e-01j
  -2.07548758e-01+1.42774079e-01j -7.74428623e-02+8.62204427e-02j
   2.92221319e-01-1.89290884e-01j -2.01910319e-01-5.56864928e-01j
   5.82867088e-16-2.49800181e-16j -3.74700271e-16-5.55111512e-16j
   1.11022302e-15+1.11022302e-16j  1.77635684e-15-1.66533454e-16j
  -4.44089210e-16+3.88578059e-16j  5.55111512e-17+1.11022302e-16j
  -1.33226763e-15-9.15933995e-16j  2.49800181e-15-8.88178420e-16j]
 [-2.58658466e-01-1.02229716e-01j -5.01278755e-02+2.11112283e-02j
   3.09370566e-01+3.49871462e-04j -2.07548758e-01+1.42774079e-01j
   4.40570155e-01-1.58169627e-01j  1.94529206e-01-1.49231283e-01j
   3.63445387e-01-1.29119129e-01j -3.82795039e-01+5.11621714e-03j
   1.22124533e-15-2.22044605e-16j -2.08166817e-16-2.22044605e-16j
  -1.16573418e-15-2.10942375e-15j -4.44089210e-16-2.22044605e-16j
   2.66453526e-15-5.41956686e-31j  4.85722573e-16-6.66133815e-16j
  -1.05471187e-15-6.10622664e-16j  2.77555756e-16-4.88415834e-31j]
 [ 3.95857877e-01-6.61907116e-03j -5.86188964e-01-3.63885299e-02j
  -5.50154204e-02-1.69564455e-01j -7.74428623e-02+8.62204427e-02j
   1.94529206e-01-1.49231283e-01j -1.54732427e-01-2.19050292e-01j
   3.95492206e-02+2.59853632e-02j  2.04829191e-01-1.28283054e-01j
   3.88578059e-16-4.99600361e-16j -8.88178420e-16+1.94289029e-16j
   3.33066907e-16-4.44089210e-16j  1.38777878e-16-3.50904436e-31j
   4.16333634e-16+5.55111512e-16j  0.00000000e+00+2.77555756e-17j
  -8.32667268e-17+9.99200722e-16j  1.94289029e-16+1.33226763e-15j]
 [-1.11281215e-01-4.37929638e-01j  6.48010126e-02-3.12399102e-02j
  -4.55655057e-02-1.71564536e-01j  2.92221319e-01-1.89290884e-01j
   3.63445387e-01-1.29119129e-01j  3.95492206e-02+2.59853632e-02j
  -1.05998470e-01-2.49070459e-01j  2.15069617e-01-1.04005445e-01j
   3.88578059e-16-2.77555756e-16j -1.11022302e-16-2.22044605e-16j
   8.88178420e-16+4.44089210e-16j -1.44328993e-15+1.01307851e-15j
  -1.22124533e-15+5.89805982e-16j -1.38777878e-16-6.66133815e-16j
   1.77635684e-15+5.55111512e-17j  4.44089210e-16+6.10622664e-16j]
 [ 1.05222419e-01-2.14481146e-01j -1.25811389e-01+6.34965530e-03j
   1.60107595e-01-2.98115828e-01j -2.01910319e-01-5.56864928e-01j
  -3.82795039e-01+5.11621714e-03j  2.04829191e-01-1.28283054e-01j
   2.15069617e-01-1.04005445e-01j -1.75163903e-03+9.14417227e-02j
  -1.66533454e-16-6.10622664e-16j  1.11022302e-15-1.94289029e-16j
   1.11022302e-16+2.77555756e-16j  2.44249065e-15+8.88178420e-16j
   4.44089210e-16+1.66533454e-16j  1.94289029e-16-1.41553436e-15j
   4.44089210e-16-3.88578059e-16j  1.77635684e-15-5.55111512e-17j]
 [ 2.33146835e-15-3.15443925e-17j  7.50636757e-16+3.36824186e-16j
   3.25548187e-16+9.49417218e-16j  6.19852073e-16+2.12868756e-16j
   9.71333909e-16+2.36281673e-16j  2.30138195e-16-3.91660972e-16j
   3.70654952e-16-2.83204217e-16j -1.78856781e-16-4.84519024e-16j
   2.21808012e-01+1.84060060e-01j  1.56705579e-01+2.03648105e-01j
   5.14342657e-02-2.17456903e-01j -8.43779080e-02-2.91965247e-01j
  -2.58658466e-01+1.02229716e-01j  3.95857877e-01+6.61907116e-03j
  -1.11281215e-01+4.37929638e-01j  1.05222419e-01+2.14481146e-01j]
 [ 4.06137631e-16-2.57286131e-16j  2.55351296e-15+1.05496520e-16j
  -4.37374980e-16+2.84802313e-16j -3.23298188e-16-5.59963888e-16j
  -2.70283397e-16-1.25424746e-16j -6.86449383e-16-3.38022805e-17j
   4.13540385e-17-3.27464164e-17j  1.11616046e-15+6.97021140e-17j
   1.56705579e-01+2.03648105e-01j  4.04387668e-01+2.36104458e-01j
   2.51226431e-01+1.18623965e-01j -8.60538320e-02+3.78931558e-02j
  -5.01278755e-02-2.11112283e-02j -5.86188964e-01+3.63885299e-02j
   6.48010126e-02+3.12399102e-02j -1.25811389e-01-6.34965530e-03j]
 [ 1.99638385e-16-9.78582177e-16j -5.46540529e-16-8.61722182e-17j
   2.22044605e-15-4.84510110e-18j  9.44599823e-16+5.43860504e-16j
  -1.03745195e-15-1.62986831e-15j  1.39983322e-16-2.89794125e-16j
   8.71147359e-16+1.53633780e-16j -9.16141930e-17+2.76864981e-16j
   5.14342657e-02-2.17456903e-01j  2.51226431e-01+1.18623965e-01j
  -2.10773417e-01+3.81211395e-02j  7.98434183e-03+2.82617525e-01j
   3.09370566e-01-3.49871462e-04j -5.50154204e-02+1.69564455e-01j
  -4.55655057e-02+1.71564536e-01j  1.60107595e-01+2.98115828e-01j]
 [ 5.50890870e-16-1.18227721e-16j -3.81095739e-16+6.89242458e-16j
   9.00543066e-16-5.93654088e-16j  1.33226763e-15-8.61553073e-17j
  -5.23220552e-16+1.96207707e-16j -1.30805138e-16-6.64087624e-16j
  -1.40363975e-15+7.54645027e-16j  2.67647436e-15+1.14706044e-15j
  -8.43779080e-02-2.91965247e-01j -8.60538320e-02+3.78931558e-02j
   7.98434183e-03+2.82617525e-01j  2.11383358e-01-1.04820014e-01j
  -2.07548758e-01-1.42774079e-01j -7.74428623e-02-8.62204427e-02j
   2.92221319e-01+1.89290884e-01j -2.01910319e-01+5.56864928e-01j]
 [ 1.22279892e-15-9.80071359e-17j -4.82347438e-17+1.49877544e-16j
  -9.43973975e-16+1.85563290e-15j -5.73205156e-16+1.17121458e-16j
   2.33146835e-15-1.07839049e-16j  6.11879386e-16+6.50121848e-16j
  -9.58311098e-16+5.45688096e-16j  5.98699696e-16+1.77757329e-16j
  -2.58658466e-01+1.02229716e-01j -5.01278755e-02-2.11112283e-02j
   3.09370566e-01-3.49871462e-04j -2.07548758e-01-1.42774079e-01j
   4.40570155e-01+1.58169627e-01j  1.94529206e-01+1.49231283e-01j
   3.63445387e-01+1.29119129e-01j -3.82795039e-01-5.11621714e-03j]
 [ 2.63085587e-16+6.18660470e-16j -8.71251301e-16+6.43550064e-17j
  -7.65796715e-18+4.32671261e-16j -1.27274032e-16+5.44212757e-16j
   7.77893449e-16-6.44303751e-16j  9.99200722e-16-7.68212829e-18j
  -4.11904580e-16-8.23809159e-16j  3.03082353e-16-1.35245527e-15j
   3.95857877e-01+6.61907116e-03j -5.86188964e-01+3.63885299e-02j
  -5.50154204e-02+1.69564455e-01j -7.74428623e-02-8.62204427e-02j
   1.94529206e-01+1.49231283e-01j -1.54732427e-01+2.19050292e-01j
   3.95492206e-02-2.59853632e-02j  2.04829191e-01+1.28283054e-01j]
 [ 4.19062988e-16+3.39522804e-16j  1.49140722e-16+1.69392232e-16j
   8.57126764e-16-8.00544931e-17j -1.35989224e-15-4.85227520e-16j
  -8.63618805e-16-5.07229658e-16j -2.06558509e-16+1.20711132e-15j
   1.11022302e-15-1.06986674e-16j  7.33311133e-17-5.13317793e-16j
  -1.11281215e-01+4.37929638e-01j  6.48010126e-02+3.12399102e-02j
  -4.55655057e-02+1.71564536e-01j  2.92221319e-01+1.89290884e-01j
   3.63445387e-01+1.29119129e-01j  3.95492206e-02-2.59853632e-02j
  -1.05998470e-01+2.49070459e-01j  2.15069617e-01+1.04005445e-01j]
 [-3.71630142e-17+7.48569285e-16j  1.30601450e-15+1.32725051e-16j
  -1.38034053e-16-2.01742077e-16j  2.57752048e-15-8.97221342e-16j
   2.36250590e-16-1.24761548e-16j  3.92866150e-16+1.52368358e-15j
   3.13231119e-16+2.12360081e-16j  3.66373598e-15+9.68892869e-17j
   1.05222419e-01+2.14481146e-01j -1.25811389e-01-6.34965530e-03j
   1.60107595e-01+2.98115828e-01j -2.01910319e-01+5.56864928e-01j
  -3.82795039e-01-5.11621714e-03j  2.04829191e-01+1.28283054e-01j
   2.15069617e-01+1.04005445e-01j -1.75163903e-03-9.14417227e-02j]], gamma = [-0.35347637-0.40944266j -0.22828061-0.72264243j -1.08578333+0.83176944j
  0.54550943-0.02777671j -0.35651301+0.00283272j -0.31066674-0.69425208j
  1.069461  -0.13332689j -0.07776384+0.39152228j -0.35347637+0.40944266j
 -0.22828061+0.72264243j -1.08578333-0.83176944j  0.54550943+0.02777671j
 -0.35651301-0.00283272j -0.31066674+0.69425208j  1.069461  +0.13332689j
 -0.07776384-0.39152228j]
INFO 2022-02-10 19:16:38,791 lhaf_exact = (3.193130358897042+5.128342195348523e-12j), prob_exact = 6.402300065064345e-08, exact_time = 0.24160075187683105
INFO 2022-02-10 19:16:44,437 lhaf_k for k=N is (3.1931303832971025-1.5239991123259076e-08j), prob_k = 6.402300113987029e-08
INFO 2022-02-10 19:16:44,437 For k = 0, lhaf_k_approx=(1.3624673059818596e-06-4.235164736271502e-21j), prob_k_approx = 2.7317783933972363e-14, time = 0.0
INFO 2022-02-10 19:16:44,479 For k = 1, lhaf_k_approx=(4.5840878965731576e-06+1.4823076576950256e-19j), prob_k_approx = 9.19120203054551e-14, time = 0.04029703140258789
INFO 2022-02-10 19:16:48,024 For k = 2, lhaf_k_approx=(0.0003108618826825593+2.2160499482540633e-19j), prob_k_approx = 6.232852492787146e-12, time = 3.5446653366088867
INFO 2022-02-10 19:19:12,078 For k = 3, lhaf_k_approx=(-0.0009401654619806556+1.151160921059345e-16j), prob_k_approx = -1.8850534497091862e-11, time = 144.04412817955017
INFO 2022-02-10 20:09:36,289 For k = 4, lhaf_k_approx=(0.010951596415583555-3.715161892589667e-15j), prob_k_approx = 2.1958203569323745e-10, time = 3024.2087750434875
INFO 2022-02-11 06:55:27,295 For k = 5, lhaf_k_approx=(0.02724791771280955-1.5696739901253053e-13j), prob_k_approx = 5.463270387928856e-10, time = 38750.995958566666
