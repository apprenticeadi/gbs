INFO 2022-02-11 19:22:48,883 NumExpr defaulting to 8 threads.
INFO 2022-02-11 19:22:53,042 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 4, hbar = 2
INFO 2022-02-11 19:22:53,042 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-11 19:22:53,042 U = [[-0.24221131-0.34388631j -0.27543665-0.49050361j -0.1734907 +0.10548917j
   0.30814261-0.24212568j  0.08147284+0.04386828j -0.10939485+0.19578014j
  -0.00158442+0.27562634j -0.39404874+0.14733262j]
 [-0.02206283+0.24267187j  0.32023181-0.25467378j -0.26852642+0.13983462j
   0.15953485-0.17328318j  0.38220387+0.30685726j  0.32968296+0.20616555j
  -0.11087081+0.03450049j  0.46245264+0.0854197j ]
 [ 0.2404681 -0.29606854j  0.00385598-0.1005058j  -0.49118236-0.26649072j
  -0.30624221+0.02341993j  0.13277913-0.22029274j  0.02323403+0.24189749j
   0.46447423-0.30006987j  0.0526606 +0.06346056j]
 [-0.28997194-0.32611438j  0.01289852-0.05887406j  0.0072089 -0.195642j
  -0.04700954+0.43916693j  0.06705573-0.15744711j  0.05502406-0.272737j
   0.05195136+0.48383344j  0.42844764+0.21323135j]
 [-0.08528823-0.17715763j -0.02947181-0.38163239j  0.31652953-0.11909195j
  -0.21838364-0.30523668j -0.33466211+0.03214342j -0.33044349+0.16184951j
  -0.16076576-0.21958427j  0.48481669-0.0454351j ]
 [-0.02644273+0.13863689j -0.12850296-0.22864435j  0.04992097+0.24094139j
  -0.26050436+0.35341552j  0.36522461+0.4145921j  -0.46042176-0.22307992j
   0.13513772-0.2127265j  -0.06188823+0.15364259j]
 [ 0.42015253+0.32234503j -0.13499977-0.16611975j -0.23137457+0.31284695j
  -0.09743305+0.23549595j -0.44320046-0.09984601j -0.12654451+0.23687576j
  -0.01626299+0.37662416j  0.10084386+0.16305409j]
 [ 0.1488193 -0.25811569j -0.16953831+0.46099658j -0.41249393+0.14152857j
   0.00493202-0.32083145j  0.12721295+0.12192113j -0.40004381-0.18094412j
  -0.25168392+0.15792507j  0.23519624-0.09697001j]]
INFO 2022-02-11 19:22:53,042 
INFO 2022-02-11 19:22:53,042 Number of coherent states = 2
INFO 2022-02-11 19:22:53,058 mu = [-2.32941584  1.34176042  1.09945836 -1.24683038 -0.51642019 -0.6972556
  1.28318746 -0.09323555 -3.75475461 -0.05400858 -1.78458452 -1.73244799
 -2.51455507 -0.40503354  0.70301378  0.91296399]
INFO 2022-02-11 19:22:53,058 cov = [[ 5.11700654  2.89852523 -1.45073653 -0.30013457  0.86747199 -2.59314548
   3.14036579  1.91210461  3.74930857 -0.99686407 -3.55681139 -2.28667109
  -0.65386392 -0.53593297  0.81166827  3.27883444]
 [ 2.89852523  4.57552187 -1.46544592 -3.88573337  1.55124229  1.3663194
   1.12959435  1.38268647  2.25935159 -3.44997727 -1.19666609 -1.70117497
   1.07038661 -1.61867982  3.56726198  2.07702575]
 [-1.45073653 -1.46544592  6.23425223 -2.19549591  2.71796275 -2.85145418
  -2.22167057 -3.69043103  0.1674794  -2.87735886  0.79616438 -0.31350608
   0.30023389  5.67598912 -2.87076807 -1.70865888]
 [-0.30013457 -3.88573337 -2.19549591 13.74100422 -6.01175249  0.71694784
   4.45021884 -1.82090148 -2.24994912 -0.44621816 -3.61721065 -1.52575998
  -0.21816587  0.03002785 -2.63538696 -2.10847145]
 [ 0.86747199  1.55124229  2.71796275 -6.01175249  4.31711656 -2.58424036
  -3.66014376  0.43178997  1.45625928 -1.0573729  -1.163043    0.12392877
   0.48742556  0.29986623 -0.47724978 -0.72728861]
 [-2.59314548  1.3663194  -2.85145418  0.71694784 -2.58424036 10.61839067
   0.29097514 -0.93450925 -1.40085256 -3.69535542  5.91307413 -1.17116807
  -0.89064396 -3.00915693  4.95023645 -3.07560338]
 [ 3.14036579  1.12959435 -2.22167057  4.45021884 -3.66014376  0.29097514
   8.94846148 -1.01573536  1.74176706 -0.41349922  0.92881953 -1.95813537
  -0.47084177  3.40584977  1.56699608  6.22827306]
 [ 1.91210461  1.38268647 -3.69043103 -1.82090148  0.43178997 -0.93450925
  -1.01573536  4.89961338  1.32661874  3.57560113 -2.38214085  0.3073927
  -1.33273672 -5.33897248  1.23195202  0.76694866]
 [ 3.74930857  2.25935159  0.1674794  -2.24994912  1.45625928 -1.40085256
   1.74176706  1.32661874  7.13843661 -2.06060996 -0.40769644 -3.90445745
  -6.472547    0.44182665 -1.23854562  0.65281887]
 [-0.99686407 -3.44997727 -2.87735886 -0.44621816 -1.0573729  -3.69535542
  -0.41349922  3.57560113 -2.06060996 13.07669913  2.48411251  4.97110212
  -2.49546647 -2.40489989 -2.50671439  3.42737618]
 [-3.55681139 -1.19666609  0.79616438 -3.61721065 -1.163043    5.91307413
   0.92881953 -2.38214085 -0.40769644  2.48411251 12.85898245  1.53172532
  -4.13870408  3.35591134  1.78092983  2.37018926]
 [-2.28667109 -1.70117497 -0.31350608 -1.52575998  0.12392877 -1.17116807
  -1.95813537  0.3073927  -3.90445745  4.97110212  1.53172532  4.57350112
   3.89447737 -0.19589077 -0.01872344  1.58417408]
 [-0.65386392  1.07038661  0.30023389 -0.21816587  0.48742556 -0.89064396
  -0.47084177 -1.33273672 -6.472547   -2.49546647 -4.13870408  3.89447737
  14.17747182  1.19273702  4.17764762  2.35971973]
 [-0.53593297 -1.61867982  5.67598912  0.03002785  0.29986623 -3.00915693
   3.40584977 -5.33897248  0.44182665 -2.40489989  3.35591134 -0.19589077
   1.19273702  9.82884002 -2.09076297  3.43123302]
 [ 0.81166827  3.56726198 -2.87076807 -2.63538696 -0.47724978  4.95023645
   1.56699608  1.23195202 -1.23854562 -2.50671439  1.78092983 -0.01872344
   4.17764762 -2.09076297  6.69015521  2.5211771 ]
 [ 3.27883444  2.07702575 -1.70865888 -2.10847145 -0.72728861 -3.07560338
   6.22827306  0.76694866  0.65281887  3.42737618  2.37018926  1.58417408
   2.35971973  3.43123302  2.5211771  10.6625496 ]]
INFO 2022-02-11 19:22:53,077 A=[[-8.33820085e-02-3.09310604e-01j  2.04559464e-01-5.20763723e-02j
  -4.30243811e-02+1.39806621e-01j  1.48674785e-01+1.87131135e-01j
   3.02768587e-01-3.30980219e-02j -1.25189625e-01+7.98905043e-02j
   1.80625802e-01-1.05326704e-01j  5.19443021e-02-1.89970428e-01j
  -4.44089210e-16+5.55111512e-17j -6.66133815e-16-2.22044605e-16j
  -3.88578059e-16-3.33066907e-16j -2.22044605e-16-2.20309881e-16j
   2.22044605e-16+1.22124533e-15j  3.33066907e-16-1.38777878e-16j
   1.11022302e-16-5.55111512e-16j -5.55111512e-16-2.22044605e-16j]
 [ 2.04559464e-01-5.20763723e-02j -3.50665227e-01+2.84616359e-01j
  -1.62915413e-01+1.68049535e-01j -3.65335780e-01+8.85778611e-02j
   1.66922769e-01-5.36803014e-04j  1.55559098e-01+2.19198743e-01j
   1.49994170e-01-1.30089621e-01j -8.43414459e-02-2.33165316e-01j
  -3.88578059e-16+4.44089210e-16j  0.00000000e+00+1.11022302e-16j
   4.44089210e-16-4.44089210e-16j  4.56830583e-31+6.66133815e-16j
   3.60822483e-16+1.22124533e-15j -6.66133815e-16-4.44089210e-16j
  -1.31733608e-30-4.44089210e-16j  4.44089210e-16+1.11022302e-16j]
 [-4.30243811e-02+1.39806621e-01j -1.62915413e-01+1.68049535e-01j
  -2.73263626e-01-6.56820005e-02j -1.53744221e-01+1.62138211e-01j
   2.82830784e-01+3.55900299e-02j -2.56047741e-01-4.78037496e-01j
  -1.65103342e-01+8.01034729e-02j -2.49994644e-01+1.68741478e-01j
  -5.55111512e-16+1.11022302e-16j  2.77555756e-16+3.33066907e-16j
   0.00000000e+00+1.11022302e-16j  4.99600361e-16-1.44328993e-15j
  -4.99600361e-16+1.66533454e-16j -2.77555756e-16+7.21644966e-16j
   2.22044605e-16+1.11022302e-16j -1.55431223e-15-3.88578059e-16j]
 [ 1.48674785e-01+1.87131135e-01j -3.65335780e-01+8.85778611e-02j
  -1.53744221e-01+1.62138211e-01j  3.78150514e-01+1.25872206e-01j
  -4.08622269e-01+3.88718826e-03j  3.76536977e-02+4.70709152e-02j
   1.84339488e-01+1.89478292e-01j -1.40456028e-01+7.42927324e-02j
   2.60568692e-30+2.55004351e-16j  1.66533454e-16-7.77156117e-16j
   5.55111512e-16+1.22124533e-15j -8.88178420e-16+4.35645353e-31j
   3.33066907e-16-1.11022302e-15j -7.77156117e-16-5.55111512e-17j
  -8.88178420e-16+1.11022302e-16j  8.88178420e-16-3.33066907e-16j]
 [ 3.02768587e-01-3.30980219e-02j  1.66922769e-01-5.36803014e-04j
   2.82830784e-01+3.55900299e-02j -4.08622269e-01+3.88718826e-03j
  -4.06729986e-01-4.02116525e-02j -1.55796614e-01+2.43690021e-02j
  -3.23301209e-01+3.91078471e-02j -7.95252125e-02+8.49740252e-02j
   2.22044605e-16-1.22124533e-15j  6.10622664e-16-1.11022302e-15j
  -1.66533454e-16-2.22044605e-16j  4.44089210e-16+9.99200722e-16j
  -8.88178420e-16+5.55111512e-17j -1.11022302e-16-2.77555756e-16j
   9.43689571e-16-4.71844785e-16j  1.11022302e-16-1.66533454e-16j]
 [-1.25189625e-01+7.98905043e-02j  1.55559098e-01+2.19198743e-01j
  -2.56047741e-01-4.78037496e-01j  3.76536977e-02+4.70709152e-02j
  -1.55796614e-01+2.43690021e-02j  3.25681900e-02+2.48249546e-01j
   9.82443617e-02-3.44680364e-01j -1.80082588e-01+3.47093004e-01j
   4.44089210e-16+1.66533454e-16j -2.22044605e-16+4.44089210e-16j
  -3.05311332e-16-5.55111512e-16j -8.32667268e-16+5.55111512e-17j
  -2.77555756e-16+1.66533454e-16j  0.00000000e+00-2.22044605e-16j
  -7.77156117e-16-5.55111512e-16j  2.22044605e-16-4.44089210e-16j]
 [ 1.80625802e-01-1.05326704e-01j  1.49994170e-01-1.30089621e-01j
  -1.65103342e-01+8.01034729e-02j  1.84339488e-01+1.89478292e-01j
  -3.23301209e-01+3.91078471e-02j  9.82443617e-02-3.44680364e-01j
   9.31529191e-02-1.29274104e-01j -1.45894171e-01-3.07726970e-01j
   2.77555756e-16+4.71844785e-16j  1.11022302e-16+6.66133815e-16j
   2.22044605e-16-1.11022302e-16j -8.88178420e-16+1.11022302e-16j
   1.05471187e-15+3.05311332e-16j -4.44089210e-16+6.66133815e-16j
   0.00000000e+00+8.28920248e-31j -3.33066907e-16-4.44089210e-16j]
 [ 5.19443021e-02-1.89970428e-01j -8.43414459e-02-2.33165316e-01j
  -2.49994644e-01+1.68741478e-01j -1.40456028e-01+7.42927324e-02j
  -7.95252125e-02+8.49740252e-02j -1.80082588e-01+3.47093004e-01j
  -1.45894171e-01-3.07726970e-01j -2.37715468e-01-6.32717602e-02j
  -5.55111512e-16-5.55111512e-17j  4.44089210e-16-1.11022302e-16j
  -8.88178420e-16+3.33066907e-16j  7.21644966e-16+3.33066907e-16j
   1.11022302e-16+3.60822483e-16j  3.33066907e-16+4.44089210e-16j
  -3.33066907e-16+4.44089210e-16j -8.88178420e-16+9.71445147e-17j]
 [-2.22044605e-16+2.79910025e-17j -3.58250940e-16+2.80370301e-16j
  -4.41579490e-16+2.30092734e-16j -1.40657027e-17+2.97876805e-16j
   3.63402584e-16-1.24922439e-15j  3.16736690e-16-1.42911631e-17j
   1.68284086e-16+4.39175340e-16j -3.36488239e-16-1.81686052e-16j
  -8.33820085e-02+3.09310604e-01j  2.04559464e-01+5.20763723e-02j
  -4.30243811e-02-1.39806621e-01j  1.48674785e-01-1.87131135e-01j
   3.02768587e-01+3.30980219e-02j -1.25189625e-01-7.98905043e-02j
   1.80625802e-01+1.05326704e-01j  5.19443021e-02+1.89970428e-01j]
 [-4.00100668e-16-2.51735095e-16j  4.44089210e-16-1.93207108e-17j
   2.41363228e-16+4.47405008e-16j  1.79832993e-16-5.95440432e-16j
   3.63138310e-16-1.03855062e-15j -3.95964512e-16+7.24374083e-16j
   3.60632588e-18+4.98563234e-16j  5.59220697e-16-2.03569290e-16j
   2.04559464e-01+5.20763723e-02j -3.50665227e-01-2.84616359e-01j
  -1.62915413e-01-1.68049535e-01j -3.65335780e-01-8.85778611e-02j
   1.66922769e-01+5.36803014e-04j  1.55559098e-01-2.19198743e-01j
   1.49994170e-01+1.30089621e-01j -8.43414459e-02+2.33165316e-01j]
 [-2.32411524e-16-4.78250471e-16j  2.38015322e-16-5.71967101e-16j
  -4.44089210e-16+7.33505430e-18j  7.70850948e-16+1.31498103e-15j
  -5.59634843e-16-7.79098395e-17j -2.92935659e-16-4.03668395e-16j
   2.76675428e-16-1.46168136e-16j -1.08175926e-15+4.63735115e-16j
  -4.30243811e-02-1.39806621e-01j -1.62915413e-01-1.68049535e-01j
  -2.73263626e-01+6.56820005e-02j -1.53744221e-01-1.62138211e-01j
   2.82830784e-01-3.55900299e-02j -2.56047741e-01+4.78037496e-01j
  -1.65103342e-01-8.01034729e-02j -2.49994644e-01-1.68741478e-01j]
 [-1.24472702e-16-3.00290393e-16j  1.33808154e-16+4.68717517e-16j
   7.17273943e-16-1.40031789e-15j -6.66133815e-16+1.74456271e-16j
   3.74974014e-16+9.98504454e-16j -7.71730750e-16+3.23629024e-16j
  -6.53481684e-16+9.95781613e-17j  8.83756182e-16+2.05379958e-16j
   1.48674785e-01-1.87131135e-01j -3.65335780e-01-8.85778611e-02j
  -1.53744221e-01-1.62138211e-01j  3.78150514e-01-1.25872206e-01j
  -4.08622269e-01-3.88718826e-03j  3.76536977e-02-4.70709152e-02j
   1.84339488e-01-1.89478292e-01j -1.40456028e-01-7.42927324e-02j]
 [ 1.87837062e-16+1.23111749e-15j  3.37720184e-16+1.00151760e-15j
  -2.42024806e-16+1.02489510e-16j  4.32570046e-16-1.17406076e-15j
  -6.66133815e-16-2.57358225e-17j -2.04763025e-16-1.17007443e-16j
   9.37845612e-16+5.01384352e-16j  3.73179183e-16+3.32742928e-16j
   3.02768587e-01+3.30980219e-02j  1.66922769e-01+5.36803014e-04j
   2.82830784e-01-3.55900299e-02j -4.08622269e-01-3.88718826e-03j
  -4.06729986e-01+4.02116525e-02j -1.55796614e-01-2.43690021e-02j
  -3.23301209e-01-3.91078471e-02j -7.95252125e-02-8.49740252e-02j]
 [ 4.03665282e-16-2.22282195e-16j -3.62809689e-16-5.84292454e-16j
  -9.52589363e-17+7.72116269e-16j -8.10965699e-16-6.83730200e-17j
  -3.45471462e-16-1.56154020e-16j  1.11022302e-16+2.75081552e-16j
  -5.64761588e-16+5.32793951e-16j  4.78874483e-16+8.67628356e-17j
  -1.25189625e-01-7.98905043e-02j  1.55559098e-01-2.19198743e-01j
  -2.56047741e-01+4.78037496e-01j  3.76536977e-02-4.70709152e-02j
  -1.55796614e-01-2.43690021e-02j  3.25681900e-02-2.48249546e-01j
   9.82443617e-02+3.44680364e-01j -1.80082588e-01-3.47093004e-01j]
 [ 1.35822707e-16-7.08635349e-16j  4.85964803e-17-6.07301879e-16j
   3.96580089e-16+7.80547719e-17j -6.60939944e-16-1.02348251e-16j
   8.92596573e-16-4.20326472e-16j -5.18903683e-16-4.56837184e-16j
  -6.66133815e-16-4.72326999e-17j -1.47553417e-16+2.95106834e-16j
   1.80625802e-01+1.05326704e-01j  1.49994170e-01+1.30089621e-01j
  -1.65103342e-01-8.01034729e-02j  1.84339488e-01-1.89478292e-01j
  -3.23301209e-01-3.91078471e-02j  9.82443617e-02+3.44680364e-01j
   9.31529191e-02+1.29274104e-01j -1.45894171e-01+3.07726970e-01j]
 [-2.32339354e-16+1.34512257e-16j  5.86962578e-16-2.44567741e-17j
  -1.00272774e-15-3.48509031e-16j  8.62101286e-16-3.05709676e-16j
   1.71197419e-16-2.44567741e-16j  3.66851611e-16-4.15765159e-16j
  -3.79079998e-16-3.66851611e-16j -1.11022302e-15+4.27993546e-17j
   5.19443021e-02+1.89970428e-01j -8.43414459e-02+2.33165316e-01j
  -2.49994644e-01-1.68741478e-01j -1.40456028e-01-7.42927324e-02j
  -7.95252125e-02-8.49740252e-02j -1.80082588e-01-3.47093004e-01j
  -1.45894171e-01+3.07726970e-01j -2.37715468e-01+6.32717602e-02j]], gamma = [-1.16470792+1.8773773j   0.67088021+0.02700429j  0.54972918+0.89229226j
 -0.62341519+0.866224j   -0.25821009+1.25727754j -0.3486278 +0.20251677j
  0.64159373-0.35150689j -0.04661777-0.45648199j -1.16470792-1.8773773j
  0.67088021-0.02700429j  0.54972918-0.89229226j -0.62341519-0.866224j
 -0.25821009-1.25727754j -0.3486278 -0.20251677j  0.64159373+0.35150689j
 -0.04661777+0.45648199j]
INFO 2022-02-11 19:22:53,109 For k = 1, lhaf_k_approx=(0.016499111775563055+2.1412992906588713e-18j), prob_k_approx = 5.154983927680053e-12, time = 0.031248092651367188
