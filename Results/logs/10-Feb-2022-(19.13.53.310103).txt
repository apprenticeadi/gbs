INFO 2022-02-10 19:13:53,664 NumExpr defaulting to 8 threads.
INFO 2022-02-10 19:13:57,854 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 7, hbar = 2
INFO 2022-02-10 19:13:57,854 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-10 19:13:57,856 U = [[-0.14005394-0.1419493j  -0.32376937-0.18256601j  0.10728463+0.1595176j
   0.24781517-0.60572685j -0.11272276+0.21161251j -0.2305022 +0.21777762j
  -0.03564979-0.44173335j  0.04460616+0.01927447j]
 [ 0.08338815+0.20405424j  0.18017751+0.10204589j  0.11964905+0.26022364j
   0.42360996+0.15772491j  0.09489353-0.20238895j  0.43766742+0.09867416j
  -0.39308214-0.3823196j   0.17300079-0.20077264j]
 [-0.19269749+0.52262359j -0.21926009-0.35312492j  0.24779958-0.35600556j
   0.14776099+0.18081739j  0.01884494-0.188706j   -0.32314148+0.14865839j
  -0.17004354+0.15267074j  0.2418101 +0.03327378j]
 [-0.29324698+0.08338754j -0.03825291+0.14606404j -0.65877447+0.0801392j
   0.22922106-0.0675777j   0.16786727-0.13050491j -0.22321734-0.0624549j
  -0.40567692+0.11531366j -0.28740925+0.16530873j]
 [-0.29251757-0.36855904j -0.11985002+0.16219961j  0.27652364-0.16933085j
   0.3510462 +0.08621088j -0.03935658-0.09117357j  0.31438403+0.38548329j
   0.05238088+0.29895143j -0.20281422+0.33402903j]
 [ 0.02749325+0.10374121j  0.55958993-0.202914j   -0.1407381 -0.19023934j
  -0.04794872+0.03655391j -0.4106984 +0.42329555j  0.01019089+0.38673703j
  -0.21738335-0.04573889j -0.12586036+0.10873512j]
 [ 0.44859671-0.02221988j  0.26535075-0.04229105j  0.05009846-0.28623629j
  -0.00740285-0.24538424j  0.45237955-0.28201001j -0.09541676+0.0925977j
   0.02145148-0.21258905j -0.05692481+0.48021675j]
 [-0.268427  +0.04150149j  0.24142758-0.31292333j -0.08250526-0.00875003j
  -0.10154419-0.22548245j  0.23429803-0.33850449j  0.11952744+0.29805433j
   0.28996725+0.04032578j -0.29730085-0.50525244j]]
INFO 2022-02-10 19:13:57,856 
INFO 2022-02-10 19:13:57,856 Number of coherent states = 1
INFO 2022-02-10 19:13:57,864 mu = [-0.63024272  0.37524669 -0.8671387  -1.3196114  -1.31632904  0.12371964
  2.0186852  -1.2079215  -0.63877186  0.91824406  2.35180615  0.37524391
 -1.65851566  0.46683546 -0.09998948  0.1867567 ]
INFO 2022-02-10 19:13:57,874 cov = [[15.88663778  1.53440719 -3.94847945 -1.34375762 -3.67261427  3.98428192
   3.8053612   3.53132444  2.90933046 -0.5026143  -0.17232574  1.64103203
   2.52526302  1.90958854 -0.56554239  1.15292829]
 [ 1.53440719  7.62748499 -2.40228049 -0.71434326 -3.16957126 -2.55396479
  -1.44020234  2.51590095 -0.84151673 -5.66817376 -0.94378145 -0.32662923
  -3.84416051 -4.54782057  1.21334106  2.26302639]
 [-3.94847945 -2.40228049  8.45499197 -1.09801885  3.18972809  2.71034015
   2.63052354  3.84442934 -2.20773445  0.73439071  1.18701122 -3.26112544
  -1.17660754  2.50438872  4.4554887   1.59529326]
 [-1.34375762 -0.71434326 -1.09801885  2.21352608  1.86489442 -2.52596598
   1.49767022 -1.79303541  0.56197977  1.02543762 -0.48400402  3.90177082
   1.4790182  -1.82088927  0.34137758  0.41376126]
 [-3.67261427 -3.16957126  3.18972809  1.86489442  9.56670658  2.95944078
   3.8415324  -1.70453137  2.72962583 -3.25800438  3.35573914  4.1606316
  -0.81283341 -1.011931    1.42038071 -1.35701934]
 [ 3.98428192 -2.55396479  2.71034015 -2.52596598  2.95944078  9.3904244
   0.72827174 -0.62062707  1.69447189 -4.48626821  1.80885351 -2.48312672
  -1.42110764  5.80795045 -1.9008506  -1.36369851]
 [ 3.8053612  -1.44020234  2.63052354  1.49767022  3.8415324   0.72827174
  11.48781001 -1.38023572  0.78648704 -0.67717166 -0.20375176 -0.28395827
   4.89881802 -2.85528509  4.25453001  4.9100014 ]
 [ 3.53132444  2.51590095  3.84442934 -1.79303541 -1.70453137 -0.62062707
  -1.38023572 13.61033526  0.26394737  3.44186535  4.27322054  0.62050869
  -3.60543188 -0.77689535  5.16613637 -1.46851376]
 [ 2.90933046 -0.84151673 -2.20773445  0.56197977  2.72962583  1.69447189
   0.78648704  0.26394737  5.55140567 -0.71164673  4.90390882  0.75198202
   1.78424729 -3.60823719 -2.5973877  -4.17309134]
 [-0.5026143  -5.66817376  0.73439071  1.02543762 -3.25800438 -4.48626821
  -0.67717166  3.44186535 -0.71164673 13.63187338  0.56877337  0.86490552
   5.18574439  2.07903473  0.77474225 -2.23421803]
 [-0.17232574 -0.94378145  1.18701122 -0.48400402  3.35573914  1.80885351
  -0.20375176  4.27322054  4.90390882  0.56877337  7.50725854 -0.92806764
  -0.43161431 -3.70062217 -0.64557395 -5.3305665 ]
 [ 1.64103203 -0.32662923 -3.26112544  3.90177082  4.1606316  -2.48312672
  -0.28395827  0.62050869  0.75198202  0.86490552 -0.92806764 18.14794276
  -2.97920402  2.51405478  1.20279647  0.12954432]
 [ 2.52526302 -3.84416051 -1.17660754  1.4790182  -0.81283341 -1.42110764
   4.89881802 -3.60543188  1.78424729  5.18574439 -0.43161431 -2.97920402
   8.19444727 -2.02265502 -1.35097374  0.42469067]
 [ 1.90958854 -4.54782057  2.50438872 -1.82088927 -1.011931    5.80795045
  -2.85528509 -0.77689535 -3.60823719  2.07903473 -3.70062217  2.51405478
  -2.02265502 12.61941481 -0.93127391  0.68286451]
 [-0.56554239  1.21334106  4.4554887   0.34137758  1.42038071 -1.9008506
   4.25453001  5.16613637 -2.5973877   0.77474225 -0.64557395  1.20279647
  -1.35097374 -0.93127391  6.67151469  3.83647336]
 [ 1.15292829  2.26302639  1.59529326  0.41376126 -1.35701934 -1.36369851
   4.9100014  -1.46851376 -4.17309134 -2.23421803 -5.3305665   0.12954432
   0.42469067  0.68286451  3.83647336  7.13922922]]
INFO 2022-02-10 19:13:57,876 A=[[ 4.26318191e-01-2.40014057e-01j  9.26475220e-02+5.54440869e-02j
  -3.65152337e-01+9.81751492e-02j -8.64472054e-02-9.08720765e-02j
  -2.25090189e-01-2.16759012e-01j  3.13183969e-01-1.48663959e-01j
   2.64107115e-01-9.11375029e-03j  3.17799597e-01-5.84447320e-02j
   6.66133815e-16+4.64931356e-16j -2.45842690e-16+8.11171058e-16j
   9.60874465e-16+4.37439198e-16j -2.49800181e-16-1.88737914e-15j
  -2.97714600e-16+7.79994456e-16j -6.06583371e-16+5.92410047e-16j
   7.62425624e-16+6.79353560e-17j  1.15106799e-16+8.73606288e-17j]
 [ 9.26475220e-02+5.54440869e-02j -2.47675134e-01+4.67613220e-01j
  -1.22553059e-01+8.63716280e-03j -6.51424637e-02-2.88251610e-02j
  -3.44648578e-01+2.92957338e-01j -1.91106688e-01+3.72647304e-01j
  -9.13642927e-02-2.21164617e-02j  1.95937751e-01-2.35321190e-01j
  -7.29220325e-17-1.00911970e-15j -6.66133815e-16+7.40847913e-17j
   1.21306399e-16-1.36369208e-15j  9.29811783e-16-9.26342336e-16j
  -1.54180810e-15-9.16381172e-16j  7.76666017e-16-2.80155560e-15j
   4.33198519e-17-7.55849826e-16j -5.07537479e-16-4.98085177e-16j]
 [-3.65152337e-01+9.81751492e-02j -1.22553059e-01+8.63716280e-03j
   3.90930748e-02-9.79260982e-02j -7.01032101e-03+1.54482918e-01j
   1.49376823e-01-8.98870420e-02j  2.64445910e-01-1.77917013e-01j
   1.35135809e-01-1.75379980e-01j  3.78459583e-01-2.42070440e-01j
   7.19117807e-16-3.10163163e-16j -1.65546697e-16+1.36713693e-15j
  -2.22044605e-16-1.08354409e-16j  9.15933995e-16+2.49800181e-16j
  -1.55611466e-16+2.60125886e-16j -4.27870076e-16+1.54465250e-15j
  -3.38425996e-16+3.17362456e-16j  6.61027976e-17-2.88539847e-17j]
 [-8.64472054e-02-9.08720765e-02j -6.51424637e-02-2.88251610e-02j
  -7.01032101e-03+1.54482918e-01j -6.57279064e-01-3.21888442e-01j
   1.99814311e-01-2.32630025e-01j -2.07895915e-01+1.77536440e-01j
   1.21632531e-02-2.36849003e-03j -7.93045288e-02-4.26626215e-02j
  -2.41163312e-16+1.60090084e-15j  1.18767912e-15+8.07825516e-16j
   6.87993382e-16-2.96387670e-16j -8.88178420e-16+0.00000000e+00j
   1.30151509e-15-8.10194202e-16j  2.88892454e-16-2.20416949e-16j
  -8.94020505e-17-9.25903968e-16j -1.04212301e-16+5.82282038e-16j]
 [-2.25090189e-01-2.16759012e-01j -3.44648578e-01+2.92957338e-01j
   1.49376823e-01-8.98870420e-02j  1.99814311e-01-2.32630025e-01j
   5.66043513e-02+6.70571623e-02j  2.05506567e-01+1.00360458e-01j
   2.14185787e-01-2.60660751e-01j -8.78283218e-02+2.04696248e-01j
  -1.79729158e-16-7.10619537e-16j -1.56300811e-15+5.63048459e-16j
  -2.85380130e-16+3.10249640e-16j  1.11022302e-15+1.04083409e-15j
  -1.55431223e-15+1.13612367e-16j -9.12504352e-16-9.69833403e-16j
  -5.91717111e-17-3.82759448e-16j -5.86240829e-17-1.43590030e-15j]
 [ 3.13183969e-01-1.48663959e-01j -1.91106688e-01+3.72647304e-01j
   2.64445910e-01-1.77917013e-01j -2.07895915e-01+1.77536440e-01j
   2.05506567e-01+1.00360458e-01j -1.33192688e-01-4.79144523e-01j
   6.84546311e-02+1.96185934e-01j -5.37677494e-02+8.82973981e-02j
  -8.19281549e-16-8.45456622e-16j  8.00139911e-16+2.76588220e-15j
  -4.99087392e-16-1.61209824e-15j  5.55111512e-17+3.88578059e-16j
  -8.33957779e-16+1.20995447e-15j  8.88178420e-16-4.64812249e-16j
   6.68536806e-16-1.62288686e-16j  1.29435872e-15+3.88798465e-17j]
 [ 2.64107115e-01-9.11375029e-03j -9.13642927e-02-2.21164617e-02j
   1.35135809e-01-1.75379980e-01j  1.21632531e-02-2.36849003e-03j
   2.14185787e-01-2.60660751e-01j  6.84546311e-02+1.96185934e-01j
   1.98667460e-01-3.50990382e-01j -2.15184135e-01-4.15630804e-01j
   7.64057614e-16+1.97964881e-16j  3.64288804e-16+6.67359550e-16j
  -5.61373180e-16-4.33058732e-16j -1.11022302e-16+1.11022302e-15j
  -1.20318943e-16+6.90369645e-16j  5.53462548e-16+2.83483236e-16j
  -8.88178420e-16+1.78122048e-16j -2.26586076e-16-5.91793924e-16j]
 [ 3.17799597e-01-5.84447320e-02j  1.95937751e-01-2.35321190e-01j
   3.78459583e-01-2.42070440e-01j -7.93045288e-02-4.26626215e-02j
  -8.78283218e-02+2.04696248e-01j -5.37677494e-02+8.82973981e-02j
  -2.15184135e-01-4.15630804e-01j  2.66926779e-01+1.21149506e-01j
   1.83450327e-17-2.48383339e-16j -7.45939677e-16+5.48989431e-16j
   1.97005248e-16+7.78093176e-17j -3.05311332e-16-8.60422844e-16j
  -1.13726003e-16+1.46080412e-15j  1.03575587e-15+1.13032597e-16j
  -1.17668832e-16+1.91047746e-16j  8.88178420e-16+7.11050046e-17j]
 [ 1.22124533e-15+6.30715350e-17j -1.18421043e-16-5.42368379e-16j
   1.26436921e-15-4.99785892e-16j -2.32189573e-16+1.83536584e-15j
  -2.58403944e-16-6.43598757e-16j -8.25229946e-16-5.92311276e-16j
   6.75395845e-16-1.91278283e-16j  1.78763052e-16-1.29331195e-16j
   4.26318191e-01+2.40014057e-01j  9.26475220e-02-5.54440869e-02j
  -3.65152337e-01-9.81751492e-02j -8.64472054e-02+9.08720765e-02j
  -2.25090189e-01+2.16759012e-01j  3.13183969e-01+1.48663959e-01j
   2.64107115e-01+9.11375029e-03j  3.17799597e-01+5.84447320e-02j]
 [-3.78753592e-16+7.35537203e-16j -1.33226763e-15-1.53620442e-16j
   1.33844881e-16+1.33844881e-15j  1.04383831e-15+8.32874515e-16j
  -1.42971901e-15+7.76404183e-16j  7.95150427e-16+3.04862137e-15j
   1.06129051e-16+5.85985268e-16j -6.70274213e-16+6.70223531e-16j
   9.26475220e-02-5.54440869e-02j -2.47675134e-01-4.67613220e-01j
  -1.22553059e-01-8.63716280e-03j -6.51424637e-02+2.88251610e-02j
  -3.44648578e-01-2.92957338e-01j -1.91106688e-01-3.72647304e-01j
  -9.13642927e-02+2.21164617e-02j  1.95937751e-01+2.35321190e-01j]
 [ 1.17387221e-15+3.11578575e-16j  2.57244799e-16-1.31268694e-15j
   0.00000000e+00+2.93285887e-17j  8.13817890e-16-1.78022663e-16j
  -1.52941257e-16+1.92806893e-16j -3.95879439e-16-1.75333412e-15j
  -4.91943665e-16-6.72793775e-16j  2.72638920e-16-9.51624489e-17j
  -3.65152337e-01-9.81751492e-02j -1.22553059e-01-8.63716280e-03j
   3.90930748e-02+9.79260982e-02j -7.01032101e-03-1.54482918e-01j
   1.49376823e-01+8.98870420e-02j  2.64445910e-01+1.77917013e-01j
   1.35135809e-01+1.75379980e-01j  3.78459583e-01+2.42070440e-01j]
 [-2.52045194e-16-1.58862797e-15j  1.18907406e-15-9.06002264e-16j
   7.59330787e-16+4.75552818e-16j -4.44089210e-16-2.77555756e-16j
   1.15750133e-15+4.86497213e-16j  3.07117596e-16+4.32621138e-16j
  -6.65951079e-17+1.03447320e-15j -2.48027826e-16-6.93591928e-16j
  -8.64472054e-02+9.08720765e-02j -6.51424637e-02+2.88251610e-02j
  -7.01032101e-03-1.54482918e-01j -6.57279064e-01+3.21888442e-01j
   1.99814311e-01+2.32630025e-01j -2.07895915e-01-1.77536440e-01j
   1.21632531e-02+2.36849003e-03j -7.93045288e-02+4.26626215e-02j]
 [-2.25911217e-16+7.07394266e-16j -1.37094607e-15-1.16179906e-15j
   1.39552304e-16-1.17575892e-16j  1.34044995e-15-9.23110125e-16j
  -8.88178420e-16+2.06432094e-16j -9.98196240e-16+1.08582306e-15j
  -7.02686229e-17+6.60486365e-16j -1.35228614e-16+1.08497031e-15j
  -2.25090189e-01+2.16759012e-01j -3.44648578e-01-2.92957338e-01j
   1.49376823e-01+8.98870420e-02j  1.99814311e-01+2.32630025e-01j
   5.66043513e-02-6.70571623e-02j  2.05506567e-01-1.00360458e-01j
   2.14185787e-01+2.60660751e-01j -8.78283218e-02-2.04696248e-01j]
 [-6.05590168e-16+6.40701829e-16j  8.03687831e-16-2.98258246e-15j
  -3.78414114e-16+1.52993297e-15j -9.07838030e-18-2.27459984e-16j
  -4.84013245e-16-1.00815488e-15j  7.77156117e-16-7.45931095e-17j
   6.95382792e-16+5.83922100e-16j  7.04041256e-16-7.13245892e-17j
   3.13183969e-01+1.48663959e-01j -1.91106688e-01-3.72647304e-01j
   2.64445910e-01+1.77917013e-01j -2.07895915e-01-1.77536440e-01j
   2.05506567e-01-1.00360458e-01j -1.33192688e-01+4.79144523e-01j
   6.84546311e-02-1.96185934e-01j -5.37677494e-02-8.82973981e-02j]
 [ 9.29235341e-16+2.97580982e-16j  4.40010177e-16-7.02541223e-16j
  -5.29209722e-16+4.47406371e-16j  1.99793929e-16-8.76871616e-16j
   1.38526279e-16-5.47165056e-16j  3.67887604e-16-8.82246649e-18j
  -1.77635684e-15+2.25514052e-16j -6.56611602e-17+2.17785509e-16j
   2.64107115e-01+9.11375029e-03j -9.13642927e-02+2.21164617e-02j
   1.35135809e-01+1.75379980e-01j  1.21632531e-02+2.36849003e-03j
   2.14185787e-01+2.60660751e-01j  6.84546311e-02-1.96185934e-01j
   1.98667460e-01+3.50990382e-01j -2.15184135e-01+4.15630804e-01j]
 [-9.53794736e-17+2.42861645e-16j -6.96127354e-16-9.04111727e-16j
   5.31739145e-16-1.97150132e-16j -4.18616694e-16+8.50548357e-16j
  -5.80373700e-17-1.52588931e-15j  9.08068175e-16-6.62696556e-17j
  -1.83420667e-16-2.74421460e-16j  3.33066907e-16-1.64798730e-17j
   3.17799597e-01+5.84447320e-02j  1.95937751e-01+2.35321190e-01j
   3.78459583e-01+2.42070440e-01j -7.93045288e-02+4.26626215e-02j
  -8.78283218e-02-2.04696248e-01j -5.37677494e-02-8.82973981e-02j
  -2.15184135e-01+4.15630804e-01j  2.66926779e-01-1.21149506e-01j]], gamma = [-0.31512136+0.31938593j  0.18762334-0.45912203j -0.43356935-1.17590307j
 -0.6598057 -0.18762196j -0.65816452+0.82925783j  0.06185982-0.23341773j
  1.0093426 +0.04999474j -0.60396075-0.09337835j -0.31512136-0.31938593j
  0.18762334+0.45912203j -0.43356935+1.17590307j -0.6598057 +0.18762196j
 -0.65816452-0.82925783j  0.06185982+0.23341773j  1.0093426 -0.04999474j
 -0.60396075+0.09337835j]
INFO 2022-02-10 19:13:58,106 lhaf_exact = (4.856853853167022-1.538325022920617e-11j), prob_exact = 9.738104068786048e-08
INFO 2022-02-10 19:14:03,749 lhaf_k for k=N is (4.856853846046761+4.8326334284465506e-11j), prob_k = 9.738104054509761e-08
INFO 2022-02-10 19:14:03,749 For k = 0, lhaf_k_approx=(2.423374726231956e-06+1.164670302474663e-20j), prob_k_approx = 4.8589222560864944e-14, time = 0.0
INFO 2022-02-10 19:14:03,789 For k = 1, lhaf_k_approx=(2.5817564342234396e-05+1.827473583701153e-19j), prob_k_approx = 5.176481235961384e-13, time = 0.04025411605834961
INFO 2022-02-10 19:14:07,206 For k = 2, lhaf_k_approx=(0.0004945709884542333-1.907264087332508e-17j), prob_k_approx = 9.916262462435853e-12, time = 3.416800022125244
