INFO 2022-02-11 18:51:30,782 NumExpr defaulting to 8 threads.
INFO 2022-02-11 18:51:38,315 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 4, hbar = 2
INFO 2022-02-11 18:51:38,315 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-11 18:51:38,323 U = [[-0.11056607+0.01083625j  0.42931038-0.19193692j -0.06771942+0.09670692j
   0.02628177+0.23998961j -0.14855045-0.59618178j -0.00830236+0.41059087j
  -0.07576492-0.19519377j  0.32260362+0.01479441j]
 [ 0.10851811+0.0248574j  -0.14440167-0.02755058j  0.17583333-0.7085793j
   0.00908761+0.17286605j  0.11378623-0.12375393j  0.04428685-0.21586228j
   0.15558555+0.01203055j  0.4871542 -0.25404099j]
 [-0.23119608+0.2804435j  -0.02593545+0.13856466j  0.09792509+0.11465546j
  -0.34662255-0.11130393j  0.24865814-0.25814118j  0.51592026+0.0097611j
   0.25887879-0.13272739j -0.23751649-0.39619495j]
 [-0.09879538+0.33884445j  0.25829135-0.29847109j -0.25009148-0.10579395j
   0.35504597-0.44878677j  0.17237488+0.07662316j  0.14459251-0.24156747j
   0.18025979-0.27883321j  0.11031343+0.28489041j]
 [-0.09978221-0.17349711j -0.04075127-0.31401172j  0.08940113-0.32784111j
  -0.05308061+0.09068667j  0.36106198+0.19019334j  0.07540196+0.27919779j
  -0.47471665-0.40858022j -0.3010312 -0.00864063j]
 [-0.37158823+0.49428596j -0.2573874 +0.32400037j -0.13269612+0.01784531j
  -0.10328076+0.24826295j -0.1833611 +0.29780747j -0.10827592+0.10984839j
  -0.13481576-0.32962859j  0.26934132+0.10331976j]
 [-0.08781183+0.46367175j  0.2243713 -0.25760372j -0.0009983 -0.32394604j
  -0.31598024-0.11964721j -0.1169899 +0.05976036j -0.34783879+0.22138152j
   0.02874644+0.43577308j -0.24739533-0.04802002j]
 [-0.26979584-0.02531822j  0.14098681-0.41653539j -0.16067222+0.30402287j
  -0.08489848+0.49702746j  0.28690662+0.20435893j -0.0974695 -0.38772209j
   0.05602445+0.15473808j  0.10186028-0.19833263j]]
INFO 2022-02-11 18:51:50,491 
INFO 2022-02-11 18:51:50,491 Number of coherent states = 2
INFO 2022-02-11 18:51:50,522 mu = [ 1.43434942 -0.16147603 -1.15709192  0.71773183 -0.63240068 -2.83039033
  0.61451761 -0.57964065 -0.81495303 -0.01211929  1.88553674  0.18168009
 -2.19378975  3.6822885   0.9273061  -1.98834124]
INFO 2022-02-11 18:51:50,522 cov = [[14.20849365 -1.12861052  3.58734474 -4.3482135   1.62089615 -0.23726737
  -1.85252604 -3.50361912 -2.31440633  1.14655995  1.44648733  0.24312361
   2.10251615 -1.23737787  3.39364881  5.54076765]
 [-1.12861052 14.66654638  0.61196548 -0.82042083  3.57605807 -1.34024725
   3.76847459 -0.45472636  0.26663566  5.94910918  4.62242503 -3.46315826
   1.41604255 -1.14758217 -2.09809336 -1.25326726]
 [ 3.58734474  0.61196548  6.10175733 -1.26647333 -0.87136014 -1.92005503
  -1.57758346 -0.42586197  1.97294784  4.93531355 -1.11645454  3.88821777
  -2.26922183  1.041225   -3.55937391  2.98878598]
 [-4.3482135  -0.82042083 -1.26647333  9.96566351  1.19745304  0.13496
  -1.84226003 -5.26894382 -2.08391499 -1.6525766   2.2954569   3.84215241
  -1.60043439 -4.05843627 -3.08264706 -2.498877  ]
 [ 1.62089615  3.57605807 -0.87136014  1.19745304  8.97023462  5.1334721
  -0.20165618 -3.95982236 -0.37453897  1.9802928  -0.61160654 -2.45708218
  -5.5861092  -0.68113014  3.50327126 -1.05953769]
 [-0.23726737 -1.34024725 -1.92005503  0.13496     5.1334721   6.82170976
  -3.02996878  1.59479428 -0.44648495 -0.96542899  1.38928775 -2.35921394
  -4.88796004  0.49271638  4.00344547 -0.75412856]
 [-1.85252604  3.76847459 -1.57758346 -1.84226003 -0.20165618 -3.02996878
   8.43374326 -3.28124292  1.00818064 -0.15720415 -5.72500448 -3.39889424
   3.89703007  1.2649068   0.4754021  -1.6453412 ]
 [-3.50361912 -0.45472636 -0.42586197 -5.26894382 -3.95982236  1.59479428
  -3.28124292 13.47720299  2.58449031  0.12308701  4.46213652 -1.92370963
  -0.71614829  3.38142398 -0.22468557  0.13635104]
 [-2.31440633  0.26663566  1.97294784 -2.08391499 -0.37453897 -0.44648495
   1.00818064  2.58449031  3.30797945  2.51392453 -3.40255372  0.64840034
  -2.67207405  2.79285436 -1.39651729  0.06167072]
 [ 1.14655995  5.94910918  4.93531355 -1.6525766   1.9802928  -0.96542899
  -0.15720415  0.12308701  2.51392453  6.88809194 -0.24373968  1.45550337
  -3.56380885  1.33613007 -3.29669212  1.23995274]
 [ 1.44648733  4.62242503 -1.11645454  2.2954569  -0.61160654  1.38928775
  -5.72500448  4.46213652 -3.40255372 -0.24373968 13.06485363 -0.14671846
   2.24871224 -3.66902709 -0.62529092  0.54930845]
 [ 0.24312361 -3.46315826  3.88821777  3.84215241 -2.45708218 -2.35921394
  -3.39889424 -1.92370963  0.64840034  1.45550337 -0.14671846  6.60169561
  -1.89112417 -0.96515725 -4.24336139  1.64918983]
 [ 2.10251615  1.41604255 -2.26922183 -1.60043439 -5.5861092  -4.88796004
   3.89703007 -0.71614829 -2.67207405 -3.56380885  2.24871224 -1.89112417
  10.43223232 -2.30086211  0.20037031  0.79452424]
 [-1.23737787 -1.14758217  1.041225   -4.05843627 -0.68113014  0.49271638
   1.2649068   3.38142398  2.79285436  1.33613007 -3.66902709 -0.96515725
  -2.30086211  4.21434181  0.58861781  0.09564467]
 [ 3.39364881 -2.09809336 -3.55937391 -3.08264706  3.50327126  4.00344547
   0.4754021  -0.22468557 -1.39651729 -3.29669212 -0.62529092 -4.24336139
   0.20037031  0.58861781  6.9386905   0.22684976]
 [ 5.54076765 -1.25326726  2.98878598 -2.498877   -1.05953769 -0.75412856
  -1.6453412   0.13635104  0.06167072  1.23995274  0.54930845  1.64918983
   0.79452424  0.09564467  0.22684976  3.36476615]]
INFO 2022-02-11 18:51:50,538 A=[[ 4.49635523e-01+1.90933984e-01j -1.50250999e-01-5.82929332e-02j
   2.88326458e-01-1.41048348e-01j -2.06105422e-01+7.59308399e-02j
   1.77080811e-01-7.12773647e-02j -1.24989550e-01+6.94576901e-02j
  -1.88099136e-02-1.81571149e-01j -1.47064710e-01-3.35158924e-01j
   1.33226763e-15-4.62223187e-32j -2.22044605e-16-8.32667268e-17j
   1.66533454e-16+5.55111512e-16j  1.77031480e-30+2.22044605e-16j
  -1.66533454e-15+5.55111512e-16j -4.44089210e-16-1.08246745e-15j
  -4.44089210e-16-2.22044605e-16j -7.77156117e-16+3.33066907e-16j]
 [-1.50250999e-01-5.82929332e-02j  3.20853619e-01-4.90789841e-01j
   3.52969989e-02-3.94247345e-01j -9.38796417e-02+2.11019047e-01j
   2.94512510e-01-1.40095503e-01j -1.10397940e-01+8.71596385e-02j
   2.91431200e-01+9.30288110e-02j -6.99038512e-02+4.66188270e-02j
  -3.33066907e-16+1.94289029e-16j  8.88178420e-16-6.39216149e-31j
  -1.66533454e-16+1.22124533e-15j  2.22044605e-16-1.05471187e-15j
  -4.85722573e-17-3.05311332e-16j  1.87350135e-16-6.03683770e-16j
   1.11022302e-16+2.77555756e-16j  6.66133815e-16-7.21644966e-16j]
 [ 2.88326458e-01-1.41048348e-01j  3.52969989e-02-3.94247345e-01j
  -2.87220895e-01+9.21053104e-02j -4.61887907e-02-2.55070517e-01j
  -1.28699926e-01+1.18831346e-01j  7.21433824e-02-1.00256268e-01j
  -3.92811337e-02+3.82971505e-01j -4.02248234e-02-3.07343248e-01j
   1.11022302e-16-5.55111512e-16j  1.11022302e-16-1.11022302e-15j
   8.88178420e-16+5.55111512e-17j  6.66133815e-16+2.77555756e-16j
   4.99600361e-16+3.33066907e-16j -6.66133815e-16+2.49800181e-16j
  -7.77156117e-16-2.22044605e-16j  6.10622664e-16+8.88178420e-16j]
 [-2.06105422e-01+7.59308399e-02j -9.38796417e-02+2.11019047e-01j
  -4.61887907e-02-2.55070517e-01j  1.38760378e-01-3.16970039e-01j
   1.27400782e-01+1.67368580e-01j  4.53787581e-02+2.64721779e-01j
   9.90430767e-02+2.67357224e-01j -2.85366230e-01+1.82427362e-01j
   2.39123462e-30-4.44089210e-16j  1.66533454e-16+9.43689571e-16j
   8.32667268e-16-2.77555756e-16j  1.77635684e-15+5.55111512e-17j
   9.15933995e-16-5.55111512e-17j -2.22044605e-16+2.77555756e-16j
  -4.44089210e-16+9.29811783e-16j  3.33066907e-16+2.22044605e-16j]
 [ 1.77080811e-01-7.12773647e-02j  2.94512510e-01-1.40095503e-01j
  -1.28699926e-01+1.18831346e-01j  1.27400782e-01+1.67368580e-01j
  -6.03059719e-02+4.60843055e-01j  3.06658997e-01+2.29719509e-01j
  -1.65831985e-02-3.05255174e-01j -1.96112135e-01+7.32453055e-02j
  -1.72084569e-15-6.66133815e-16j  1.04083409e-16+2.22044605e-16j
   6.66133815e-16-3.33066907e-16j  7.21644966e-16-5.55111512e-17j
   3.55271368e-15+8.32667268e-17j  9.99200722e-16+1.55431223e-15j
  -8.88178420e-16-2.77555756e-17j  6.66133815e-16-2.77555756e-16j]
 [-1.24989550e-01+6.94576901e-02j -1.10397940e-01+8.71596385e-02j
   7.21433824e-02-1.00256268e-01j  4.53787581e-02+2.64721779e-01j
   3.06658997e-01+2.29719509e-01j  1.07551372e-01-4.06481349e-02j
  -1.49263149e-01-2.17314365e-01j  6.18384515e-02-1.08373360e-01j
  -4.44089210e-16+1.11022302e-15j  1.31838984e-16+6.59194921e-16j
  -8.88178420e-16-1.94289029e-16j -3.33066907e-16-3.33066907e-16j
   7.77156117e-16-1.77635684e-15j  1.33226763e-15+6.46342089e-31j
   2.22044605e-16-2.22044605e-16j -1.66533454e-16-8.88178420e-16j]
 [-1.88099136e-02-1.81571149e-01j  2.91431200e-01+9.30288110e-02j
  -3.92811337e-02+3.82971505e-01j  9.90430767e-02+2.67357224e-01j
  -1.65831985e-02-3.05255174e-01j -1.49263149e-01-2.17314365e-01j
   6.16694603e-02-3.92197408e-02j -1.44705383e-01+7.71367710e-02j
  -2.22044605e-16+2.22044605e-16j  3.33066907e-16-1.66533454e-16j
  -8.88178420e-16+2.22044605e-16j -4.44089210e-16-9.29811783e-16j
  -8.88178420e-16+2.20249348e-30j  3.33066907e-16+3.33066907e-16j
   0.00000000e+00-8.32667268e-17j -4.44089210e-16-1.66533454e-16j]
 [-1.47064710e-01-3.35158924e-01j -6.99038512e-02+4.66188270e-02j
  -4.02248234e-02-3.07343248e-01j -2.85366230e-01+1.82427362e-01j
  -1.96112135e-01+7.32453055e-02j  6.18384515e-02-1.08373360e-01j
  -1.44705383e-01+7.71367710e-02j  4.17128105e-01-1.12486933e-02j
  -7.77156117e-16-3.33066907e-16j  6.10622664e-16+9.99200722e-16j
   7.21644966e-16-1.11022302e-15j  3.33066907e-16-2.22044605e-16j
   8.88178420e-16+2.77555756e-16j -1.66533454e-16+8.88178420e-16j
  -3.33066907e-16+3.33066907e-16j -4.44089210e-16+7.37257477e-18j]
 [ 9.99200722e-16+1.35123790e-17j -2.50300415e-16+5.68864579e-17j
   2.90355141e-16-4.65455289e-16j  1.64944204e-16-2.85561346e-16j
  -1.59462306e-15-8.48660026e-16j -4.80025052e-16+1.09463509e-15j
  -4.37423792e-16+2.27461154e-16j -6.86438052e-16-7.38338879e-16j
   4.49635523e-01-1.90933984e-01j -1.50250999e-01+5.82929332e-02j
   2.88326458e-01+1.41048348e-01j -2.06105422e-01-7.59308399e-02j
   1.77080811e-01+7.12773647e-02j -1.24989550e-01-6.94576901e-02j
  -1.88099136e-02+1.81571149e-01j -1.47064710e-01+3.35158924e-01j]
 [-3.49125314e-16-8.70145395e-17j  6.66133815e-16-3.69466486e-18j
   6.16352438e-17-1.01698152e-15j  1.96180644e-16+7.76418265e-16j
   2.37028257e-16+2.62745155e-16j  5.00363483e-17+9.42793465e-16j
   2.21342169e-16-1.55933288e-16j  6.49748177e-16+1.14633020e-15j
  -1.50250999e-01+5.82929332e-02j  3.20853619e-01+4.90789841e-01j
   3.52969989e-02+3.94247345e-01j -9.38796417e-02-2.11019047e-01j
   2.94512510e-01+1.40095503e-01j -1.10397940e-01-8.71596385e-02j
   2.91431200e-01-9.30288110e-02j -6.99038512e-02-4.66188270e-02j]
 [ 1.64601627e-16+4.57815514e-16j -5.34310612e-17+1.01349149e-15j
   1.11022302e-15+2.80257304e-17j  5.46145223e-16-3.15083782e-16j
   4.97843953e-16-5.03105812e-16j -6.59197725e-16-1.30324458e-16j
  -8.13890561e-16+9.38527158e-17j  7.08598587e-16-8.86986855e-16j
   2.88326458e-01+1.41048348e-01j  3.52969989e-02+3.94247345e-01j
  -2.87220895e-01-9.21053104e-02j -4.61887907e-02+2.55070517e-01j
  -1.28699926e-01-1.18831346e-01j  7.21433824e-02+1.00256268e-01j
  -3.92811337e-02-3.82971505e-01j -4.02248234e-02+3.07343248e-01j]
 [ 2.78478576e-16+3.52955405e-16j  1.79715825e-16-8.51626343e-16j
   5.44004660e-16+8.41911974e-17j  1.44328993e-15+6.31433981e-17j
   6.08767120e-16-9.06674434e-17j -4.01527249e-16-2.20192362e-16j
  -7.25339547e-16-9.06674434e-16j  3.36764790e-16-4.14479741e-16j
  -2.06105422e-01-7.59308399e-02j -9.38796417e-02-2.11019047e-01j
  -4.61887907e-02+2.55070517e-01j  1.38760378e-01+3.16970039e-01j
   1.27400782e-01-1.67368580e-01j  4.53787581e-02-2.64721779e-01j
   9.90430767e-02-2.67357224e-01j -2.85366230e-01-1.82427362e-01j]
 [-1.56545265e-15+7.95863655e-16j  1.15610099e-16-1.97649592e-16j
   5.11281236e-16+6.03704258e-16j  7.03197185e-16-1.61988255e-16j
   3.99680289e-15-6.61410128e-17j  1.05496773e-15-1.76545620e-15j
  -7.26321682e-16-3.11267456e-17j  8.65933738e-16+2.51760369e-16j
   1.77080811e-01+7.12773647e-02j  2.94512510e-01+1.40095503e-01j
  -1.28699926e-01-1.18831346e-01j  1.27400782e-01-1.67368580e-01j
  -6.03059719e-02-4.60843055e-01j  3.06658997e-01-2.29719509e-01j
  -1.65831985e-02+3.05255174e-01j -1.96112135e-01-7.32453055e-02j]
 [-6.51670922e-16-1.09092299e-15j  1.01718293e-16-8.14390487e-16j
  -7.08099318e-16+3.56542667e-16j -3.03985469e-16+2.30532600e-16j
   9.63791508e-16+1.60197949e-15j  1.11022302e-15-9.92257326e-17j
   2.90095407e-16+3.86793875e-16j -1.44378839e-16+9.24444713e-16j
  -1.24989550e-01-6.94576901e-02j -1.10397940e-01-8.71596385e-02j
   7.21433824e-02+1.00256268e-01j  4.53787581e-02-2.64721779e-01j
   3.06658997e-01-2.29719509e-01j  1.07551372e-01+4.06481349e-02j
  -1.49263149e-01+2.17314365e-01j  6.18384515e-02+1.08373360e-01j]
 [-5.36528509e-16-2.29644047e-16j  1.35101993e-16+1.93743199e-16j
  -7.80238300e-16-1.79245247e-16j -6.13811854e-16+8.01690715e-16j
  -7.27926648e-16+2.59022784e-17j  2.48993831e-16-2.77492560e-16j
   0.00000000e+00-1.99134969e-17j -1.32763901e-16+4.64673655e-16j
  -1.88099136e-02+1.81571149e-01j  2.91431200e-01-9.30288110e-02j
  -3.92811337e-02-3.82971505e-01j  9.90430767e-02-2.67357224e-01j
  -1.65831985e-02+3.05255174e-01j -1.49263149e-01+2.17314365e-01j
   6.16694603e-02+3.92197408e-02j -1.44705383e-01-7.71367710e-02j]
 [-7.31894160e-16+3.65947080e-16j  6.35025815e-16-9.47157148e-16j
   6.79423806e-16+9.90209745e-16j  4.30525976e-17+3.84782591e-16j
   8.61051953e-16-1.15703856e-16j -2.15262988e-16-8.17999355e-16j
  -3.65947080e-16-3.33657632e-16j -4.44089210e-16+6.99604711e-17j
  -1.47064710e-01+3.35158924e-01j -6.99038512e-02-4.66188270e-02j
  -4.02248234e-02+3.07343248e-01j -2.85366230e-01-1.82427362e-01j
  -1.96112135e-01-7.32453055e-02j  6.18384515e-02+1.08373360e-01j
  -1.44705383e-01-7.71367710e-02j  4.17128105e-01+1.12486933e-02j]], gamma = [ 0.71717471+0.40747651j -0.08073802+0.00605964j -0.57854596-0.94276837j
  0.35886591-0.09084005j -0.31620034+1.09689487j -1.41519516-1.84114425j
  0.30725881-0.46365305j -0.28982032+0.99417062j  0.71717471-0.40747651j
 -0.08073802-0.00605964j -0.57854596+0.94276837j  0.35886591+0.09084005j
 -0.31620034-1.09689487j -1.41519516+1.84114425j  0.30725881+0.46365305j
 -0.28982032-0.99417062j]
