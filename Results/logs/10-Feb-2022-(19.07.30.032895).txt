INFO 2022-02-10 19:07:30,481 NumExpr defaulting to 8 threads.
INFO 2022-02-10 19:07:34,699 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 4, hbar = 2
INFO 2022-02-10 19:07:34,699 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-10 19:07:34,701 U = [[ 0.17464735+0.17354996j -0.1804075 +0.23364945j  0.48801661+0.23692049j
   0.16289496+0.0466396j  -0.55576384+0.11517503j  0.19717676+0.17297842j
  -0.13152403+0.03060527j -0.33562101+0.08615441j]
 [-0.05736513+0.0859472j   0.14380431-0.0237081j   0.35065492+0.31409607j
   0.2077487 -0.10557339j  0.18043742+0.07371975j -0.37457362-0.58961264j
   0.29154172-0.08772323j -0.22134557-0.15663192j]
 [ 0.38657235+0.24560735j  0.17448992+0.30676074j -0.20702017+0.03538539j
  -0.4259649 +0.47297676j -0.0277905 +0.23608133j -0.2717107 -0.12127027j
  -0.14729862-0.20300044j -0.04556086-0.08003515j]
 [-0.1765657 +0.1874753j   0.34013356+0.27504734j -0.11298432+0.06830759j
   0.14855028+0.05625354j -0.31611282-0.08180972j -0.31061812+0.20089728j
   0.44204203+0.28741214j  0.31819147+0.27741028j]
 [ 0.46595282-0.11341075j -0.47080841-0.18926846j  0.1057085 +0.18731536j
  -0.02536859+0.10805269j -0.01839554-0.11492524j -0.04635279-0.19681318j
   0.19334243-0.05449172j  0.47064111+0.37105075j]
 [-0.20135525+0.36960566j  0.24597125-0.10969579j  0.42001239-0.09012763j
   0.02010876+0.21881589j  0.04914699-0.24114823j  0.12090134-0.17849341j
  -0.44976397+0.01766636j  0.45584221-0.00760016j]
 [ 0.19129153+0.00947735j  0.10940146+0.07280318j -0.15194182+0.40506061j
  -0.05511112-0.61435116j -0.00658906+0.13514333j -0.204702  +0.02105392j
  -0.48067616+0.21138995j  0.20502153+0.0011536j ]
 [-0.3062568 -0.33913955j  0.0854724 -0.47025089j -0.06779681+0.00091881j
  -0.17506915+0.12199367j -0.56632415+0.2521862j  -0.20680723-0.21306893j
  -0.16107854-0.05939612j  0.00321001+0.10318807j]]
INFO 2022-02-10 19:07:34,703 
INFO 2022-02-10 19:07:34,703 Number of coherent states = 1
INFO 2022-02-10 19:07:34,716 mu = [ 0.78591309 -0.25814309  1.73957559 -0.79454565  2.09678771 -0.90609863
  0.86081186 -1.3781556   0.7809748   0.38676238  1.10523307  0.84363885
 -0.51034838  1.66322549  0.04264807 -1.52612798]
INFO 2022-02-10 19:07:34,718 cov = [[ 3.74586736 -1.0082957   2.2146369   3.12732381 -0.20215886 -2.08885522
   2.47252053 -2.4268019  -0.40369288 -1.57577533  1.89929995 -0.17065645
   1.00739658 -4.55709466  0.99384098  2.42901845]
 [-1.0082957  11.03579131  1.61964778 -4.05442343  2.3166483   0.88973495
   3.73825149  2.90925234 -1.07038521 -7.26719775 -3.45723158 -0.26138071
   0.35921451 -0.5434373  -1.91611724 -1.92736134]
 [ 2.2146369   1.61964778  9.92877025 -0.26104892 -0.34693492  0.64133549
  -5.85440018 -0.13384322  1.40952175 -4.41501109  2.11189299 -0.29791567
   4.90683833 -3.17443246 -2.40185942  2.94082   ]
 [ 3.12732381 -4.05442343 -0.26104892  6.53485612  0.43169538 -0.72352755
   1.46217841 -3.87028205  1.11244683 -0.17189083  2.0470052  -6.0470384
  -1.27432055 -2.57231983  2.2957592   0.81186561]
 [-0.20215886  2.3166483  -0.34693492  0.43169538  6.36061504  1.78847288
  -0.69244778  3.3747924  -1.0305266  -0.31976641  1.70271752 -2.63728575
  -6.23608608 -4.25467063 -1.92871629 -1.68963993]
 [-2.08885522  0.88973495  0.64133549 -0.72352755  1.78847288  3.72365652
  -4.71977265  1.12612813 -2.5430002  -0.62231535  0.71897793 -3.12921584
  -1.23071143  2.33222613 -0.46168954 -2.68526474]
 [ 2.47252053  3.73825149 -5.85440018  1.46217841 -0.69244778 -4.71977265
  13.59768626 -2.08936996  0.35530707 -2.25993731 -3.27876441  1.53592177
  -1.40016117 -1.93154889  2.79784805  0.57485646]
 [-2.4268019   2.90925234 -0.13384322 -3.87028205  3.3747924   1.12612813
  -2.08936996  8.20157716  2.30596184 -1.00070362  1.80957934  3.18628854
  -5.5915966   0.98847095 -0.67964317  3.33333287]
 [-0.40369288 -1.07038521  1.40952175  1.11244683 -1.0305266  -2.5430002
   0.35530707  2.30596184 17.26997642  0.90915634 -4.44418039 -3.16172877
  -1.046733    1.50223564 -3.18210556  4.70099356]
 [-1.57577533 -7.26719775 -4.41501109 -0.17189083 -0.31976641 -0.62231535
  -2.25993731 -1.00070362  0.90915634 10.99106092 -1.5980584   3.52321287
  -1.57824879 -1.76660791 -3.53260463 -2.67484585]
 [ 1.89929995 -3.45723158  2.11189299  2.0470052   1.70271752  0.71897793
  -3.27876441  1.80957934 -4.44418039 -1.5980584   8.06803509  0.71064811
  -2.73546606 -0.9032697   4.31035072  4.21656446]
 [-0.17065645 -0.26138071 -0.29791567 -6.0470384  -2.63728575 -3.12921584
   1.53592177  3.18628854 -3.16172877  3.52321287  0.71064811 14.36557929
   1.66412322 -1.39883695 -0.81442763  4.06270883]
 [ 1.00739658  0.35921451  4.90683833 -1.27432055 -6.23608608 -1.23071143
  -1.40016117 -5.5915966  -1.046733   -1.57824879 -2.73546606  1.66412322
  11.22702097  0.95929791 -1.09011023 -1.26467924]
 [-4.55709466 -0.5434373  -3.17443246 -2.57231983 -4.25467063  2.33222613
  -1.93154889  0.98847095  1.50223564 -1.76660791 -0.9032697  -1.39883695
   0.95929791 14.93325019  5.42857466  0.16297619]
 [ 0.99384098 -1.91611724 -2.40185942  2.2957592  -1.92871629 -0.46168954
   2.79784805 -0.67964317 -3.18210556 -3.53260463  4.31035072 -0.81442763
  -1.09011023  5.42857466  7.90275506  3.34035649]
 [ 2.42901845 -1.92736134  2.94082     0.81186561 -1.68963993 -2.68526474
   0.57485646  3.33333287  4.70099356 -2.67484585  4.21656446  4.06270883
  -1.26467924  0.16297619  3.34035649  9.81450543]]
INFO 2022-02-10 19:07:34,726 A=[[-5.57856238e-01+3.33038714e-02j -7.90930167e-02+1.09151528e-01j
   2.74669684e-01-1.36485651e-01j  2.59417253e-01-3.88479296e-02j
   3.48378552e-02+9.54090840e-04j -1.48128977e-01+2.92871951e-01j
   2.33247782e-01-5.56510341e-02j -2.94014574e-01-1.95313294e-01j
  -1.77635684e-15-1.11022302e-16j -6.24500451e-17+3.33066907e-16j
   1.22124533e-15-9.02056208e-16j  1.11022302e-16-1.11022302e-16j
   6.10622664e-16+3.33066907e-16j -6.66133815e-16-3.33066907e-16j
  -1.66533454e-16+3.33066907e-16j -3.33066907e-16-1.11022302e-16j]
 [-7.90930167e-02+1.09151528e-01j  1.84508494e-03+5.99529563e-01j
   1.32727225e-01+3.24722292e-01j -3.12570068e-01+1.78720258e-02j
   1.60660686e-01-1.62719560e-03j  1.09571538e-01+4.80861538e-02j
   2.99915686e-01+1.72258156e-01j  2.30338575e-01+1.20779809e-01j
  -1.17961196e-16-2.22044605e-16j  1.77635684e-15+1.11022302e-16j
   3.33066907e-16+7.22512619e-31j -4.44089210e-16+1.11022302e-16j
  -4.99600361e-16-6.10622664e-16j -5.55111512e-16-2.49800181e-16j
   4.44089210e-16+8.88178420e-16j  1.66533454e-16+7.77156117e-16j]
 [ 2.74669684e-01-1.36485651e-01j  1.32727225e-01+3.24722292e-01j
   7.67535007e-02-1.74227030e-01j -4.00815496e-02-7.21482282e-02j
   9.85245676e-02-2.72637699e-01j  6.37134497e-02+1.01285092e-01j
  -4.19286008e-01+2.34320163e-01j -1.79450051e-01-1.95949315e-01j
   1.33226763e-15+7.63278329e-16j  4.44089210e-16-1.38777878e-16j
  -8.88178420e-16+3.33066907e-16j  2.77555756e-17-1.11022302e-16j
  -3.33066907e-16+4.44089210e-16j -2.22044605e-16-7.77156117e-16j
  -2.77555756e-16+2.22044605e-16j -6.66133815e-16-2.22044605e-16j]
 [ 2.59417253e-01-3.88479296e-02j -3.12570068e-01+1.78720258e-02j
  -4.00815496e-02-7.21482282e-02j -3.23009653e-01+4.98868810e-01j
  -5.08364399e-02+1.61349925e-01j  2.78558507e-02+2.35182756e-01j
   9.39077671e-02-1.58053083e-01j -3.27228096e-01-1.64919939e-01j
   1.11022302e-16+5.55111512e-17j -3.88578059e-16+1.11022302e-16j
   8.32667268e-17-1.11022302e-16j -1.77635684e-15+2.22044605e-16j
  -4.44089210e-16-1.30963236e-31j -5.55111512e-16+1.94289029e-16j
  -1.66533454e-16-3.33066907e-16j -2.22044605e-16-3.33066907e-16j]
 [ 3.48378552e-02+9.54090840e-04j  1.60660686e-01-1.62719560e-03j
   9.85245676e-02-2.72637699e-01j -5.08364399e-02+1.61349925e-01j
  -2.00734473e-01+5.14464873e-01j  3.42026546e-02+2.26266632e-01j
   1.64031861e-02+1.37312931e-01j  1.91373656e-01+3.00343868e-01j
   5.55111512e-16-3.33066907e-16j -6.10622664e-16+7.21644966e-16j
  -2.22044605e-16-4.44089210e-16j -2.22044605e-16-5.55111512e-17j
   8.88178420e-16+1.11022302e-16j  1.11022302e-15-2.22044605e-16j
   2.46519033e-32-8.32667268e-16j  4.44089210e-16+1.33226763e-15j]
 [-1.48128977e-01+2.92871951e-01j  1.09571538e-01+4.80861538e-02j
   6.37134497e-02+1.01285092e-01j  2.78558507e-02+2.35182756e-01j
   3.42026546e-02+2.26266632e-01j -4.62384748e-01-1.92404082e-01j
  -4.18609376e-01+9.87187384e-02j  3.97290734e-02+6.99910801e-02j
  -3.33066907e-16+1.11022302e-16j -6.66133815e-16+1.94289029e-16j
  -3.33066907e-16+8.88178420e-16j -5.55111512e-16-5.55111512e-17j
   7.77156117e-16+4.44089210e-16j -8.88178420e-16-1.66533454e-16j
   9.71445147e-16-1.11022302e-16j  4.44089210e-16+4.44089210e-16j]
 [ 2.33247782e-01-5.56510341e-02j  2.99915686e-01+1.72258156e-01j
  -4.19286008e-01+2.34320163e-01j  9.39077671e-02-1.58053083e-01j
   1.64031861e-02+1.37312931e-01j -4.18609376e-01+9.87187384e-02j
   2.34910328e-01-2.30816978e-01j -2.23970892e-01+4.32234892e-03j
   2.22044605e-16-3.05311332e-16j  5.55111512e-16-1.11022302e-15j
  -3.33066907e-16-2.22044605e-16j -4.44089210e-16+1.94289029e-16j
  -2.22044605e-16+7.49400542e-16j  8.04911693e-16+1.66533454e-16j
   0.00000000e+00+2.22044605e-16j -2.22044605e-16-3.33066907e-16j]
 [-2.94014574e-01-1.95313294e-01j  2.30338575e-01+1.20779809e-01j
  -1.79450051e-01-1.95949315e-01j -3.27228096e-01-1.64919939e-01j
   1.91373656e-01+3.00343868e-01j  3.97290734e-02+6.99910801e-02j
  -2.23970892e-01+4.32234892e-03j -6.65317098e-02-2.74993425e-01j
  -2.22044605e-16-1.11022302e-16j  1.11022302e-16-6.66133815e-16j
  -4.44089210e-16+1.66533454e-16j -4.57966998e-16+4.44089210e-16j
   4.44089210e-16-1.11022302e-15j  4.99600361e-16-3.33066907e-16j
  -1.11022302e-16+4.44089210e-16j  8.88178420e-16-1.89511507e-31j]
 [-1.77635684e-15-8.37551185e-17j -6.63263391e-17-2.36362954e-16j
   1.02080427e-15+9.22548516e-16j  1.20736320e-16+8.35985872e-17j
   5.09791688e-16-5.36085065e-16j -5.03248250e-16-3.08251711e-17j
   2.39174848e-16-5.84352964e-16j -4.40295034e-16-6.40479316e-17j
  -5.57856238e-01-3.33038714e-02j -7.90930167e-02-1.09151528e-01j
   2.74669684e-01+1.36485651e-01j  2.59417253e-01+3.88479296e-02j
   3.48378552e-02-9.54090840e-04j -1.48128977e-01-2.92871951e-01j
   2.33247782e-01+5.56510341e-02j -2.94014574e-01+1.95313294e-01j]
 [ 4.46944585e-17+4.55611536e-16j  1.44328993e-15+1.39112946e-16j
   5.65592317e-16-1.94165025e-16j -4.41955754e-16+2.91813919e-16j
  -4.08048012e-16+6.15438982e-16j -4.92211521e-16+8.11308374e-17j
   6.47682260e-16-1.23887472e-15j -8.94633191e-17-9.32328198e-16j
  -7.90930167e-02-1.09151528e-01j  1.84508494e-03-5.99529563e-01j
   1.32727225e-01-3.24722292e-01j -3.12570068e-01-1.78720258e-02j
   1.60660686e-01+1.62719560e-03j  1.09571538e-01-4.80861538e-02j
   2.99915686e-01-1.72258156e-01j  2.30338575e-01-1.20779809e-01j]
 [ 1.12583467e-15-9.22618664e-16j  3.75457706e-16-1.97281025e-17j
  -6.66133815e-16+2.88514054e-17j -6.75317953e-17+6.75317953e-17j
  -3.35369511e-16-5.14817964e-16j -1.75438704e-16+6.23696484e-16j
  -3.88695052e-16-2.75921182e-16j -3.41960839e-16+1.97201641e-16j
   2.74669684e-01+1.36485651e-01j  1.32727225e-01-3.24722292e-01j
   7.67535007e-02+1.74227030e-01j -4.00815496e-02+7.21482282e-02j
   9.85245676e-02+2.72637699e-01j  6.37134497e-02-1.01285092e-01j
  -4.19286008e-01-2.34320163e-01j -1.79450051e-01+1.95949315e-01j]
 [ 1.69663819e-16-1.43167105e-16j -5.97969503e-16-3.63471659e-16j
   1.46869702e-16-9.87359344e-17j -1.77635684e-15+1.97780419e-16j
  -1.97471869e-16-1.97471869e-17j -1.38230308e-16-1.67851089e-16j
  -5.28237249e-16+2.07345462e-16j -3.94943738e-16+4.24564518e-16j
   2.59417253e-01+3.88479296e-02j -3.12570068e-01-1.78720258e-02j
  -4.00815496e-02+7.21482282e-02j -3.23009653e-01-4.98868810e-01j
  -5.08364399e-02-1.61349925e-01j  2.78558507e-02-2.35182756e-01j
   9.39077671e-02+1.58053083e-01j -3.27228096e-01+1.64919939e-01j]
 [ 4.24104174e-16+5.71472968e-16j -4.58703997e-16-6.21290883e-16j
  -4.35215434e-16+5.22006406e-16j -5.92540300e-16-1.11401960e-17j
   7.77156117e-16+7.39821585e-17j  8.28639822e-16+4.01764762e-16j
   1.47579300e-16+9.67924521e-16j  2.95069286e-16-1.11737528e-15j
   3.48378552e-02-9.54090840e-04j  1.60660686e-01+1.62719560e-03j
   9.85245676e-02+2.72637699e-01j -5.08364399e-02-1.61349925e-01j
  -2.00734473e-01-5.14464873e-01j  3.42026546e-02-2.26266632e-01j
   1.64031861e-02-1.37312931e-01j  1.91373656e-01-3.00343868e-01j]
 [-5.10222244e-16-1.32200591e-16j -4.58258436e-16-1.02648734e-16j
  -3.31131408e-16-5.94639905e-16j -5.31474987e-16+2.85792780e-16j
   8.74843003e-16-3.26165525e-16j -4.44089210e-16-1.04807133e-17j
   8.71830598e-16+1.53852458e-16j  5.84334935e-16-2.44061424e-16j
  -1.48128977e-01-2.92871951e-01j  1.09571538e-01-4.80861538e-02j
   6.37134497e-02-1.01285092e-01j  2.78558507e-02-2.35182756e-01j
   3.42026546e-02-2.26266632e-01j -4.62384748e-01+1.92404082e-01j
  -4.18609376e-01-9.87187384e-02j  3.97290734e-02-6.99910801e-02j]
 [ 2.18356768e-16+1.41805497e-16j  7.09162942e-16+1.08514767e-15j
  -3.40475023e-16+1.75087465e-16j -6.30036454e-16-2.70339195e-16j
   1.75952186e-16-8.92959900e-16j  1.19357036e-15-1.94686288e-16j
  -2.22044605e-16+2.32202265e-16j -1.79744794e-16+1.19829863e-16j
   2.33247782e-01+5.56510341e-02j  2.99915686e-01-1.72258156e-01j
  -4.19286008e-01-2.34320163e-01j  9.39077671e-02+1.58053083e-01j
   1.64031861e-02-1.37312931e-01j -4.18609376e-01-9.87187384e-02j
   2.34910328e-01+2.30816978e-01j -2.23970892e-01-4.32234892e-03j]
 [-5.46297263e-16-1.17736479e-16j -1.13027020e-16+8.52412109e-16j
  -4.70945917e-16-1.78959448e-16j -2.69616537e-16-1.50702693e-16j
   2.26054040e-16+1.46935126e-15j  3.67337815e-16+5.65135100e-16j
  -3.20243223e-16-9.41891833e-18j  7.77156117e-16+1.05962831e-17j
  -2.94014574e-01+1.95313294e-01j  2.30338575e-01-1.20779809e-01j
  -1.79450051e-01+1.95949315e-01j -3.27228096e-01+1.64919939e-01j
   1.91373656e-01-3.00343868e-01j  3.97290734e-02-6.99910801e-02j
  -2.23970892e-01-4.32234892e-03j -6.65317098e-02+2.74993425e-01j]], gamma = [ 0.39295655-0.3904874j  -0.12907155-0.19338119j  0.86978779-0.55261654j
 -0.39727282-0.42181942j  1.04839386+0.25517419j -0.45304931-0.83161275j
  0.43040593-0.02132403j -0.6890778 +0.76306399j  0.39295655+0.3904874j
 -0.12907155+0.19338119j  0.86978779+0.55261654j -0.39727282+0.42181942j
  1.04839386-0.25517419j -0.45304931+0.83161275j  0.43040593+0.02132403j
 -0.6890778 -0.76306399j]
INFO 2022-02-10 19:07:34,974 lhaf_exact = (0.39779425253242096+5.276845627122384e-11j), prob_exact = 7.975866571730712e-09
INFO 2022-02-10 19:07:41,147 lhaf_k for k=N is (0.39779424443258904+3.132138227113778e-08j), prob_k = 7.975866409327213e-09
INFO 2022-02-10 19:07:41,147 For k = 0, lhaf_k_approx=(8.977325833540437e-07-1.9587636905255695e-21j), prob_k_approx = 1.7999745487382082e-14
INFO 2022-02-10 19:07:41,193 For k = 1, lhaf_k_approx=(2.4773748745511516e-05+3.1763735522036263e-21j), prob_k_approx = 4.967193799756493e-13
INFO 2022-02-10 19:07:45,106 For k = 2, lhaf_k_approx=(7.455729119508516e-05+4.743384504624082e-20j), prob_k_approx = 1.4948908958236055e-12
