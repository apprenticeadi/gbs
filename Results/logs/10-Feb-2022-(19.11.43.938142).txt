INFO 2022-02-10 19:11:44,323 NumExpr defaulting to 8 threads.
INFO 2022-02-10 19:11:48,369 Trying to find the error between k-approx and exact hafnian calculation. Run for 8 modes, test output pattern is [1, 3, 2, 1, 3, 2, 2, 2], total output photon numbers is 16, cutoff k is 7, hbar = 2
INFO 2022-02-10 19:11:48,369 Squeezing r = 1.55, coherent state alpha = 2.25
INFO 2022-02-10 19:11:48,369 U = [[-0.53688913+0.42888933j  0.0160947 +0.11219099j -0.07984506+0.20791063j
   0.11960221+0.17506899j  0.01280789+0.09082042j  0.40587628-0.31529442j
  -0.33417967+0.03440373j -0.0064555 +0.18692882j]
 [-0.1496532 +0.21364197j  0.06704447-0.47472937j  0.4385434 +0.11590399j
  -0.28397156-0.33271846j -0.33288611+0.01347888j  0.22185329+0.30173902j
   0.06351207+0.21696127j -0.04401534+0.0264411j ]
 [-0.24119086+0.26556915j  0.16486541+0.01634768j -0.23859722+0.0991884j
  -0.57235598-0.07843993j  0.34263483+0.14258427j -0.35157716-0.040028j
   0.22113846-0.07311843j -0.34124772-0.09851297j]
 [-0.30080685-0.19815141j -0.18257887-0.48999097j  0.05592065-0.29959511j
   0.20999552+0.123223j    0.31644959+0.03034304j -0.32990834-0.04313876j
  -0.17118   +0.35622824j -0.14074373+0.23851045j]
 [-0.12372514+0.22595581j  0.50560678-0.10594417j -0.01699963-0.51450959j
   0.33221954+0.11370655j -0.01130575-0.16344572j  0.17253431+0.02816402j
   0.40887748-0.13870345j -0.15464512-0.1035731j ]
 [-0.27046835+0.01529076j  0.01153009+0.07005847j  0.19037658+0.01031143j
   0.07106983+0.11737203j -0.46158859+0.27450755j -0.49379418-0.06884553j
   0.2018593 -0.35254587j  0.20997869+0.34681064j]
 [ 0.07749981+0.13628363j -0.23211533+0.35132915j  0.34185361-0.14981088j
   0.2052523 -0.3099067j   0.02324496+0.0051108j  -0.05435948+0.09031031j
  -0.1815656 -0.18839017j -0.64776088+0.14458411j]
 [ 0.01989749-0.19128528j  0.05062209-0.06812747j  0.19716154+0.32473687j
   0.19775531-0.22643889j  0.51987431+0.23602188j  0.25912735-0.04783055j
   0.41678361-0.17878468j  0.10775744+0.32925227j]]
INFO 2022-02-10 19:11:48,369 
INFO 2022-02-10 19:11:48,369 Number of coherent states = 1
INFO 2022-02-10 19:11:48,387 mu = [-2.41600107 -0.67343938 -1.08535888 -1.35363083 -0.55676312 -1.21710756
  0.34874914  0.08953872  1.93000197  0.96138889  1.19506119 -0.89168133
  1.01680116  0.06880841  0.61327634 -0.86078374]
INFO 2022-02-10 19:11:48,389 cov = [[ 5.59662838 -3.57777243  0.52847255 -0.4251911  -3.09625329  3.02236189
  -1.16800987  2.39574088  2.9544744   1.21978243  0.97113161 -2.62111314
  -0.97532277 -4.62187241  0.49904585 -1.71083798]
 [-3.57777243 10.93177611  0.1154376   5.05069519 -1.56906354 -3.40317186
  -1.9940823   2.26172741  0.19715878 -4.17702363 -0.47615123  2.58973356
   4.77803832  2.55462177 -0.23275133 -2.44664838]
 [ 0.52847255  0.1154376   1.34741698 -1.99427341 -1.37122951  0.6525581
   0.2789612   1.38823287  0.17888121 -0.23758302 -2.31054669 -1.44644913
   0.92437896  1.57142369 -2.19084371 -0.57097423]
 [-0.4251911   5.05069519 -1.99427341 11.94542965  3.08931134 -1.13306157
  -4.5189274  -1.4702301   2.14405241  4.49093513  1.13812311 -0.61741465
   2.14312956 -1.72496286  3.95235386 -2.58329781]
 [-3.09625329 -1.56906354 -1.37122951  3.08931134  7.78101932 -0.70041172
   0.40754804 -5.24596021 -2.35688384  4.62860192  0.48630226  0.27094823
   0.90899096  1.81328579  0.87573347  5.13478142]
 [ 3.02236189 -3.40317186  0.6525581  -1.13306157 -0.70041172  7.72356689
   2.16269168  4.80586447 -2.4398481   3.67800872  2.95078293 -2.90296881
   3.01211766  1.77097842  3.04652395 -0.92774382]
 [-1.16800987 -1.9940823   0.2789612  -4.5189274   0.40754804  2.16269168
   6.85827789  1.65495355 -1.65497216 -0.98078066 -3.27287105  3.43335665
   0.17991589  2.27637011  5.77332328  2.41822767]
 [ 2.39574088  2.26172741  1.38823287 -1.4702301  -5.24596021  4.80586447
   1.65495355  8.04954476  0.19534743 -1.95321486  0.25599484 -1.33870474
   5.52285679  0.11340155  2.06324085 -1.92884741]
 [ 2.9544744   0.19715878  0.17888121  2.14405241 -2.35688384 -2.4398481
  -1.65497216  0.19534743  7.08770845  0.09646346 -5.4554676  -1.12370013
  -0.21017198 -6.09463312  0.8270815  -0.51874993]
 [ 1.21978243 -4.17702363 -0.23758302  4.49093513  4.62860192  3.67800872
  -0.98078066 -1.95321486  0.09646346  9.93391142 -1.99462979 -5.10501219
   0.21704349  2.51767824  1.63946926 -1.37418747]
 [ 0.97113161 -0.47615123 -2.31054669  1.13812311  0.48630226  2.95078293
  -3.27287105  0.25599484 -5.4554676  -1.99462979 18.29030919  1.59085142
  -0.447569   -2.05530182 -0.63322348 -0.26275114]
 [-2.62111314  2.58973356 -1.44644913 -0.61741465  0.27094823 -2.90296881
   3.43335665 -1.33870474 -1.12370013 -5.10501219  1.59085142  7.67106699
  -2.93635333 -0.45254931  5.53749985  0.8241111 ]
 [-0.97532277  4.77803832  0.92437896  2.14312956  0.90899096  3.01211766
   0.17991589  5.52285679 -0.21017198  0.21704349 -0.447569   -2.93635333
  13.1185759  -0.04693494 -0.83680905  6.17073821]
 [-4.62187241  2.55462177  1.57142369 -1.72496286  1.81328579  1.77097842
   2.27637011  0.11340155 -6.09463312  2.51767824 -2.05530182 -0.45254931
  -0.04693494 13.03386186 -1.78055718 -4.63771519]
 [ 0.49904585 -0.23275133 -2.19084371  3.95235386  0.87573347  3.04652395
   5.77332328  2.06324085  0.8270815   1.63946926 -0.63322348  5.53749985
  -0.83680905 -1.78055718 14.88716081 -1.15845348]
 [-1.71083798 -2.44664838 -0.57097423 -2.58329781  5.13478142 -0.92774382
   2.41822767 -1.92884741 -0.51874993 -1.37418747 -0.26275114  0.8241111
   6.17073821 -4.63771519 -1.15845348 13.44474878]]
INFO 2022-02-10 19:11:48,397 A=[[-6.15055908e-02-2.43738344e-01j -1.51558628e-01-5.84474357e-02j
   2.46831664e-01-4.74369010e-02j  2.88128126e-02+1.96782874e-02j
  -1.19048024e-01+1.37450256e-01j  3.76067105e-01+2.91289047e-01j
  -8.22955627e-02+4.76808267e-02j  1.20219889e-01+6.25124994e-02j
   0.00000000e+00+6.94874443e-17j -6.19511785e-17-9.26816922e-16j
   5.55111512e-16+1.38777878e-17j -2.40069820e-16-1.65153257e-16j
   3.40983978e-16+5.70988870e-16j  3.26340907e-16+3.03345054e-16j
  -3.34181195e-17-2.58576920e-16j -1.42868960e-16-1.36078223e-15j]
 [-1.51558628e-01-5.84474357e-02j  4.11609400e-02+3.44596259e-01j
   8.70382108e-02+2.94408379e-02j  4.18912972e-01-2.92070641e-01j
  -7.36751636e-02-3.88014687e-01j -2.44229261e-01-2.57089897e-01j
  -1.49880439e-01+5.00570045e-02j  1.49977924e-01+1.81490044e-01j
  -6.20473901e-17+7.41352397e-16j  1.77635684e-15+2.72229445e-16j
   6.93889390e-16-1.70002901e-16j -2.99214038e-16-1.06376807e-15j
   5.56725352e-16+1.37300004e-16j -4.62245480e-16-1.15218025e-16j
   6.13361188e-16+7.92586074e-16j  5.12891490e-16+5.72092094e-16j]
 [ 2.46831664e-01-4.74369010e-02j  8.70382108e-02+2.94408379e-02j
  -6.98877691e-01+1.90615571e-01j -1.47882884e-01+1.27181461e-02j
  -3.81000903e-02-5.81892172e-02j  1.11696567e-01-1.86536589e-01j
   3.76267235e-02+2.25372876e-01j  6.81014715e-02+1.29925908e-02j
  -4.50059445e-17-2.11321361e-16j  4.40230121e-16+9.63498760e-17j
   1.22124533e-15+1.66533454e-16j -7.80602771e-16-7.14931189e-16j
  -2.71336830e-16+1.92929551e-16j -1.02060419e-15-1.66904849e-15j
   1.55260673e-16-4.36162073e-16j -2.12109994e-16+1.43966139e-16j]
 [ 2.88128126e-02+1.96782874e-02j  4.18912972e-01-2.92070641e-01j
  -1.47882884e-01+1.27181461e-02j  1.76313269e-01+5.09354978e-02j
   2.48552760e-01-9.95783421e-02j -2.80704634e-02+1.90897644e-01j
  -4.14817764e-01-3.04653317e-01j -9.46393252e-02+1.61778760e-01j
  -4.75612019e-16+4.26699052e-16j -2.61022521e-16+9.94657165e-16j
  -6.96992401e-16+6.94215941e-16j  2.44249065e-15-9.48176496e-17j
   4.60303659e-16+4.10768890e-16j  2.77555756e-17-7.55472074e-16j
   8.50242954e-16+6.22476690e-16j -5.18008050e-16+2.92923389e-16j]
 [-1.19048024e-01+1.37450256e-01j -7.36751636e-02-3.88014687e-01j
  -3.81000903e-02-5.81892172e-02j  2.48552760e-01-9.95783421e-02j
  -2.20168976e-01-7.49899719e-02j -2.69552767e-02-1.99043161e-01j
   5.13285099e-02-4.35445011e-02j -4.70927616e-01-4.39617127e-01j
   5.09991049e-16-6.32566674e-16j  7.05435636e-16-1.32849748e-16j
  -4.24147852e-16+2.78665078e-16j  7.35075916e-16-2.82679219e-16j
   1.55431223e-15-5.76672926e-17j  4.68375339e-16-6.10622664e-16j
   4.14620822e-16+8.04651088e-16j  2.95358231e-16-5.33327774e-16j]
 [ 3.76067105e-01+2.91289047e-01j -2.44229261e-01-2.57089897e-01j
   1.11696567e-01-1.86536589e-01j -2.80704634e-02+1.90897644e-01j
  -2.69552767e-02-1.99043161e-01j -2.19044461e-01-1.46102247e-01j
   1.62655149e-01-2.19564161e-01j  3.89538402e-01+3.35908203e-02j
   6.12754436e-16+3.42438512e-16j -6.41582876e-16+4.78917273e-16j
  -4.37187652e-16+2.62577990e-16j  7.15892153e-18+6.70310192e-16j
   9.41636095e-17+4.27572487e-16j -2.22044605e-16-6.66133815e-16j
  -1.15530284e-15+1.29137137e-16j  1.33229259e-15+1.28105189e-15j]
 [-8.22955627e-02+4.76808267e-02j -1.49880439e-01+5.00570045e-02j
   3.76267235e-02+2.25372876e-01j -4.14817764e-01-3.04653317e-01j
   5.13285099e-02-4.35445011e-02j  1.62655149e-01-2.19564161e-01j
  -3.31183548e-01-4.76287849e-01j  1.16050281e-01-1.84856182e-01j
   5.40502656e-17+5.09208408e-16j  2.57354709e-16-8.84334809e-16j
   6.76022604e-17+3.10814754e-17j  7.66896980e-16-5.46764782e-16j
  -1.10680980e-16-5.57325898e-16j -1.04083409e-15-2.49800181e-16j
   2.44249065e-15+8.40781468e-18j  8.41891513e-16+4.19846928e-16j]
 [ 1.20219889e-01+6.25124994e-02j  1.49977924e-01+1.81490044e-01j
   6.81014715e-02+1.29925908e-02j -9.46393252e-02+1.61778760e-01j
  -4.70927616e-01-4.39617127e-01j  3.89538402e-01+3.35908203e-02j
   1.16050281e-01-1.84856182e-01j -2.22546876e-01+1.59126129e-01j
   2.97103095e-16+1.22195862e-15j -9.02549396e-17-7.70034600e-16j
   1.84495703e-18-1.26211791e-16j -4.14793339e-16-5.07797957e-16j
  -1.56173528e-16+4.45609517e-16j  1.27675648e-15-1.13797860e-15j
   6.48254623e-16-3.62980939e-16j  4.44089210e-16+4.23492522e-16j]
 [ 4.44089210e-16-8.88178420e-16j  2.67490854e-16+1.35153184e-15j
  -1.41390819e-16-4.66386278e-16j  1.32361441e-16+7.11333427e-16j
  -7.54690760e-17-5.40088283e-16j  1.09049569e-15+8.27638916e-16j
  -3.53293322e-16+3.97936246e-16j -5.35433273e-17+1.64054294e-16j
  -6.15055908e-02+2.43738344e-01j -1.51558628e-01+5.84474357e-02j
   2.46831664e-01+4.74369010e-02j  2.88128126e-02-1.96782874e-02j
  -1.19048024e-01-1.37450256e-01j  3.76067105e-01-2.91289047e-01j
  -8.22955627e-02-4.76808267e-02j  1.20219889e-01-6.25124994e-02j]
 [-3.11510534e-16-8.05041682e-16j  8.88178420e-16-7.28583860e-17j
   7.90799019e-16-6.91284645e-17j -3.44311829e-16+7.54640123e-16j
   4.87978267e-16-3.29469453e-17j -5.32799464e-16+3.02980075e-16j
   3.59635953e-16-6.12409672e-16j  4.68622422e-16-6.12707993e-16j
  -1.51558628e-01+5.84474357e-02j  4.11609400e-02-3.44596259e-01j
   8.70382108e-02-2.94408379e-02j  4.18912972e-01+2.92070641e-01j
  -7.36751636e-02+3.88014687e-01j -2.44229261e-01+2.57089897e-01j
  -1.49880439e-01-5.00570045e-02j  1.49977924e-01-1.81490044e-01j]
 [-2.42811243e-16+6.87654907e-16j  1.28332321e-15-2.87818336e-16j
   1.55431223e-15+2.77555756e-16j -9.41315088e-16+4.81391060e-16j
  -2.42130939e-16-6.28109810e-17j  1.44688078e-16-1.36089125e-16j
   7.87642288e-16+3.91591654e-16j  1.30097221e-17+6.37464391e-16j
   2.46831664e-01+4.74369010e-02j  8.70382108e-02-2.94408379e-02j
  -6.98877691e-01-1.90615571e-01j -1.47882884e-01-1.27181461e-02j
  -3.81000903e-02+5.81892172e-02j  1.11696567e-01+1.86536589e-01j
   3.76267235e-02-2.25372876e-01j  6.81014715e-02-1.29925908e-02j]
 [-1.22346470e-16-6.68171609e-16j -4.35858246e-16-6.40696554e-16j
  -9.95485439e-16-5.44598385e-16j  2.88657986e-15-2.22044605e-16j
   5.36930101e-16-6.65068554e-16j  1.62374141e-16+1.03648743e-16j
   6.28121254e-16-9.25310798e-16j -1.89283333e-16+1.73274533e-16j
   2.88128126e-02-1.96782874e-02j  4.18912972e-01+2.92070641e-01j
  -1.47882884e-01-1.27181461e-02j  1.76313269e-01-5.09354978e-02j
   2.48552760e-01+9.95783421e-02j -2.80704634e-02-1.90897644e-01j
  -4.14817764e-01+3.04653317e-01j -9.46393252e-02-1.61778760e-01j]
 [ 4.98467327e-17+7.38320656e-16j  6.46059373e-16-3.11047126e-16j
  -3.26164383e-16+7.75527927e-17j  5.87974953e-16+2.29212165e-16j
   2.99760217e-15+1.94289029e-16j -2.34938651e-16+1.52362063e-16j
   1.31534567e-16-4.47714984e-16j  4.46710668e-17+4.92183062e-16j
  -1.19048024e-01-1.37450256e-01j -7.36751636e-02+3.88014687e-01j
  -3.81000903e-02+5.81892172e-02j  2.48552760e-01+9.95783421e-02j
  -2.20168976e-01+7.49899719e-02j -2.69552767e-02+1.99043161e-01j
   5.13285099e-02+4.35445011e-02j -4.70927616e-01+4.39617127e-01j]
 [ 8.94264915e-16-5.10112305e-16j -6.42412308e-16-6.09220362e-16j
  -4.48728197e-16-2.07534392e-17j -3.45751954e-16-2.86439272e-16j
   1.28627874e-16-2.66709683e-16j -8.88178420e-16+3.05311332e-16j
  -7.89194410e-16-2.08909852e-16j  1.17365788e-15-7.78638215e-16j
   3.76067105e-01-2.91289047e-01j -2.44229261e-01+2.57089897e-01j
   1.11696567e-01+1.86536589e-01j -2.80704634e-02-1.90897644e-01j
  -2.69552767e-02+1.99043161e-01j -2.19044461e-01+1.46102247e-01j
   1.62655149e-01+2.19564161e-01j  3.89538402e-01-3.35908203e-02j]
 [-1.30115080e-16-2.28709426e-17j  2.52835034e-16+6.38526141e-16j
   1.86902330e-16-3.34693149e-16j  3.42509745e-16+5.28514578e-16j
   1.96885357e-16+4.73584076e-16j -1.15369306e-15+3.89538601e-16j
   3.21964677e-15+2.22044605e-16j  6.65546384e-16-2.81716300e-16j
  -8.22955627e-02-4.76808267e-02j -1.49880439e-01-5.00570045e-02j
   3.76267235e-02-2.25372876e-01j -4.14817764e-01+3.04653317e-01j
   5.13285099e-02+4.35445011e-02j  1.62655149e-01+2.19564161e-01j
  -3.31183548e-01+4.76287849e-01j  1.16050281e-01+1.84856182e-01j]
 [-2.82603108e-17-1.16563751e-15j  2.34177589e-16+7.33695232e-16j
  -2.41498177e-17+1.17838420e-16j -1.94542090e-16+2.85351962e-16j
   1.44886929e-16-6.03741980e-16j  5.66401799e-16+7.58224853e-16j
   9.52275354e-16+3.26658382e-16j -6.66133815e-16-5.55111512e-17j
   1.20219889e-01-6.25124994e-02j  1.49977924e-01-1.81490044e-01j
   6.81014715e-02-1.29925908e-02j -9.46393252e-02-1.61778760e-01j
  -4.70927616e-01+4.39617127e-01j  3.89538402e-01-3.35908203e-02j
   1.16050281e-01+1.84856182e-01j -2.22546876e-01-1.59126129e-01j]], gamma = [-1.20800054-0.96500099j -0.33671969-0.48069444j -0.54267944-0.5975306j
 -0.67681541+0.44584067j -0.27838156-0.50840058j -0.60855378-0.03440421j
  0.17437457-0.30663817j  0.04476936+0.43039187j -1.20800054+0.96500099j
 -0.33671969+0.48069444j -0.54267944+0.5975306j  -0.67681541-0.44584067j
 -0.27838156+0.50840058j -0.60855378+0.03440421j  0.17437457+0.30663817j
  0.04476936-0.43039187j]
INFO 2022-02-10 19:11:48,622 lhaf_exact = (1.7073935374416445-3.4352520827951594e-12j), prob_exact = 3.423363448158443e-08
INFO 2022-02-10 19:11:54,634 lhaf_k for k=N is (1.7073935382941272+1.8952166717576122e-09j), prob_k = 3.4233634498676906e-08
INFO 2022-02-10 19:11:54,634 For k = 0, lhaf_k_approx=(7.74013590971468e-08+2.7627832459271124e-22j), prob_k_approx = 1.5519151136532556e-15
INFO 2022-02-10 19:11:54,674 For k = 1, lhaf_k_approx=(-1.9942180090913905e-06-3.65282958503417e-21j), prob_k_approx = -3.9984531335477775e-14
INFO 2022-02-10 19:11:58,190 For k = 2, lhaf_k_approx=(1.5221746029079062e-05+2.828494473788325e-19j), prob_k_approx = 3.051995209679725e-13
